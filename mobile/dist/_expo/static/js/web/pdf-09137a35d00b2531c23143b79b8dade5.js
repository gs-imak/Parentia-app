__d(function(t,e,i,s,a,n,r){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,'__esModule',{value:!0}),Object.defineProperty(n,"AbortException",{enumerable:!0,get:function(){return y}}),Object.defineProperty(n,"AnnotationEditorLayer",{enumerable:!0,get:function(){return A}}),Object.defineProperty(n,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return w}}),Object.defineProperty(n,"AnnotationEditorType",{enumerable:!0,get:function(){return _}}),Object.defineProperty(n,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return x}}),Object.defineProperty(n,"AnnotationLayer",{enumerable:!0,get:function(){return E}}),Object.defineProperty(n,"AnnotationMode",{enumerable:!0,get:function(){return P}}),Object.defineProperty(n,"CMapCompressionType",{enumerable:!0,get:function(){return S}}),Object.defineProperty(n,"ColorPicker",{enumerable:!0,get:function(){return C}}),Object.defineProperty(n,"DOMSVGFactory",{enumerable:!0,get:function(){return T}}),Object.defineProperty(n,"DrawLayer",{enumerable:!0,get:function(){return M}}),Object.defineProperty(n,"FeatureTest",{enumerable:!0,get:function(){return k}}),Object.defineProperty(n,"GlobalWorkerOptions",{enumerable:!0,get:function(){return R}}),Object.defineProperty(n,"ImageKind",{enumerable:!0,get:function(){return O}}),Object.defineProperty(n,"InvalidPDFException",{enumerable:!0,get:function(){return F}}),Object.defineProperty(n,"MissingPDFException",{enumerable:!0,get:function(){return I}}),Object.defineProperty(n,"OPS",{enumerable:!0,get:function(){return D}}),Object.defineProperty(n,"Outliner",{enumerable:!0,get:function(){return L}}),Object.defineProperty(n,"PDFDataRangeTransport",{enumerable:!0,get:function(){return j}}),Object.defineProperty(n,"PDFDateString",{enumerable:!0,get:function(){return N}}),Object.defineProperty(n,"PDFWorker",{enumerable:!0,get:function(){return B}}),Object.defineProperty(n,"PasswordResponses",{enumerable:!0,get:function(){return U}}),Object.defineProperty(n,"PermissionFlag",{enumerable:!0,get:function(){return H}}),Object.defineProperty(n,"PixelsPerInch",{enumerable:!0,get:function(){return z}}),Object.defineProperty(n,"PromiseCapability",{enumerable:!0,get:function(){return V}}),Object.defineProperty(n,"RenderingCancelledException",{enumerable:!0,get:function(){return q}}),Object.defineProperty(n,"UnexpectedResponseException",{enumerable:!0,get:function(){return G}}),Object.defineProperty(n,"Util",{enumerable:!0,get:function(){return $}}),Object.defineProperty(n,"VerbosityLevel",{enumerable:!0,get:function(){return W}}),Object.defineProperty(n,"XfaLayer",{enumerable:!0,get:function(){return X}}),Object.defineProperty(n,"build",{enumerable:!0,get:function(){return K}}),Object.defineProperty(n,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return Y}}),Object.defineProperty(n,"fetchData",{enumerable:!0,get:function(){return J}}),Object.defineProperty(n,"getDocument",{enumerable:!0,get:function(){return Q}}),Object.defineProperty(n,"getFilenameFromUrl",{enumerable:!0,get:function(){return Z}}),Object.defineProperty(n,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return tt}}),Object.defineProperty(n,"getXfaPageViewport",{enumerable:!0,get:function(){return et}}),Object.defineProperty(n,"isDataScheme",{enumerable:!0,get:function(){return it}}),Object.defineProperty(n,"isPdfFile",{enumerable:!0,get:function(){return st}}),Object.defineProperty(n,"noContextMenu",{enumerable:!0,get:function(){return at}}),Object.defineProperty(n,"normalizeUnicode",{enumerable:!0,get:function(){return nt}}),Object.defineProperty(n,"renderTextLayer",{enumerable:!0,get:function(){return rt}}),Object.defineProperty(n,"setLayerDimensions",{enumerable:!0,get:function(){return ot}}),Object.defineProperty(n,"shadow",{enumerable:!0,get:function(){return lt}}),Object.defineProperty(n,"updateTextLayer",{enumerable:!0,get:function(){return dt}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return ht}});var l,d,h,c,u,f=o(e(r[0])),p=o(e(r[1])),g={640:(t,e,i)=>{i.d(e,{AnnotationLayer:()=>Ct,FreeTextAnnotationElement:()=>nt,InkAnnotationElement:()=>ut,StampAnnotationElement:()=>bt});var s=i(266),a=i(473),n=i(780);function r(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}function o(t){return Math.max(0,Math.min(255,255*t))}class l{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return[t=o(t),t,t]}static G_HTML([t]){const e=r(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(o)}static RGB_HTML(t){return`#${t.map(r).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[o(1-Math.min(1,t+s)),o(1-Math.min(1,i+s)),o(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,a=1-e,n=1-i;return["CMYK",s,a,n,Math.min(s,a,n)]}}var d=i(160);const h=1e3,c=new WeakSet;function u(t){return{width:t[2]-t[0],height:t[3]-t[1]}}class g{static create(t){switch(t.data.annotationType){case s.AnnotationType.LINK:return new A(t);case s.AnnotationType.TEXT:return new E(t);case s.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new S(t);case"Btn":return t.data.radioButton?new M(t):t.data.checkBox?new T(t):new k(t);case"Ch":return new R(t);case"Sig":return new C(t)}return new P(t);case s.AnnotationType.POPUP:return new O(t);case s.AnnotationType.FREETEXT:return new nt(t);case s.AnnotationType.LINE:return new rt(t);case s.AnnotationType.SQUARE:return new ot(t);case s.AnnotationType.CIRCLE:return new lt(t);case s.AnnotationType.POLYLINE:return new dt(t);case s.AnnotationType.CARET:return new ct(t);case s.AnnotationType.INK:return new ut(t);case s.AnnotationType.POLYGON:return new ht(t);case s.AnnotationType.HIGHLIGHT:return new ft(t);case s.AnnotationType.UNDERLINE:return new pt(t);case s.AnnotationType.SQUIGGLY:return new gt(t);case s.AnnotationType.STRIKEOUT:return new mt(t);case s.AnnotationType.STAMP:return new bt(t);case s.AnnotationType.FILEATTACHMENT:return new At(t);default:return new m(t)}}}class m{#t=!1;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t?.str||e?.str||i?.str)}get hasPopupData(){return m._hasPopupData(this.data)}_createContainer(t){const{data:e,parent:{page:i,viewport:a}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",e.id),this instanceof P||(n.tabIndex=h),n.style.zIndex=this.parent.zIndex++,this.data.popupRef&&n.setAttribute("aria-haspopup","dialog"),e.noRotate&&n.classList.add("norotate");const{pageWidth:r,pageHeight:o,pageX:l,pageY:d}=a.rawDims;if(!e.rect||this instanceof O){const{rotation:t}=e;return e.hasOwnCanvas||0===t||this.setRotation(t,n),n}const{width:c,height:f}=u(e.rect),p=s.Util.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]);if(!t&&e.borderStyle.width>0){n.style.borderWidth=`${e.borderStyle.width}px`;const t=e.borderStyle.horizontalCornerRadius,i=e.borderStyle.verticalCornerRadius;if(t>0||i>0){const e=`calc(${t}px * var(--scale-factor)) / calc(${i}px * var(--scale-factor))`;n.style.borderRadius=e}else if(this instanceof M){const t=`calc(${c}px * var(--scale-factor)) / calc(${f}px * var(--scale-factor))`;n.style.borderRadius=t}switch(e.borderStyle.style){case s.AnnotationBorderStyleType.SOLID:n.style.borderStyle="solid";break;case s.AnnotationBorderStyleType.DASHED:n.style.borderStyle="dashed";break;case s.AnnotationBorderStyleType.BEVELED:(0,s.warn)("Unimplemented border style: beveled");break;case s.AnnotationBorderStyleType.INSET:(0,s.warn)("Unimplemented border style: inset");break;case s.AnnotationBorderStyleType.UNDERLINE:n.style.borderBottomStyle="solid"}const a=e.borderColor||null;a?(this.#t=!0,n.style.borderColor=s.Util.makeHexColor(0|a[0],0|a[1],0|a[2])):n.style.borderWidth=0}n.style.left=100*(p[0]-l)/r+"%",n.style.top=100*(p[1]-d)/o+"%";const{rotation:g}=e;return e.hasOwnCanvas||0===g?(n.style.width=100*c/r+"%",n.style.height=100*f/o+"%"):this.setRotation(g,n),n}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:a,height:n}=u(this.data.rect);let r,o;t%180==0?(r=100*a/i,o=100*n/s):(r=100*n/i,o=100*a/s),e.style.width=`${r}%`,e.style.height=`${o}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(t,e,i)=>{const s=i.detail[t],a=s[0],n=s.slice(1);i.target.style[e]=l[`${a}_HTML`](n),this.annotationStorage.setValue(this.data.id,{[e]:l[`${a}_rgb`](n)})};return(0,s.shadow)(this,"_commonActions",{display:t=>{const{display:e}=t.detail,i=e%2==1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:1===e||2===e})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:e}=t.detail;this.container.style.visibility=e?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:e,noView:e})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:t=>{const e=t.detail.rotation;this.setRotation(e),this.annotationStorage.setValue(this.data.id,{rotation:e})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail)){const a=t[s]||i[s];a?.(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,a]of Object.entries(e)){const n=i[s];if(n){n({detail:{[s]:a},target:t}),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,a]=this.data.rect;if(1===t.length){const[,{x:n,y:r},{x:o,y:l}]=t[0];if(s===n&&a===r&&e===o&&i===l)return}const{style:n}=this.container;let r;if(this.#t){const{borderColor:t,borderWidth:e}=n;n.borderWidth=0,r=["url('data:image/svg+xml;utf8,","<svg xmlns=\"http://www.w3.org/2000/svg\""," preserveAspectRatio=\"none\" viewBox=\"0 0 1 1\">",`<g fill="transparent" stroke="${t}" stroke-width="${e}">`],this.container.classList.add("hasBorder")}const o=s-e,l=a-i,{svgFactory:d}=this,h=d.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const c=d.createElement("defs");h.append(c);const u=d.createElement("clipPath"),f=`clippath_${this.data.id}`;u.setAttribute("id",f),u.setAttribute("clipPathUnits","objectBoundingBox"),c.append(u);for(const[,{x:i,y:s},{x:n,y:h}]of t){const t=d.createElement("rect"),c=(n-e)/o,f=(a-s)/l,p=(i-n)/o,g=(s-h)/l;t.setAttribute("x",c),t.setAttribute("y",f),t.setAttribute("width",p),t.setAttribute("height",g),u.append(t),r?.push(`<rect vector-effect="non-scaling-stroke" x="${c}" y="${f}" width="${p}" height="${g}"/>`)}this.#t&&(r.push("</g></svg>')"),n.backgroundImage=r.join("")),this.container.append(h),this.container.style.clipPath=`url(#${f})`}_createPopup(){const{container:t,data:e}=this;t.setAttribute("aria-haspopup","dialog");const i=new O({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(i.render())}render(){(0,s.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:t,id:n,exportValues:r}of a){if(-1===t)continue;if(n===e)continue;const a="string"==typeof r?r:null,o=document.querySelector(`[data-element-id="${n}"]`);!o||c.has(o)?i.push({id:n,exportValue:a,domElement:o}):(0,s.warn)(`_getElementsByName - element not allowed: ${n}`)}return i}for(const s of document.getElementsByName(t)){const{exportValue:t}=s,a=s.getAttribute("data-element-id");a!==e&&(c.has(s)&&i.push({id:a,exportValue:t,domElement:s}))}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}}var b=(0,p.default)("setInternalLink"),v=(0,p.default)("bindAttachment"),y=(0,p.default)("bindSetOCGState");class A extends m{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),Object.defineProperty(this,y,{value:x}),Object.defineProperty(this,v,{value:_}),Object.defineProperty(this,b,{value:w}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action),s=!0):t.attachment?((0,f.default)(this,v)[v](i,t.attachment,t.attachmentDest),s=!0):t.setOCGState?((0,f.default)(this,y)[y](i,t.setOCGState),s=!0):t.dest?(this._bindLink(i,t.dest),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||""===e)&&(0,f.default)(this,b)[b]()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),(0,f.default)(this,b)[b]()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const a=i.get(s);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}t.onclick||(t.onclick=()=>!1),(0,f.default)(this,b)[b]()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),(0,f.default)(this,b)[b](),!this._fieldObjects)return(0,s.warn)("_bindResetFormAction - \"resetForm\" action not supported, ensure that the `fieldObjects` parameter is provided."),void(i||(t.onclick=()=>!1));t.onclick=()=>{i?.();const{fields:t,refs:a,include:n}=e,r=[];if(0!==t.length||0!==a.length){const e=new Set(a);for(const i of t){const t=this._fieldObjects[i]||[];for(const{id:i}of t)e.add(i)}for(const t of Object.values(this._fieldObjects))for(const i of t)e.has(i.id)===n&&r.push(i)}else for(const t of Object.values(this._fieldObjects))r.push(...t);const o=this.annotationStorage,l=[];for(const t of r){const{id:e}=t;switch(l.push(e),t.type){case"text":{const i=t.defaultValue||"";o.setValue(e,{value:i});break}case"checkbox":case"radiobutton":{const i=t.defaultValue===t.exportValues;o.setValue(e,{value:i});break}case"combobox":case"listbox":{const i=t.defaultValue||"";o.setValue(e,{value:i});break}default:continue}const i=document.querySelector(`[data-element-id="${e}"]`);i&&(c.has(i)?i.dispatchEvent(new Event("resetform")):(0,s.warn)(`_bindResetFormAction - element not allowed: ${e}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:l,name:"ResetForm"}}),!1}}}function w(){this.container.setAttribute("data-internal-link","")}function _(t,e,i=null){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,i),!1),(0,f.default)(this,b)[b]()}function x(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),(0,f.default)(this,b)[b]()}class E extends m{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class P extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&("CANVAS"===t.previousSibling?.nodeName&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return s.FeatureTest.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,a){i.includes("mouse")?t.addEventListener(i,t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})}):t.addEventListener(i,t=>{if("blur"===i){if(!e.focused||!t.relatedTarget)return;e.focused=!1}else if("focus"===i){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(t)}})})}_setEventListeners(t,e,i,s){for(const[a,n]of i)("Action"===n||this.data.actions?.[n])&&("Focus"!==n&&"Blur"!==n||(e||={focused:!1}),this._setEventListener(t,e,a,n,s),"Focus"!==n||this.data.actions?.Blur?"Blur"!==n||this.data.actions?.Focus||this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":s.Util.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||9,n=t.style;let r;const o=t=>Math.round(10*t)/10;if(this.data.multiLine){const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2),e=t/(Math.round(t/(s.LINE_FACTOR*a))||1);r=Math.min(a,o(e/s.LINE_FACTOR))}else{const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(a,o(t/s.LINE_FACTOR))}n.fontSize=`calc(${r}px * var(--scale-factor))`,n.color=s.Util.makeHexColor(i[0],i[1],i[2]),null!==this.data.textAlignment&&(n.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class S extends P{constructor(t){super(t,{isRenderable:t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,e,i,s){const a=this.annotationStorage;for(const n of this._getElementsByName(t.name,t.id))n.domElement&&(n.domElement[e]=i),a.setValue(n.id,{[s]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let a=s.value||"";const n=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;n&&a.length>n&&(a=a.slice(0,n));let r=s.formattedValue||this.data.textContent?.join("\n")||null;r&&this.data.comb&&(r=r.replaceAll(/\s+/g,""));const o={userValue:a,formattedValue:r,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=r??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",r??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),c.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=h,this._setRequired(i,this.data.required),n&&(i.maxLength=n),i.addEventListener("input",s=>{t.setValue(e,{value:s.target.value}),this.setPropertyOnSiblings(i,"value",s.target.value,"value"),o.formattedValue=null}),i.addEventListener("resetform",t=>{const e=this.data.defaultFieldValue??"";i.value=o.userValue=e,o.formattedValue=null});let l=t=>{const{formattedValue:e}=o;null!=e&&(t.target.value=e),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",t=>{if(o.focused)return;const{target:e}=t;o.userValue&&(e.value=o.userValue),o.lastCommittedValue=e.value,o.commitKey=1,this.data.actions?.Focus||(o.focused=!0)}),i.addEventListener("updatefromsandbox",i=>{this.showElementAndHideCanvas(i.target);const s={value(i){o.userValue=i.detail.value??"",t.setValue(e,{value:o.userValue.toString()}),i.target.value=o.userValue},formattedValue(i){const{formattedValue:s}=i.detail;o.formattedValue=s,null!=s&&i.target!==document.activeElement&&(i.target.value=s),t.setValue(e,{formattedValue:s})},selRange(t){t.target.setSelectionRange(...t.detail.selRange)},charLimit:i=>{const{charLimit:s}=i.detail,{target:a}=i;if(0===s)return void a.removeAttribute("maxLength");a.setAttribute("maxLength",s);let n=o.userValue;!n||n.length<=s||(n=n.slice(0,s),a.value=o.userValue=n,t.setValue(e,{value:n}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:n,willCommit:!0,commitKey:1,selStart:a.selectionStart,selEnd:a.selectionEnd}}))}};this._dispatchEventFromSandbox(s,i)}),i.addEventListener("keydown",t=>{o.commitKey=1;let i=-1;if("Escape"===t.key?i=0:"Enter"!==t.key||this.data.multiLine?"Tab"===t.key&&(o.commitKey=3):i=2,-1===i)return;const{value:s}=t.target;o.lastCommittedValue!==s&&(o.lastCommittedValue=s,o.userValue=s,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,willCommit:!0,commitKey:i,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))});const s=l;l=null,i.addEventListener("blur",t=>{if(!o.focused||!t.relatedTarget)return;this.data.actions?.Blur||(o.focused=!1);const{value:i}=t.target;o.userValue=i,o.lastCommittedValue!==i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:i,willCommit:!0,commitKey:o.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}),s(t)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",t=>{o.lastCommittedValue=null;const{data:i,target:s}=t,{value:a,selectionStart:n,selectionEnd:r}=s;let l=n,d=r;switch(t.inputType){case"deleteWordBackward":{const t=a.substring(0,n).match(/\w*[^\w]*$/);t&&(l-=t[0].length);break}case"deleteWordForward":{const t=a.substring(n).match(/^[^\w]*\w*/);t&&(d+=t[0].length);break}case"deleteContentBackward":n===r&&(l-=1);break;case"deleteContentForward":n===r&&(d+=1)}t.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:a,change:i||"",willCommit:!1,selStart:l,selEnd:d}})}),this._setEventListeners(i,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],t=>t.target.value)}if(l&&i.addEventListener("blur",l),this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/n;i.classList.add("comb"),i.style.letterSpacing=`calc(${t}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class C extends P{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class T extends P{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;"string"==typeof s&&(s="Off"!==s,t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return c.add(a),a.setAttribute("data-element-id",i),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,s&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=h,a.addEventListener("change",s=>{const{name:a,checked:n}=s.target;for(const s of this._getElementsByName(a,i)){const i=n&&s.exportValue===e.exportValue;s.domElement&&(s.domElement.checked=i),t.setValue(s.id,{value:i})}t.setValue(i,{value:n})}),a.addEventListener("resetform",t=>{const i=e.defaultFieldValue||"Off";t.target.checked=i===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",e=>{const s={value(e){e.target.checked="Off"!==e.detail.value,t.setValue(i,{value:e.target.checked})}};this._dispatchEventFromSandbox(s,e)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],t=>t.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class M extends P{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if("string"==typeof s&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const s of this._getElementsByName(e.fieldName,i))t.setValue(s.id,{value:!1});const a=document.createElement("input");if(c.add(a),a.setAttribute("data-element-id",i),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,s&&a.setAttribute("checked",!0),a.tabIndex=h,a.addEventListener("change",e=>{const{name:s,checked:a}=e.target;for(const e of this._getElementsByName(s,i))t.setValue(e.id,{value:!1});t.setValue(i,{value:a})}),a.addEventListener("resetform",t=>{const i=e.defaultFieldValue;t.target.checked=null!=i&&i===e.buttonValue}),this.enableScripting&&this.hasJSActions){const s=e.buttonValue;a.addEventListener("updatefromsandbox",e=>{const a={value:e=>{const a=s===e.detail.value;for(const s of this._getElementsByName(e.target.name)){const e=a&&s.id===i;s.domElement&&(s.domElement.checked=e),t.setValue(s.id,{value:e})}}};this._dispatchEventFromSandbox(a,e)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],t=>t.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class k extends A{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(t.title=this.data.alternativeText);const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",t=>{this._dispatchEventFromSandbox({},t)})),t}}class R extends P{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");c.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=h;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",t=>{const e=this.data.defaultFieldValue;for(const t of s.options)t.selected=t.value===e});for(const t of this.data.options){const e=document.createElement("option");e.textContent=t.displayValue,e.value=t.exportValue,i.value.includes(t.exportValue)&&(e.setAttribute("selected",!0),a=!1),s.append(e)}let n=null;if(a){const t=document.createElement("option");t.value=" ",t.setAttribute("hidden",!0),t.setAttribute("selected",!0),s.prepend(t),n=()=>{t.remove(),s.removeEventListener("input",n),n=null},s.addEventListener("input",n)}const r=t=>{const e=t?"value":"textContent",{options:i,multiple:a}=s;return a?Array.prototype.filter.call(i,t=>t.selected).map(t=>t[e]):-1===i.selectedIndex?null:i[i.selectedIndex][e]};let o=r(!1);const l=t=>{const e=t.target.options;return Array.prototype.map.call(e,t=>({displayValue:t.textContent,exportValue:t.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",i=>{const a={value(i){n?.();const a=i.detail.value,l=new Set(Array.isArray(a)?a:[a]);for(const t of s.options)t.selected=l.has(t.value);t.setValue(e,{value:r(!0)}),o=r(!1)},multipleSelection(t){s.multiple=!0},remove(i){const a=s.options,n=i.detail.remove;if(a[n].selected=!1,s.remove(n),a.length>0){-1===Array.prototype.findIndex.call(a,t=>t.selected)&&(a[0].selected=!0)}t.setValue(e,{value:r(!0),items:l(i)}),o=r(!1)},clear(i){for(;0!==s.length;)s.remove(0);t.setValue(e,{value:null,items:[]}),o=r(!1)},insert(i){const{index:a,displayValue:n,exportValue:d}=i.detail.insert,h=s.children[a],c=document.createElement("option");c.textContent=n,c.value=d,h?h.before(c):s.append(c),t.setValue(e,{value:r(!0),items:l(i)}),o=r(!1)},items(i){const{items:a}=i.detail;for(;0!==s.length;)s.remove(0);for(const t of a){const{displayValue:e,exportValue:i}=t,a=document.createElement("option");a.textContent=e,a.value=i,s.append(a)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:r(!0),items:l(i)}),o=r(!1)},indices(i){const s=new Set(i.detail.indices);for(const t of i.target.options)t.selected=s.has(t.index);t.setValue(e,{value:r(!0)}),o=r(!1)},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(a,i)}),s.addEventListener("input",i=>{const s=r(!0);t.setValue(e,{value:s}),i.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:o,changeEx:s,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],t=>t.target.value)):s.addEventListener("input",function(i){t.setValue(e,{value:r(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class O extends m{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:m._hasPopupData(e)}),this.elements=i}render(){this.container.classList.add("popupAnnotation");const t=new tt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(t=>`${s.AnnotationPrefix}${t}`).join(",")),this.container}}var F=(0,p.default)("boundKeyDown"),I=(0,p.default)("boundHide"),D=(0,p.default)("boundShow"),L=(0,p.default)("boundToggle"),j=(0,p.default)("color"),N=(0,p.default)("container"),B=(0,p.default)("contentsObj"),U=(0,p.default)("dateObj"),H=(0,p.default)("elements"),z=(0,p.default)("parent"),V=(0,p.default)("parentRect"),q=(0,p.default)("pinned"),G=(0,p.default)("popup"),$=(0,p.default)("rect"),W=(0,p.default)("richText"),X=(0,p.default)("titleObj"),K=(0,p.default)("wasVisible"),Y=(0,p.default)("keyDown"),J=(0,p.default)("toggle"),Q=(0,p.default)("show"),Z=(0,p.default)("hide");class tt{constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:n,contentsObj:r,richText:o,parent:l,rect:d,parentRect:h,open:c}){Object.defineProperty(this,Z,{value:at}),Object.defineProperty(this,Q,{value:st}),Object.defineProperty(this,J,{value:it}),Object.defineProperty(this,Y,{value:et}),Object.defineProperty(this,F,{writable:!0,value:(0,f.default)(this,Y)[Y].bind(this)}),Object.defineProperty(this,I,{writable:!0,value:(0,f.default)(this,Z)[Z].bind(this)}),Object.defineProperty(this,D,{writable:!0,value:(0,f.default)(this,Q)[Q].bind(this)}),Object.defineProperty(this,L,{writable:!0,value:(0,f.default)(this,J)[J].bind(this)}),Object.defineProperty(this,j,{writable:!0,value:null}),Object.defineProperty(this,N,{writable:!0,value:null}),Object.defineProperty(this,B,{writable:!0,value:null}),Object.defineProperty(this,U,{writable:!0,value:null}),Object.defineProperty(this,H,{writable:!0,value:null}),Object.defineProperty(this,z,{writable:!0,value:null}),Object.defineProperty(this,V,{writable:!0,value:null}),Object.defineProperty(this,q,{writable:!0,value:!1}),Object.defineProperty(this,G,{writable:!0,value:null}),Object.defineProperty(this,$,{writable:!0,value:null}),Object.defineProperty(this,W,{writable:!0,value:null}),Object.defineProperty(this,X,{writable:!0,value:null}),Object.defineProperty(this,K,{writable:!0,value:!1}),(0,f.default)(this,N)[N]=t,(0,f.default)(this,X)[X]=s,(0,f.default)(this,B)[B]=r,(0,f.default)(this,W)[W]=o,(0,f.default)(this,z)[z]=l,(0,f.default)(this,j)[j]=e,(0,f.default)(this,$)[$]=d,(0,f.default)(this,V)[V]=h,(0,f.default)(this,H)[H]=i,(0,f.default)(this,U)[U]=a.PDFDateString.toDateObject(n),this.trigger=i.flatMap(t=>t.getElementsToTriggerPopup());for(const t of this.trigger)t.addEventListener("click",(0,f.default)(this,L)[L]),t.addEventListener("mouseenter",(0,f.default)(this,D)[D]),t.addEventListener("mouseleave",(0,f.default)(this,I)[I]),t.classList.add("popupTriggerArea");for(const t of i)t.container?.addEventListener("keydown",(0,f.default)(this,F)[F]);(0,f.default)(this,N)[N].hidden=!0,c&&(0,f.default)(this,J)[J]()}render(){if((0,f.default)(this,G)[G])return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:a,pageY:n}}}=(0,f.default)(this,z)[z],r=(0,f.default)(this,G)[G]=document.createElement("div");if(r.className="popup",(0,f.default)(this,j)[j]){const t=r.style.outlineColor=s.Util.makeHexColor(...(0,f.default)(this,j)[j]);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))r.style.backgroundColor=`color-mix(in srgb, ${t} 30%, white)`;else{const t=.7;r.style.backgroundColor=s.Util.makeHexColor(...(0,f.default)(this,j)[j].map(e=>Math.floor(t*(255-e)+e)))}}const o=document.createElement("span");o.className="header";const l=document.createElement("h1");if(o.append(l),({dir:l.dir,str:l.textContent}=(0,f.default)(this,X)[X]),r.append(o),(0,f.default)(this,U)[U]){const t=document.createElement("span");t.classList.add("popupDate"),t.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),t.setAttribute("data-l10n-args",JSON.stringify({date:(0,f.default)(this,U)[U].toLocaleDateString(),time:(0,f.default)(this,U)[U].toLocaleTimeString()})),o.append(t)}const h=(0,f.default)(this,B)[B],c=(0,f.default)(this,W)[W];if(!c?.str||h?.str&&h.str!==c.str){const t=this._formatContents(h);r.append(t)}else d.XfaLayer.render({xfaHtml:c.html,intent:"richText",div:r}),r.lastChild.classList.add("richText","popupContent");let u=!!(0,f.default)(this,V)[V],p=u?(0,f.default)(this,V)[V]:(0,f.default)(this,$)[$];for(const t of(0,f.default)(this,H)[H])if(!p||null!==s.Util.intersect(t.data.rect,p)){p=t.data.rect,u=!0;break}const g=s.Util.normalizeRect([p[0],t[3]-p[1]+t[1],p[2],t[3]-p[3]+t[1]]),m=u?p[2]-p[0]+5:0,b=g[0]+m,v=g[1],{style:y}=(0,f.default)(this,N)[N];y.left=100*(b-a)/e+"%",y.top=100*(v-n)/i+"%",(0,f.default)(this,N)[N].append(r)}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let t=0,e=s.length;t<e;++t){const a=s[t];i.append(document.createTextNode(a)),t<e-1&&i.append(document.createElement("br"))}return i}forceHide(){(0,f.default)(this,K)[K]=this.isVisible,(0,f.default)(this,K)[K]&&((0,f.default)(this,N)[N].hidden=!0)}maybeShow(){(0,f.default)(this,K)[K]&&((0,f.default)(this,K)[K]=!1,(0,f.default)(this,N)[N].hidden=!1)}get isVisible(){return!1===(0,f.default)(this,N)[N].hidden}}function et(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&(0,f.default)(this,q)[q])&&(0,f.default)(this,J)[J]()}function it(){(0,f.default)(this,q)[q]=!(0,f.default)(this,q)[q],(0,f.default)(this,q)[q]?((0,f.default)(this,Q)[Q](),(0,f.default)(this,N)[N].addEventListener("click",(0,f.default)(this,L)[L]),(0,f.default)(this,N)[N].addEventListener("keydown",(0,f.default)(this,F)[F])):((0,f.default)(this,Z)[Z](),(0,f.default)(this,N)[N].removeEventListener("click",(0,f.default)(this,L)[L]),(0,f.default)(this,N)[N].removeEventListener("keydown",(0,f.default)(this,F)[F]))}function st(){(0,f.default)(this,G)[G]||this.render(),this.isVisible?(0,f.default)(this,q)[q]&&(0,f.default)(this,N)[N].classList.add("focused"):((0,f.default)(this,N)[N].hidden=!1,(0,f.default)(this,N)[N].style.zIndex=parseInt((0,f.default)(this,N)[N].style.zIndex)+1e3)}function at(){(0,f.default)(this,N)[N].classList.remove("focused"),!(0,f.default)(this,q)[q]&&this.isVisible&&((0,f.default)(this,N)[N].hidden=!0,(0,f.default)(this,N)[N].style.zIndex=parseInt((0,f.default)(this,N)[N].style.zIndex)-1e3)}class nt extends m{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=s.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class rt extends m{#e=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:i}=u(t.rect),s=this.svgFactory.create(e,i,!0),a=this.#e=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ot extends m{#i=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:i}=u(t.rect),s=this.svgFactory.create(e,i,!0),a=t.borderStyle.width,n=this.#i=this.svgFactory.createElement("svg:rect");return n.setAttribute("x",a/2),n.setAttribute("y",a/2),n.setAttribute("width",e-a),n.setAttribute("height",i-a),n.setAttribute("stroke-width",a||1),n.setAttribute("stroke","transparent"),n.setAttribute("fill","transparent"),s.append(n),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#i}addHighlightArea(){this.container.classList.add("highlightArea")}}class lt extends m{#s=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:i}=u(t.rect),s=this.svgFactory.create(e,i,!0),a=t.borderStyle.width,n=this.#s=this.svgFactory.createElement("svg:ellipse");return n.setAttribute("cx",e/2),n.setAttribute("cy",i/2),n.setAttribute("rx",e/2-a/2),n.setAttribute("ry",i/2-a/2),n.setAttribute("stroke-width",a||1),n.setAttribute("stroke","transparent"),n.setAttribute("fill","transparent"),s.append(n),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#s}addHighlightArea(){this.container.classList.add("highlightArea")}}class dt extends m{#a=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:i}=u(t.rect),s=this.svgFactory.create(e,i,!0);let a=[];for(const e of t.vertices){const i=e.x-t.rect[0],s=t.rect[3]-e.y;a.push(i+","+s)}a=a.join(" ");const n=this.#a=this.svgFactory.createElement(this.svgElementName);return n.setAttribute("points",a),n.setAttribute("stroke-width",t.borderStyle.width||1),n.setAttribute("stroke","transparent"),n.setAttribute("fill","transparent"),s.append(n),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#a}addHighlightArea(){this.container.classList.add("highlightArea")}}class ht extends dt{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ct extends m{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class ut extends m{#n=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=s.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:i}=u(t.rect),s=this.svgFactory.create(e,i,!0);for(const e of t.inkLists){let i=[];for(const s of e){const e=s.x-t.rect[0],a=t.rect[3]-s.y;i.push(`${e},${a}`)}i=i.join(" ");const a=this.svgFactory.createElement(this.svgElementName);this.#n.push(a),a.setAttribute("points",i),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),!t.popupRef&&this.hasPopupData&&this._createPopup(),s.append(a)}return this.container.append(s),this.container}getElementsToTriggerPopup(){return this.#n}addHighlightArea(){this.container.classList.add("highlightArea")}}class ft extends m{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class pt extends m{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class gt extends m{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class mt extends m{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class bt extends m{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var vt=(0,p.default)("trigger"),yt=(0,p.default)("download");class At extends m{constructor(t){super(t,{isRenderable:!0}),Object.defineProperty(this,yt,{value:wt}),Object.defineProperty(this,vt,{writable:!0,value:null});const{filename:e,content:i}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(e,!0),this.content=i,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:e,content:i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||0===e.fillAlpha?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(100*e.fillAlpha)}%);`)),i.addEventListener("dblclick",(0,f.default)(this,yt)[yt].bind(this)),(0,f.default)(this,vt)[vt]=i;const{isMac:a}=s.FeatureTest.platform;return t.addEventListener("keydown",t=>{"Enter"===t.key&&(a?t.metaKey:t.ctrlKey)&&(0,f.default)(this,yt)[yt]()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return(0,f.default)(this,vt)[vt]}addHighlightArea(){this.container.classList.add("highlightArea")}}function wt(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}var _t=(0,p.default)("accessibilityManager"),xt=(0,p.default)("annotationCanvasMap"),Et=(0,p.default)("editableAnnotations"),Pt=(0,p.default)("appendElement"),St=(0,p.default)("setAnnotationCanvasMap");class Ct{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,page:s,viewport:a}){Object.defineProperty(this,St,{value:Mt}),Object.defineProperty(this,Pt,{value:Tt}),Object.defineProperty(this,_t,{writable:!0,value:null}),Object.defineProperty(this,xt,{writable:!0,value:null}),Object.defineProperty(this,Et,{writable:!0,value:new Map}),this.div=t,(0,f.default)(this,_t)[_t]=e,(0,f.default)(this,xt)[xt]=i,this.page=s,this.viewport=a,this.zIndex=0}async render(t){const{annotations:e}=t,i=this.div;(0,a.setLayerDimensions)(i,this.viewport);const r=new Map,o={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new a.DOMSVGFactory,annotationStorage:t.annotationStorage||new n.AnnotationStorage,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const t of e){if(t.noHTML)continue;const e=t.annotationType===s.AnnotationType.POPUP;if(e){const e=r.get(t.id);if(!e)continue;o.elements=e}else{const{width:e,height:i}=u(t.rect);if(e<=0||i<=0)continue}o.data=t;const i=g.create(o);if(!i.isRenderable)continue;if(!e&&t.popupRef){const e=r.get(t.popupRef);e?e.push(i):r.set(t.popupRef,[i])}i.annotationEditorType>0&&(0,f.default)(this,Et)[Et].set(i.data.id,i);const a=i.render();t.hidden&&(a.style.visibility="hidden"),(0,f.default)(this,Pt)[Pt](a,t.id)}(0,f.default)(this,St)[St]()}update({viewport:t}){const e=this.div;this.viewport=t,(0,a.setLayerDimensions)(e,{rotation:t.rotation}),(0,f.default)(this,St)[St](),e.hidden=!1}getEditableAnnotations(){return Array.from((0,f.default)(this,Et)[Et].values())}getEditableAnnotation(t){return(0,f.default)(this,Et)[Et].get(t)}}function Tt(t,e){const i=t.firstChild||t;i.id=`${s.AnnotationPrefix}${e}`,this.div.append(t),(0,f.default)(this,_t)[_t]?.moveElementInDOM(this.div,t,i,!1)}function Mt(){if(!(0,f.default)(this,xt)[xt])return;const t=this.div;for(const[e,i]of(0,f.default)(this,xt)[xt]){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;const{firstChild:a}=s;a?"CANVAS"===a.nodeName?a.replaceWith(i):a.before(i):s.append(i)}(0,f.default)(this,xt)[xt].clear()}},780:(t,e,i)=>{i.d(e,{AnnotationStorage:()=>h,PrintAnnotationStorage:()=>u,SerializableEmpty:()=>r});var s=i(266),a=i(115),n=i(825);const r=Object.freeze({map:null,hash:"",transfer:void 0});var o=(0,p.default)("modified"),l=(0,p.default)("storage"),d=(0,p.default)("setModified");class h{constructor(){Object.defineProperty(this,d,{value:c}),Object.defineProperty(this,o,{writable:!0,value:!1}),Object.defineProperty(this,l,{writable:!0,value:new Map}),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=(0,f.default)(this,l)[l].get(t);return void 0===i?e:Object.assign(e,i)}getRawValue(t){return(0,f.default)(this,l)[l].get(t)}remove(t){if((0,f.default)(this,l)[l].delete(t),0===(0,f.default)(this,l)[l].size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const t of(0,f.default)(this,l)[l].values())if(t instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=(0,f.default)(this,l)[l].get(t);let s=!1;if(void 0!==i)for(const[t,a]of Object.entries(e))i[t]!==a&&(s=!0,i[t]=a);else s=!0,(0,f.default)(this,l)[l].set(t,e);s&&(0,f.default)(this,d)[d](),e instanceof a.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}has(t){return(0,f.default)(this,l)[l].has(t)}getAll(){return(0,f.default)(this,l)[l].size>0?(0,s.objectFromMap)((0,f.default)(this,l)[l]):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return(0,f.default)(this,l)[l].size}resetModified(){(0,f.default)(this,o)[o]&&((0,f.default)(this,o)[o]=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new u(this)}get serializable(){if(0===(0,f.default)(this,l)[l].size)return r;const t=new Map,e=new n.MurmurHash3_64,i=[],s=Object.create(null);let o=!1;for(const[i,n]of(0,f.default)(this,l)[l]){const r=n instanceof a.AnnotationEditor?n.serialize(!1,s):n;r&&(t.set(i,r),e.update(`${i}:${JSON.stringify(r)}`),o||=!!r.bitmap)}if(o)for(const e of t.values())e.bitmap&&i.push(e.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:r}}function c(){(0,f.default)(this,o)[o]||((0,f.default)(this,o)[o]=!0,"function"==typeof this.onSetModified&&this.onSetModified())}class u extends h{#r;constructor(t){super();const{map:e,hash:i,transfer:s}=t.serializable,a=structuredClone(e,s?{transfer:s}:null);this.#r={map:a,hash:i,transfer:s}}get print(){(0,s.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#r}}},406:(t,e,i)=>{i.a(t,async(t,s)=>{try{i.d(e,{PDFDataRangeTransport:()=>W,PDFWorker:()=>tt,build:()=>dt,getDocument:()=>z,version:()=>lt});var a=i(266),n=i(780),r=i(473),o=i(742),l=i(738),d=i(250),h=i(368),c=i(694),u=i(472),g=i(890),m=i(92),b=i(171),v=i(474),y=i(498),A=i(521),w=t([l,y]);[l,y]=w.then?(await w)():w;const D=65536,L=100,j=5e3,N=a.isNodeJS?l.NodeCanvasFactory:r.DOMCanvasFactory,B=a.isNodeJS?l.NodeCMapReaderFactory:r.DOMCMapReaderFactory,U=a.isNodeJS?l.NodeFilterFactory:r.DOMFilterFactory,H=a.isNodeJS?l.NodeStandardFontDataFactory:r.DOMStandardFontDataFactory;function z(t){if("string"==typeof t||t instanceof URL?t={url:t}:(0,a.isArrayBuffer)(t)&&(t={data:t}),"object"!=typeof t)throw new Error("Invalid parameter in getDocument, need parameter object.");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new $,{docId:i}=e,s=t.url?q(t.url):null,n=t.data?G(t.data):null,o=t.httpHeaders||null,l=!0===t.withCredentials,d=t.password??null,u=t.range instanceof W?t.range:null,f=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:D;let p=t.worker instanceof tt?t.worker:null;const g=t.verbosity,A="string"!=typeof t.docBaseUrl||(0,r.isDataScheme)(t.docBaseUrl)?null:t.docBaseUrl,w="string"==typeof t.cMapUrl?t.cMapUrl:null,_=!1!==t.cMapPacked,x=t.CMapReaderFactory||B,E="string"==typeof t.standardFontDataUrl?t.standardFontDataUrl:null,P=t.StandardFontDataFactory||H,S=!0!==t.stopAtErrors,C=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,T=!1!==t.isEvalSupported,M="boolean"==typeof t.isOffscreenCanvasSupported?t.isOffscreenCanvasSupported:!a.isNodeJS,k=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,R="boolean"==typeof t.disableFontFace?t.disableFontFace:a.isNodeJS,O=!0===t.fontExtraProperties,F=!0===t.enableXfa,I=t.ownerDocument||globalThis.document,L=!0===t.disableRange,j=!0===t.disableStream,z=!0===t.disableAutoFetch,X=!0===t.pdfBug,K=u?u.length:t.length??NaN,Y="boolean"==typeof t.useSystemFonts?t.useSystemFonts:!a.isNodeJS&&!R,J="boolean"==typeof t.useWorkerFetch?t.useWorkerFetch:x===r.DOMCMapReaderFactory&&P===r.DOMStandardFontDataFactory&&w&&E&&(0,r.isValidFetchUrl)(w,document.baseURI)&&(0,r.isValidFetchUrl)(E,document.baseURI),Q=t.canvasFactory||new N({ownerDocument:I}),Z=t.filterFactory||new U({docId:i,ownerDocument:I});(0,a.setVerbosityLevel)(g);const et={canvasFactory:Q,filterFactory:Z};if(J||(et.cMapReaderFactory=new x({baseUrl:w,isCompressed:_}),et.standardFontDataFactory=new P({baseUrl:E})),!p){const t={verbosity:g,port:h.GlobalWorkerOptions.workerPort};p=t.port?tt.fromPort(t):new tt(t),e._worker=p}const st={docId:i,apiVersion:'4.0.379',data:n,password:d,disableAutoFetch:z,rangeChunkSize:f,length:K,docBaseUrl:A,enableXfa:F,evaluatorOptions:{maxImageSize:C,disableFontFace:R,ignoreErrors:S,isEvalSupported:T,isOffscreenCanvasSupported:M,canvasMaxAreaInBytes:k,fontExtraProperties:O,useSystemFonts:Y,cMapUrl:J?w:null,standardFontDataUrl:J?E:null}},at={ignoreErrors:S,isEvalSupported:T,disableFontFace:R,fontExtraProperties:O,enableXfa:F,ownerDocument:I,disableAutoFetch:z,pdfBug:X,styleElement:null};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const t=V(p,st),d=new Promise(function(t){let e;if(u)e=new m.PDFDataTransportStream({length:K,initialData:u.initialData,progressiveDone:u.progressiveDone,contentDispositionFilename:u.contentDispositionFilename,disableRange:L,disableStream:j},u);else if(!n){e=(t=>a.isNodeJS?new y.PDFNodeStream(t):(0,r.isValidFetchUrl)(t.url)?new b.PDFFetchStream(t):new v.PDFNetworkStream(t))({url:s,length:K,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:L,disableStream:j})}t(e)});return Promise.all([t,d]).then(function([t,s]){if(e.destroyed)throw new Error("Loading aborted");const a=new c.MessageHandler(i,t,p.port),n=new it(a,e,s,at,et);e._transport=n,a.send("Ready",null)})}).catch(e._capability.reject),e}async function V(t,e){if(t.destroyed)throw new Error("Worker was destroyed");const i=await t.messageHandler.sendWithPromise("GetDocRequest",e,e.data?[e.data.buffer]:null);if(t.destroyed)throw new Error("Worker was destroyed");return i}function q(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch{if(a.isNodeJS&&"string"==typeof t)return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function G(t){if(a.isNodeJS&&"undefined"!=typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"==typeof t)return(0,a.stringToBytes)(t);if("object"==typeof t&&!isNaN(t?.length)||(0,a.isArrayBuffer)(t))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class ${static#o=0;constructor(){this._capability=new a.PromiseCapability,this._transport=null,this._worker=null,this.docId="d"+$.#o++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}class W{constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new a.PromiseCapability}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){(0,a.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class X{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,a.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var _=(0,p.default)("delayedCleanupTimeout"),x=(0,p.default)("pendingCleanup"),E=(0,p.default)("tryCleanup"),P=(0,p.default)("abortDelayedCleanup");class K{constructor(t,e,i,s=!1){Object.defineProperty(this,P,{value:J}),Object.defineProperty(this,E,{value:Y}),Object.defineProperty(this,_,{writable:!0,value:null}),Object.defineProperty(this,x,{writable:!0,value:!1}),this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new r.StatTimer:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new at,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:a=!1}={}){return new r.PageViewport({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:a})}getAnnotations({intent:t="display"}={}){const e=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,a.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:s=a.AnnotationMode.ENABLE,transform:n=null,background:r=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:d=null,printAnnotationStorage:h=null}){this._stats?.time("Overall");const c=this._transport.getRenderingIntent(i,s,h);(0,f.default)(this,x)[x]=!1,(0,f.default)(this,P)[P](),o||(o=this._transport.getOptionalContentConfig());let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u)),u.streamReaderCancelTimeout&&(clearTimeout(u.streamReaderCancelTimeout),u.streamReaderCancelTimeout=null);const p=!!(c.renderingIntent&a.RenderingIntentFlag.PRINT);u.displayReadyCapability||(u.displayReadyCapability=new a.PromiseCapability,u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c));const g=t=>{u.renderTasks.delete(m),(this._maybeCleanupAfterRender||p)&&((0,f.default)(this,x)[x]=!0),(0,f.default)(this,E)[E](!p),t?(m.capability.reject(t),this._abortOperatorList({intentState:u,reason:t instanceof Error?t:new Error(t)})):m.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},m=new ot({callback:g,params:{canvasContext:t,viewport:e,transform:n,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:u.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!p,pdfBug:this._pdfBug,pageColors:d});(u.renderTasks||=new Set).add(m);const b=m.task;return Promise.all([u.displayReadyCapability.promise,o]).then(([t,e])=>{this.destroyed?g():(this._stats?.time("Rendering"),m.initializeGraphics({transparency:t,optionalContentConfig:e}),m.operatorListChanged())}).catch(g),b}getOperatorList({intent:t="display",annotationMode:e=a.AnnotationMode.ENABLE,printAnnotationStorage:i=null}={}){const s=this._transport.getRenderingIntent(t,e,i,!0);let n,r=this._intentStates.get(s.cacheKey);return r||(r=Object.create(null),this._intentStates.set(s.cacheKey,r)),r.opListReadCapability||(n=Object.create(null),n.operatorListChanged=function(){r.operatorList.lastChunk&&(r.opListReadCapability.resolve(r.operatorList),r.renderTasks.delete(n))},r.opListReadCapability=new a.PromiseCapability,(r.renderTasks||=new Set).add(n),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),r.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:100,size:t=>t.items.length})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(t=>A.XfaText.textContent(t));const e=this.streamTextContent(t);return new Promise(function(t,i){const s=e.getReader(),a={items:[],styles:Object.create(null)};!(function e(){s.read().then(function({value:i,done:s}){s?t(a):(Object.assign(a.styles,i.styles),a.items.push(...i.items),e())},i)})()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),(0,f.default)(this,x)[x]=!1,(0,f.default)(this,P)[P](),Promise.all(t)}cleanup(t=!1){(0,f.default)(this,x)[x]=!0;const e=(0,f.default)(this,E)[E](!1);return t&&e&&(this._stats&&=new r.StatTimer),e}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const t of e.renderTasks)t.operatorListChanged();t.lastChunk&&(0,f.default)(this,E)[E](!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i}){const{map:s,transfer:a}=i,n=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s},a).getReader(),r=this._intentStates.get(e);r.streamReader=n;const o=()=>{n.read().then(({value:t,done:e})=>{e?r.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,r),o())},t=>{if(r.streamReader=null,!this._transport.destroyed){if(r.operatorList){r.operatorList.lastChunk=!0;for(const t of r.renderTasks)t.operatorListChanged();(0,f.default)(this,E)[E](!0)}if(r.displayReadyCapability)r.displayReadyCapability.reject(t);else{if(!r.opListReadCapability)throw t;r.opListReadCapability.reject(t)}}})};o()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof r.RenderingCancelledException){let i=L;return e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),void(t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i))}}if(t.streamReader.cancel(new a.AbortException(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[e,i]of this._intentStates)if(i===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}function Y(t=!1){if((0,f.default)(this,P)[P](),!(0,f.default)(this,x)[x]||this.destroyed)return!1;if(t)return(0,f.default)(this,_)[_]=setTimeout(()=>{(0,f.default)(this,_)[_]=null,(0,f.default)(this,E)[E](!1)},j),!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),(0,f.default)(this,x)[x]=!1,!0}function J(){(0,f.default)(this,_)[_]&&(clearTimeout((0,f.default)(this,_)[_]),(0,f.default)(this,_)[_]=null)}class Q{#l=new Set;#d=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#d.then(()=>{for(const t of this.#l)t.call(this,i)})}addEventListener(t,e){this.#l.add(e)}removeEventListener(t,e){this.#l.delete(e)}terminate(){this.#l.clear()}}const Z={isWorkerDisabled:!1,fakeWorkerId:0};a.isNodeJS&&(Z.isWorkerDisabled=!0,h.GlobalWorkerOptions.workerSrc||="./pdf.worker.mjs"),Z.isSameOrigin=function(t,e){let i;try{if(i=new URL(t),!i.origin||"null"===i.origin)return!1}catch{return!1}const s=new URL(e,i);return i.origin===s.origin},Z.createCDNWrapper=function(t){const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};var S=(0,p.default)("workerPorts"),C=(0,p.default)("mainThreadWorkerMessageHandler");class tt{constructor({name:t=null,port:e=null,verbosity:i=(0,a.getVerbosityLevel)()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=new a.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,e){if((0,f.default)(tt,S)[S]?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");return((0,f.default)(tt,S)[S]||=new WeakMap).set(e,this),void this._initializeFromPort(e)}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new c.MessageHandler("main","worker",t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!Z.isWorkerDisabled&&!(0,f.default)(tt,C)[C]){let{workerSrc:t}=tt;try{Z.isSameOrigin(window.location.href,t)||(t=Z.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new c.MessageHandler("main","worker",e),s=()=>{e.removeEventListener("error",a),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||s()};e.addEventListener("error",a),i.on("test",t=>{e.removeEventListener("error",a),this.destroyed?s():t?(this._messageHandler=i,this._port=e,this._webWorker=e,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),e.terminate())}),i.on("ready",t=>{if(e.removeEventListener("error",a),this.destroyed)s();else try{n()}catch{this._setupFakeWorker()}});const n=()=>{const t=new Uint8Array;i.send("test",t,[t.buffer])};return void n()}catch{(0,a.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){Z.isWorkerDisabled||((0,a.warn)("Setting up fake worker."),Z.isWorkerDisabled=!0),tt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const e=new Q;this._port=e;const i="fake"+Z.fakeWorkerId++,s=new c.MessageHandler(i+"_worker",i,e);t.setup(s,e);const a=new c.MessageHandler(i,i+"_worker",e);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(0,f.default)(tt,S)[S]?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(0,f.default)(this,S)[S]?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new tt(t)}static get workerSrc(){if(h.GlobalWorkerOptions.workerSrc)return h.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return(0,a.shadow)(this,"_setupFakeWorkerGlobal",(async()=>{if((0,f.default)(this,C)[C])return(0,f.default)(this,C)[C];return(await import(this.workerSrc)).WorkerMessageHandler})())}}function et(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}Object.defineProperty(tt,C,{get:et,set:void 0}),Object.defineProperty(tt,S,{writable:!0,value:void 0});var T=(0,p.default)("methodPromises"),M=(0,p.default)("pageCache"),k=(0,p.default)("pagePromises"),R=(0,p.default)("passwordCapability"),O=(0,p.default)("cacheSimpleMethod");class it{constructor(t,e,i,s,n){Object.defineProperty(this,O,{value:st}),Object.defineProperty(this,T,{writable:!0,value:new Map}),Object.defineProperty(this,M,{writable:!0,value:new Map}),Object.defineProperty(this,k,{writable:!0,value:new Map}),Object.defineProperty(this,R,{writable:!0,value:null}),this.messageHandler=t,this.loadingTask=e,this.commonObjs=new at,this.fontLoader=new o.FontLoader({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this._params=s,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new a.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,a.shadow)(this,"annotationStorage",new n.AnnotationStorage)}getRenderingIntent(t,e=a.AnnotationMode.ENABLE,i=null,s=!1){let r=a.RenderingIntentFlag.DISPLAY,o=n.SerializableEmpty;switch(t){case"any":r=a.RenderingIntentFlag.ANY;break;case"display":break;case"print":r=a.RenderingIntentFlag.PRINT;break;default:(0,a.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(e){case a.AnnotationMode.DISABLE:r+=a.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case a.AnnotationMode.ENABLE:break;case a.AnnotationMode.ENABLE_FORMS:r+=a.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case a.AnnotationMode.ENABLE_STORAGE:r+=a.RenderingIntentFlag.ANNOTATIONS_STORAGE;o=(r&a.RenderingIntentFlag.PRINT&&i instanceof n.PrintAnnotationStorage?i:this.annotationStorage).serializable;break;default:(0,a.warn)(`getRenderingIntent - invalid annotationMode: ${e}`)}return s&&(r+=a.RenderingIntentFlag.OPLIST),{renderingIntent:r,cacheKey:`${r}_${o.hash}`,annotationStorageSerializable:o}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new a.PromiseCapability,(0,f.default)(this,R)[R]?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const e of(0,f.default)(this,M)[M].values())t.push(e._destroy());(0,f.default)(this,M)[M].clear(),(0,f.default)(this,k)[k].clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),(0,f.default)(this,T)[T].clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new a.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(t,e)=>{(0,a.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},e.onPull=()=>{this._fullReader.read().then(function({value:t,done:i}){i?e.close():((0,a.assert)(t instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))}).catch(t=>{e.error(t)})},e.onCancel=t=>{this._fullReader.cancel(t),e.ready.catch(t=>{if(!this.destroyed)throw t})}}),t.on("ReaderHeadersReady",t=>{const i=new a.PromiseCapability,s=this._fullReader;return s.headersReady.then(()=>{s.isStreamingSupported&&s.isRangeSupported||(this._lastProgress&&e.onProgress?.(this._lastProgress),s.onProgress=t=>{e.onProgress?.({loaded:t.loaded,total:t.total})}),i.resolve({isStreamingSupported:s.isStreamingSupported,isRangeSupported:s.isRangeSupported,contentLength:s.contentLength})},i.reject),i.promise}),t.on("GetRangeReader",(t,e)=>{(0,a.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(t.begin,t.end);i?(e.onPull=()=>{i.read().then(function({value:t,done:i}){i?e.close():((0,a.assert)(t instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))}).catch(t=>{e.error(t)})},e.onCancel=t=>{i.cancel(t),e.ready.catch(t=>{if(!this.destroyed)throw t})}):e.close()}),t.on("GetDoc",({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,e._capability.resolve(new X(t,this))}),t.on("DocException",function(t){let i;switch(t.name){case"PasswordException":i=new a.PasswordException(t.message,t.code);break;case"InvalidPDFException":i=new a.InvalidPDFException(t.message);break;case"MissingPDFException":i=new a.MissingPDFException(t.message);break;case"UnexpectedResponseException":i=new a.UnexpectedResponseException(t.message,t.status);break;case"UnknownErrorException":i=new a.UnknownErrorException(t.message,t.details);break;default:(0,a.unreachable)("DocException - expected a valid Error.")}e._capability.reject(i)}),t.on("PasswordRequest",t=>{if((0,f.default)(this,R)[R]=new a.PromiseCapability,e.onPassword){const i=t=>{t instanceof Error?(0,f.default)(this,R)[R].reject(t):(0,f.default)(this,R)[R].resolve({password:t})};try{e.onPassword(i,t.code)}catch(t){(0,f.default)(this,R)[R].reject(t)}}else(0,f.default)(this,R)[R].reject(new a.PasswordException(t.message,t.code));return(0,f.default)(this,R)[R].promise}),t.on("DataLoaded",t=>{e.onProgress?.({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)}),t.on("StartRenderPage",t=>{if(this.destroyed)return;(0,f.default)(this,M)[M].get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)}),t.on("commonobj",([e,i,s])=>{if(this.destroyed)return null;if(this.commonObjs.has(e))return null;switch(i){case"Font":const n=this._params;if("error"in s){const t=s.error;(0,a.warn)(`Error during font loading: ${t}`),this.commonObjs.resolve(e,t);break}const r=n.pdfBug&&globalThis.FontInspector?.enabled?(t,e)=>globalThis.FontInspector.fontAdded(t,e):null,l=new o.FontFaceObject(s,{isEvalSupported:n.isEvalSupported,disableFontFace:n.disableFontFace,ignoreErrors:n.ignoreErrors,inspectFont:r});this.fontLoader.bind(l).catch(i=>t.sendWithPromise("FontFallback",{id:e})).finally(()=>{!n.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(e,l)});break;case"CopyLocalImage":const{imageRef:d}=s;(0,a.assert)(d,"The imageRef must be defined.");for(const t of(0,f.default)(this,M)[M].values())for(const[,i]of t.objs)if(i.ref===d)return i.dataLen?(this.commonObjs.resolve(e,structuredClone(i)),i.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(e,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([t,e,i,s])=>{if(this.destroyed)return;const n=(0,f.default)(this,M)[M].get(e);if(!n.objs.has(t))if(0!==n._intentStates.size)switch(i){case"Image":n.objs.resolve(t,s),s?.dataLen>a.MAX_IMAGE_SIZE_TO_CACHE&&(n._maybeCleanupAfterRender=!0);break;case"Pattern":n.objs.resolve(t,s);break;default:throw new Error(`Got unknown object type ${i}`)}else s?.bitmap?.close()}),t.on("DocProgress",t=>{this.destroyed||e.onProgress?.({loaded:t.loaded,total:t.total})}),t.on("FetchBuiltInCMap",t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(t):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(t):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,a.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=(0,f.default)(this,k)[k].get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(t=>{if(this.destroyed)throw new Error("Transport destroyed");const i=new K(e,t,this,this._params.pdfBug);return(0,f.default)(this,M)[M].set(e,i),i});return(0,f.default)(this,k)[k].set(e,s),s}getPageIndex(t){return"object"!=typeof t||null===t||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return(0,f.default)(this,O)[O]("GetFieldObjects")}hasJSActions(){return(0,f.default)(this,O)[O]("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return(0,f.default)(this,O)[O]("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new g.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=(0,f.default)(this,T)[T].get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(t=>({info:t[0],metadata:t[1]?new u.Metadata(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return(0,f.default)(this,T)[T].set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of(0,f.default)(this,M)[M].values()){if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`)}this.commonObjs.clear(),t||this.fontLoader.clear(),(0,f.default)(this,T)[T].clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:t,enableXfa:e}=this._params;return(0,a.shadow)(this,"loadingParams",{disableAutoFetch:t,enableXfa:e})}}function st(t,e=null){const i=(0,f.default)(this,T)[T].get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return(0,f.default)(this,T)[T].set(t,s),s}var F=(0,p.default)("objs"),I=(0,p.default)("ensureObj");class at{constructor(){Object.defineProperty(this,I,{value:nt}),Object.defineProperty(this,F,{writable:!0,value:Object.create(null)})}get(t,e=null){if(e){const i=(0,f.default)(this,I)[I](t);return i.capability.promise.then(()=>e(i.data)),null}const i=(0,f.default)(this,F)[F][t];if(!i?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=(0,f.default)(this,F)[F][t];return e?.capability.settled??!1}resolve(t,e=null){const i=(0,f.default)(this,I)[I](t);i.data=e,i.capability.resolve()}clear(){for(const t in(0,f.default)(this,F)[F]){const{data:e}=(0,f.default)(this,F)[F][t];e?.bitmap?.close()}(0,f.default)(this,F)[F]=Object.create(null)}*[Symbol.iterator](){for(const t in(0,f.default)(this,F)[F]){const{capability:e,data:i}=(0,f.default)(this,F)[F][t];e.settled&&(yield[t,i])}}}function nt(t){return(0,f.default)(this,F)[F][t]||={capability:new a.PromiseCapability,data:null}}class rt{#h=null;constructor(t){this.#h=t,this.onContinue=null}get promise(){return this.#h.capability.promise}cancel(t=0){this.#h.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#h.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#h;return t.form||t.canvas&&e?.size>0}}class ot{static#c=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:n,operatorList:r,pageIndex:o,canvasFactory:l,filterFactory:d,useRequestAnimationFrame:h=!1,pdfBug:c=!1,pageColors:u=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=d,this._pdfBug=c,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===h&&"undefined"!=typeof window,this.cancelled=!1,this.capability=new a.PromiseCapability,this.task=new rt(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(ot.#c.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ot.#c.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:a,background:n}=this.params;this.gfx=new d.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:s,transparency:t,background:n}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),ot.#c.delete(this._canvas),this.callback(t||new r.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ot.#c.delete(this._canvas),this.callback())))}}const lt='4.0.379',dt='9e14d04fd';s()}catch(ht){s(ht)}})},822:(t,e,i)=>{i.d(e,{BaseCMapReaderFactory:()=>r,BaseCanvasFactory:()=>n,BaseFilterFactory:()=>a,BaseSVGFactory:()=>l,BaseStandardFontDataFactory:()=>o});var s=i(266);class a{constructor(){this.constructor===a&&(0,s.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addHighlightHCMFilter(t,e,i,s){return"none"}destroy(t=!1){}}class n{constructor(){this.constructor===n&&(0,s.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d")}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){(0,s.unreachable)("Abstract method `_createCanvas` called.")}}class r{constructor({baseUrl:t=null,isCompressed:e=!0}){this.constructor===r&&(0,s.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("The CMap \"baseUrl\" parameter must be specified, ensure that the \"cMapUrl\" and \"cMapPacked\" API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?s.CMapCompressionType.BINARY:s.CMapCompressionType.NONE;return this._fetchData(e,i).catch(t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}_fetchData(t,e){(0,s.unreachable)("Abstract method `_fetchData` called.")}}class o{constructor({baseUrl:t=null}){this.constructor===o&&(0,s.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("The standard font \"baseUrl\" parameter must be specified, ensure that the \"standardFontDataUrl\" API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetchData(e).catch(t=>{throw new Error(`Unable to load font data at: ${e}`)})}_fetchData(t){(0,s.unreachable)("Abstract method `_fetchData` called.")}}class l{constructor(){this.constructor===l&&(0,s.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,s.unreachable)("Abstract method `_createSVG` called.")}}},250:(t,e,i)=>{i.d(e,{CanvasGraphics:()=>G});var s=i(266),a=i(473);const n="Fill",r="Stroke",o="Shading";function l(t,e){if(!e)return;const i=e[2]-e[0],s=e[3]-e[1],a=new Path2D;a.rect(e[0],e[1],i,s),t.clip(a)}class d{constructor(){this.constructor===d&&(0,s.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,s.unreachable)("Abstract method `getPattern` called.")}}class h extends d{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const t of this._colorStops)e.addColorStop(t[0],t[1]);return e}getPattern(t,e,i,o){let d;if(o===r||o===n){const n=e.current.getClippedPathBoundingBox(o,(0,a.getCurrentTransform)(t))||[0,0,0,0],r=Math.ceil(n[2]-n[0])||1,h=Math.ceil(n[3]-n[1])||1,c=e.cachedCanvases.getCanvas("pattern",r,h,!0),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-n[0],-n[1]),i=s.Util.transform(i,[1,0,0,1,n[0],n[1]]),u.transform(...e.baseTransform),this.matrix&&u.transform(...this.matrix),l(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),d=t.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(i);d.setTransform(f)}else l(t,this._bbox),d=this._createGradient(t);return d}}function c(t,e,i,s,a,n,r,o){const l=e.coords,d=e.colors,h=t.data,c=4*t.width;let u;l[i+1]>l[s+1]&&(u=i,i=s,s=u,u=n,n=r,r=u),l[s+1]>l[a+1]&&(u=s,s=a,a=u,u=r,r=o,o=u),l[i+1]>l[s+1]&&(u=i,i=s,s=u,u=n,n=r,r=u);const f=(l[i]+e.offsetX)*e.scaleX,p=(l[i+1]+e.offsetY)*e.scaleY,g=(l[s]+e.offsetX)*e.scaleX,m=(l[s+1]+e.offsetY)*e.scaleY,b=(l[a]+e.offsetX)*e.scaleX,v=(l[a+1]+e.offsetY)*e.scaleY;if(p>=v)return;const y=d[n],A=d[n+1],w=d[n+2],_=d[r],x=d[r+1],E=d[r+2],P=d[o],S=d[o+1],C=d[o+2],T=Math.round(p),M=Math.round(v);let k,R,O,F,I,D,L,j;for(let t=T;t<=M;t++){if(t<m){const e=t<p?0:(p-t)/(p-m);k=f-(f-g)*e,R=y-(y-_)*e,O=A-(A-x)*e,F=w-(w-E)*e}else{let e;e=t>v?1:m===v?0:(m-t)/(m-v),k=g-(g-b)*e,R=_-(_-P)*e,O=x-(x-S)*e,F=E-(E-C)*e}let e;e=t<p?0:t>v?1:(p-t)/(p-v),I=f-(f-b)*e,D=y-(y-P)*e,L=A-(A-S)*e,j=w-(w-C)*e;const i=Math.round(Math.min(k,I)),s=Math.round(Math.max(k,I));let a=c*t+4*i;for(let t=i;t<=s;t++)e=(k-t)/(k-I),e<0?e=0:e>1&&(e=1),h[a++]=R-(R-D)*e|0,h[a++]=O-(O-L)*e|0,h[a++]=F-(F-j)*e|0,h[a++]=255}}function u(t,e,i){const s=e.coords,a=e.colors;let n,r;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(s.length/o)-1,d=o-1;for(n=0;n<l;n++){let e=n*o;for(let n=0;n<d;n++,e++)c(t,i,s[e],s[e+1],s[e+o],a[e],a[e+1],a[e+o]),c(t,i,s[e+o+1],s[e+1],s[e+o],a[e+o+1],a[e+1],a[e+o])}break;case"triangles":for(n=0,r=s.length;n<r;n+=3)c(t,i,s[n],s[n+1],s[n+2],a[n],a[n+1],a[n+2]);break;default:throw new Error("illegal figure")}}class g extends d{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const s=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),n=Math.ceil(this._bounds[2])-s,r=Math.ceil(this._bounds[3])-a,o=Math.min(Math.ceil(Math.abs(n*t[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(r*t[1]*1.1)),3e3),d=n/o,h=r/l,c={coords:this._coords,colors:this._colors,offsetX:-s,offsetY:-a,scaleX:1/d,scaleY:1/h},f=o+4,p=l+4,g=i.getCanvas("mesh",f,p,!1),m=g.context,b=m.createImageData(o,l);if(e){const t=b.data;for(let i=0,s=t.length;i<s;i+=4)t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=255}for(const t of this._figures)u(b,t,c);m.putImageData(b,2,2);return{canvas:g.canvas,offsetX:s-2*d,offsetY:a-2*h,scaleX:d,scaleY:h}}getPattern(t,e,i,n){let r;if(l(t,this._bbox),n===o)r=s.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(t));else if(r=s.Util.singularValueDecompose2dScale(e.baseTransform),this.matrix){const t=s.Util.singularValueDecompose2dScale(this.matrix);r=[r[0]*t[0],r[1]*t[1]]}const d=this._createMeshCanvas(r,n===o?null:this._background,e.cachedCanvases);return n!==o&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(d.offsetX,d.offsetY),t.scale(d.scaleX,d.scaleY),t.createPattern(d.canvas,"no-repeat")}}class m extends d{getPattern(){return"hotpink"}}function b(t){switch(t[0]){case"RadialAxial":return new h(t);case"Mesh":return new g(t);case"Dummy":return new m}throw new Error(`Unknown IR type: ${t[0]}`)}const v=1,y=2;class A{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,s,a){this.operatorList=t[2],this.matrix=t[3]||[1,0,0,1,0,0],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(t){const e=this.operatorList,i=this.bbox,n=this.xstep,r=this.ystep,o=this.paintType,l=this.tilingType,d=this.color,h=this.canvasGraphicsFactory;(0,s.info)("TilingType: "+l);const c=i[0],u=i[1],f=i[2],p=i[3],g=s.Util.singularValueDecompose2dScale(this.matrix),m=s.Util.singularValueDecompose2dScale(this.baseTransform),b=[g[0]*m[0],g[1]*m[1]],v=this.getSizeAndScale(n,this.ctx.canvas.width,b[0]),y=this.getSizeAndScale(r,this.ctx.canvas.height,b[1]),A=t.cachedCanvases.getCanvas("pattern",v.size,y.size,!0),w=A.context,_=h.createCanvasGraphics(w);_.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(_,o,d);let x=c,E=u,P=f,S=p;return c<0&&(x=0,P+=Math.abs(c)),u<0&&(E=0,S+=Math.abs(u)),w.translate(-v.scale*x,-y.scale*E),_.transform(v.scale,0,0,y.scale,0,0),w.save(),this.clipBbox(_,x,E,P,S),_.baseTransform=(0,a.getCurrentTransform)(_.ctx),_.executeOperatorList(e),_.endDrawing(),{canvas:A.canvas,scaleX:v.scale,scaleY:y.scale,offsetX:x,offsetY:E}}getSizeAndScale(t,e,i){t=Math.abs(t);const s=Math.max(A.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*i);return a>=s?a=s:i=a/t,{scale:i,size:a}}clipBbox(t,e,i,s,n){const r=s-e,o=n-i;t.ctx.rect(e,i,r,o),t.current.updateRectMinMax((0,a.getCurrentTransform)(t.ctx),[e,i,s,n]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const a=t.ctx,n=t.current;switch(e){case v:const t=this.ctx;a.fillStyle=t.fillStyle,a.strokeStyle=t.strokeStyle,n.fillColor=t.fillStyle,n.strokeColor=t.strokeStyle;break;case y:const r=s.Util.makeHexColor(i[0],i[1],i[2]);a.fillStyle=r,a.strokeStyle=r,n.fillColor=r,n.strokeColor=r;break;default:throw new s.FormatError(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,a){let n=i;a!==o&&(n=s.Util.transform(n,e.baseTransform),this.matrix&&(n=s.Util.transform(n,this.matrix)));const r=this.createPatternCanvas(e);let l=new DOMMatrix(n);l=l.translate(r.offsetX,r.offsetY),l=l.scale(1/r.scaleX,1/r.scaleY);const d=t.createPattern(r.canvas,"repeat");return d.setTransform(l),d}}function w({src:t,srcPos:e=0,dest:i,width:a,height:n,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const l=s.FeatureTest.isLittleEndian?4278190080:255,[d,h]=o?[r,l]:[l,r],c=a>>3,u=7&a,f=t.length;i=new Uint32Array(i.buffer);let p=0;for(let s=0;s<n;s++){for(const s=e+c;e<s;e++){const s=e<f?t[e]:255;i[p++]=128&s?h:d,i[p++]=64&s?h:d,i[p++]=32&s?h:d,i[p++]=16&s?h:d,i[p++]=8&s?h:d,i[p++]=4&s?h:d,i[p++]=2&s?h:d,i[p++]=1&s?h:d}if(0===u)continue;const s=e<f?t[e++]:255;for(let t=0;t<u;t++)i[p++]=s&1<<7-t?h:d}return{srcPos:e,destPos:p}}const _=4096,x=16;function E(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},t.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},t.transform=function(t,i,s,a,n,r){e.transform(t,i,s,a,n,r),this.__originalTransform(t,i,s,a,n,r)},t.setTransform=function(t,i,s,a,n,r){e.setTransform(t,i,s,a,n,r),this.__originalSetTransform(t,i,s,a,n,r)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(t){e.rotate(t),this.__originalRotate(t)},t.clip=function(t){e.clip(t),this.__originalClip(t)},t.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},t.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},t.bezierCurveTo=function(t,i,s,a,n,r){e.bezierCurveTo(t,i,s,a,n,r),this.__originalBezierCurveTo(t,i,s,a,n,r)},t.rect=function(t,i,s,a){e.rect(t,i,s,a),this.__originalRect(t,i,s,a)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class P{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return void 0!==this.cache[t]?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function S(t,e,i,s,n,r,o,l,d,h){const[c,u,f,p,g,m]=(0,a.getCurrentTransform)(t);if(0===u&&0===f){const a=o*c+g,b=Math.round(a),v=l*p+m,y=Math.round(v),A=(o+d)*c+g,w=Math.abs(Math.round(A)-b)||1,_=(l+h)*p+m,x=Math.abs(Math.round(_)-y)||1;return t.setTransform(Math.sign(c),0,0,Math.sign(p),b,y),t.drawImage(e,i,s,n,r,0,0,w,x),t.setTransform(c,u,f,p,g,m),[w,x]}if(0===c&&0===p){const a=l*f+g,b=Math.round(a),v=o*u+m,y=Math.round(v),A=(l+h)*f+g,w=Math.abs(Math.round(A)-b)||1,_=(o+d)*u+m,x=Math.abs(Math.round(_)-y)||1;return t.setTransform(0,Math.sign(u),Math.sign(f),0,b,y),t.drawImage(e,i,s,n,r,0,0,x,w),t.setTransform(c,u,f,p,g,m),[x,w]}t.drawImage(e,i,s,n,r,o,l,d,h);return[Math.hypot(c,u)*d,Math.hypot(f,p)*h]}function C(t){const{width:e,height:i}=t;if(e>1e3||i>1e3)return null;const s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=e+1;let n,r,o,l=new Uint8Array(a*(i+1));const d=e+7&-8;let h=new Uint8Array(d*i),c=0;for(const e of t.data){let t=128;for(;t>0;)h[c++]=e&t?0:255,t>>=1}let u=0;for(c=0,0!==h[c]&&(l[0]=1,++u),r=1;r<e;r++)h[c]!==h[c+1]&&(l[r]=h[c]?2:1,++u),c++;for(0!==h[c]&&(l[r]=2,++u),n=1;n<i;n++){c=n*d,o=n*a,h[c-d]!==h[c]&&(l[o]=h[c]?1:8,++u);let t=(h[c]?4:0)+(h[c-d]?8:0);for(r=1;r<e;r++)t=(t>>2)+(h[c+1]?4:0)+(h[c-d+1]?8:0),s[t]&&(l[o+r]=s[t],++u),c++;if(h[c-d]!==h[c]&&(l[o+r]=h[c]?2:4,++u),u>1e3)return null}for(c=d*(i-1),o=n*a,0!==h[c]&&(l[o]=8,++u),r=1;r<e;r++)h[c]!==h[c+1]&&(l[o+r]=h[c]?4:8,++u),c++;if(0!==h[c]&&(l[o+r]=4,++u),u>1e3)return null;const f=new Int32Array([0,a,-1,0,-a,0,0,0,1]),p=new Path2D;for(n=0;u&&n<=i;n++){let t=n*a;const i=t+e;for(;t<i&&!l[t];)t++;if(t===i)continue;p.moveTo(t%a,n);const s=t;let r=l[t];do{const e=f[r];do{t+=e}while(!l[t]);const i=l[t];5!==i&&10!==i?(r=i,l[t]=0):(r=i&51*r>>4,l[t]&=r>>2|r<<2),p.lineTo(t%a,t/a|0),l[t]||--u}while(s!==t);--n}h=null,l=null;return function(t){t.save(),t.scale(1/e,-1/i),t.translate(0,-i),t.fill(p),t.beginPath(),t.restore()}}class T{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=s.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=s.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=s.Util.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=s.Util.applyTransform(e,t),a=s.Util.applyTransform(e.slice(2),t),n=s.Util.applyTransform([e[0],e[3]],t),r=s.Util.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],a[0],n[0],r[0]),this.minY=Math.min(this.minY,i[1],a[1],n[1],r[1]),this.maxX=Math.max(this.maxX,i[0],a[0],n[0],r[0]),this.maxY=Math.max(this.maxY,i[1],a[1],n[1],r[1])}updateScalingPathMinMax(t,e){s.Util.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.maxX=Math.max(this.maxX,e[1]),this.minY=Math.min(this.minY,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,a,n,r,o,l,d,h){const c=s.Util.bezierBoundingBox(e,i,a,n,r,o,l,d);if(h)return h[0]=Math.min(h[0],c[0],c[2]),h[1]=Math.max(h[1],c[0],c[2]),h[2]=Math.min(h[2],c[1],c[3]),void(h[3]=Math.max(h[3],c[1],c[3]));this.updateRectMinMax(t,c)}getPathBoundingBox(t=n,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===r){e||(0,s.unreachable)("Stroke bounding box must include transform.");const t=s.Util.singularValueDecompose2dScale(e),a=t[0]*this.lineWidth/2,n=t[1]*this.lineWidth/2;i[0]-=a,i[1]-=n,i[2]+=a,i[3]+=n}return i}updateClipFromPath(){const t=s.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=n,e=null){return s.Util.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function M(t,e){if("undefined"!=typeof ImageData&&e instanceof ImageData)return void t.putImageData(e,0,0);const i=e.height,a=e.width,n=i%x,r=(i-n)/x,o=0===n?r:r+1,l=t.createImageData(a,x);let d,h=0;const c=e.data,u=l.data;let f,p,g,m;if(e.kind===s.ImageKind.GRAYSCALE_1BPP){const e=c.byteLength,i=new Uint32Array(u.buffer,0,u.byteLength>>2),m=i.length,b=a+7>>3,v=4294967295,y=s.FeatureTest.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(g=f<r?x:n,d=0,p=0;p<g;p++){const t=e-h;let s=0;const n=t>b?a:8*t-7,r=-8&n;let o=0,l=0;for(;s<r;s+=8)l=c[h++],i[d++]=128&l?v:y,i[d++]=64&l?v:y,i[d++]=32&l?v:y,i[d++]=16&l?v:y,i[d++]=8&l?v:y,i[d++]=4&l?v:y,i[d++]=2&l?v:y,i[d++]=1&l?v:y;for(;s<n;s++)0===o&&(l=c[h++],o=128),i[d++]=l&o?v:y,o>>=1}for(;d<m;)i[d++]=0;t.putImageData(l,0,f*x)}}else if(e.kind===s.ImageKind.RGBA_32BPP){for(p=0,m=a*x*4,f=0;f<r;f++)u.set(c.subarray(h,h+m)),h+=m,t.putImageData(l,0,p),p+=x;f<o&&(m=a*n*4,u.set(c.subarray(h,h+m)),t.putImageData(l,0,p))}else{if(e.kind!==s.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${e.kind}`);for(g=x,m=a*g,f=0;f<o;f++){for(f>=r&&(g=n,m=a*g),d=0,p=m;p--;)u[d++]=c[h++],u[d++]=c[h++],u[d++]=c[h++],u[d++]=255;t.putImageData(l,0,f*x)}}}function k(t,e){if(e.bitmap)return void t.drawImage(e.bitmap,0,0);const i=e.height,s=e.width,a=i%x,n=(i-a)/x,r=0===a?n:n+1,o=t.createImageData(s,x);let l=0;const d=e.data,h=o.data;for(let e=0;e<r;e++){const i=e<n?x:a;({srcPos:l}=w({src:d,srcPos:l,dest:h,width:s,height:i,nonBlackColor:0})),t.putImageData(o,0,e*x)}}function R(t,e){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)void 0!==t[s]&&(e[s]=t[s]);void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function O(t){if(t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0),!s.isNodeJS){const{filter:e}=t;"none"!==e&&""!==e&&(t.filter="none")}}function F(t,e,i,s){const a=t.length;for(let n=3;n<a;n+=4){const a=t[n];if(0===a)t[n-3]=e,t[n-2]=i,t[n-1]=s;else if(a<255){const r=255-a;t[n-3]=t[n-3]*a+e*r>>8,t[n-2]=t[n-2]*a+i*r>>8,t[n-1]=t[n-1]*a+s*r>>8}}}function I(t,e,i){const s=t.length;for(let a=3;a<s;a+=4){const s=i?i[t[a]]:t[a];e[a]=e[a]*s*.00392156862745098|0}}function D(t,e,i){const s=t.length;for(let a=3;a<s;a+=4){const s=77*t[a-3]+152*t[a-2]+28*t[a-1];e[a]=i?e[a]*i[s>>8]>>8:e[a]*s>>16}}function L(t,e,i,s,a,n,r,o,l,d,h){const c=!!n,u=c?n[0]:0,f=c?n[1]:0,p=c?n[2]:0,g="Luminosity"===a?D:I,m=Math.min(s,Math.ceil(1048576/i));for(let a=0;a<s;a+=m){const n=Math.min(m,s-a),b=t.getImageData(o-d,a+(l-h),i,n),v=e.getImageData(o,a+l,i,n);c&&F(b.data,u,f,p),g(b.data,v.data,r),e.putImageData(v,o,a+l)}}function j(t,e,i,s){const a=s[0],n=s[1],r=s[2]-a,o=s[3]-n;0!==r&&0!==o&&(L(e.context,i,r,o,e.subtype,e.backdrop,e.transferMap,a,n,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}function N(t,e){const i=s.Util.singularValueDecompose2dScale(t);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*a.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==e?e:i[0]<=n||i[1]<=n}const B=["butt","round","square"],U=["miter","round","bevel"],H={},z={};var V=(0,p.default)("restoreInitialState"),q=(0,p.default)("drawFilter");class G{constructor(t,e,i,s,a,{optionalContentConfig:n,markedContentStack:r=null},o,l){Object.defineProperty(this,q,{value:W}),Object.defineProperty(this,V,{value:$}),this.ctx=t,this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=r||[],this.optionalContentConfig=n,this.cachedCanvases=new P(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const n=this.ctx.canvas.width,r=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,n,r),this.ctx.fillStyle=o,i){const t=this.cachedCanvases.getCanvas("transparent",n,r);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform(...(0,a.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),O(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=(0,a.getCurrentTransform)(this.ctx)}executeOperatorList(t,e,i,a){const n=t.argsArray,r=t.fnArray;let o=e||0;const l=n.length;if(l===o)return o;const d=l-o>10&&"function"==typeof i,h=d?Date.now()+15:0;let c=0;const u=this.commonObjs,f=this.objs;let p;for(;;){if(void 0!==a&&o===a.nextBreakPoint)return a.breakIt(o,i),o;if(p=r[o],p!==s.OPS.dependency)this[p].apply(this,n[o]);else for(const t of n[o]){const e=t.startsWith("g_")?u:f;if(!e.has(t))return e.get(t,i),o}if(o++,o===l)return o;if(d&&++c>10){if(Date.now()>h)return i(),o;c=0}}}endDrawing(){(0,f.default)(this,V)[V](),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),(0,f.default)(this,q)[q]()}_scaleImage(t,e){const i=t.width,s=t.height;let a,n,r=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=i,d=s,h="prescale1";for(;r>2&&l>1||o>2&&d>1;){let e=l,i=d;r>2&&l>1&&(e=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),r/=l/e),o>2&&d>1&&(i=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,o/=d/i),a=this.cachedCanvases.getCanvas(h,e,i),n=a.context,n.clearRect(0,0,e,i),n.drawImage(t,0,0,l,d,0,0,e,i),t=a.canvas,l=e,d=i,h="prescale1"===h?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:d}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:r}=t,o=this.current.fillColor,l=this.current.patternFill,d=(0,a.getCurrentTransform)(e);let h,c,u,f;if((t.bitmap||t.data)&&t.count>1){const e=t.bitmap||t.data.buffer;c=JSON.stringify(l?d:[d.slice(0,4),o]),h=this._cachedBitmapsMap.get(e),h||(h=new Map,this._cachedBitmapsMap.set(e,h));const i=h.get(c);if(i&&!l){return{canvas:i,offsetX:Math.round(Math.min(d[0],d[2])+d[4]),offsetY:Math.round(Math.min(d[1],d[3])+d[5])}}u=i}u||(f=this.cachedCanvases.getCanvas("maskCanvas",i,r),k(f.context,t));let p=s.Util.transform(d,[1/i,0,0,-1/r,0,0]);p=s.Util.transform(p,[1,0,0,1,0,-r]);const[g,m,b,v]=s.Util.getAxialAlignedBoundingBox([0,0,i,r],p),y=Math.round(b-g)||1,A=Math.round(v-m)||1,w=this.cachedCanvases.getCanvas("fillCanvas",y,A),_=w.context,x=g,E=m;_.translate(-x,-E),_.transform(...p),u||(u=this._scaleImage(f.canvas,(0,a.getCurrentTransformInverse)(_)),u=u.img,h&&l&&h.set(c,u)),_.imageSmoothingEnabled=N((0,a.getCurrentTransform)(_),t.interpolate),S(_,u,0,0,u.width,u.height,0,0,i,r),_.globalCompositeOperation="source-in";const P=s.Util.transform((0,a.getCurrentTransformInverse)(_),[1,0,0,1,-x,-E]);return _.fillStyle=l?o.getPattern(e,this,P,n):o,_.fillRect(0,0,i,r),h&&!l&&(this.cachedCanvases.delete("fillCanvas"),h.set(c,w.canvas)),{canvas:w.canvas,offsetX:Math.round(x),offsetY:Math.round(E)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=B[t]}setLineJoin(t){this.ctx.lineJoin=U[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx,this.ctx=s.context;const n=this.ctx;n.setTransform(...(0,a.getCurrentTransform)(this.suspendedCtx)),R(this.suspendedCtx,n),E(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),R(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask;j(this.suspendedCtx,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(R(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),R(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,s,a,n){this.ctx.transform(t,e,i,s,a,n),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const n=this.ctx,r=this.current;let o,l,d=r.x,h=r.y;const c=(0,a.getCurrentTransform)(n),u=0===c[0]&&0===c[3]||0===c[1]&&0===c[2],f=u?i.slice(0):null;for(let i=0,a=0,p=t.length;i<p;i++)switch(0|t[i]){case s.OPS.rectangle:d=e[a++],h=e[a++];const t=e[a++],i=e[a++],p=d+t,g=h+i;n.moveTo(d,h),0===t||0===i?n.lineTo(p,g):(n.lineTo(p,h),n.lineTo(p,g),n.lineTo(d,g)),u||r.updateRectMinMax(c,[d,h,p,g]),n.closePath();break;case s.OPS.moveTo:d=e[a++],h=e[a++],n.moveTo(d,h),u||r.updatePathMinMax(c,d,h);break;case s.OPS.lineTo:d=e[a++],h=e[a++],n.lineTo(d,h),u||r.updatePathMinMax(c,d,h);break;case s.OPS.curveTo:o=d,l=h,d=e[a+4],h=e[a+5],n.bezierCurveTo(e[a],e[a+1],e[a+2],e[a+3],d,h),r.updateCurvePathMinMax(c,o,l,e[a],e[a+1],e[a+2],e[a+3],d,h,f),a+=6;break;case s.OPS.curveTo2:o=d,l=h,n.bezierCurveTo(d,h,e[a],e[a+1],e[a+2],e[a+3]),r.updateCurvePathMinMax(c,o,l,d,h,e[a],e[a+1],e[a+2],e[a+3],f),d=e[a+2],h=e[a+3],a+=4;break;case s.OPS.curveTo3:o=d,l=h,d=e[a+2],h=e[a+3],n.bezierCurveTo(e[a],e[a+1],d,h,d,h),r.updateCurvePathMinMax(c,o,l,e[a],e[a+1],d,h,d,h,f),a+=4;break;case s.OPS.closePath:n.closePath()}u&&r.updateScalingPathMinMax(c,f),r.setCurrentPoint(d,h)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof i&&i?.getPattern?(e.save(),e.strokeStyle=i.getPattern(e,this,(0,a.getCurrentTransformInverse)(e),r),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor;let s=!1;this.current.patternFill&&(e.save(),e.fillStyle=i.getPattern(e,this,(0,a.getCurrentTransformInverse)(e),n),s=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==r&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=H}eoClip(){this.pendingClip=z}beginText(){this.current.textMatrix=s.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(void 0!==t){e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}else e.beginPath()}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const i=this.commonObjs.get(t),a=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=i.fontMatrix||s.FONT_IDENTITY_MATRIX,0!==a.fontMatrix[0]&&0!==a.fontMatrix[3]||(0,s.warn)("Invalid font matrix for font "+t),e<0?(e=-e,a.fontDirection=-1):a.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const n=i.loadedName||"sans-serif",r=i.systemFontInfo?.css||`"${n}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let d=e;e<16?d=16:e>100&&(d=100),this.current.fontSizeScale=e/d,this.ctx.font=`${l} ${o} ${d}px ${r}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,s,a,n){this.current.textMatrix=[t,e,i,s,a,n],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,n){const r=this.ctx,o=this.current,l=o.font,d=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,c=d&s.TextRenderingMode.FILL_STROKE_MASK,u=!!(d&s.TextRenderingMode.ADD_TO_PATH_FLAG),f=o.patternFill&&!l.missingFile;let p;if((l.disableFontFace||u||f)&&(p=l.getPathGenerator(this.commonObjs,t)),l.disableFontFace||f?(r.save(),r.translate(e,i),r.beginPath(),p(r,h),n&&r.setTransform(...n),c!==s.TextRenderingMode.FILL&&c!==s.TextRenderingMode.FILL_STROKE||r.fill(),c!==s.TextRenderingMode.STROKE&&c!==s.TextRenderingMode.FILL_STROKE||r.stroke(),r.restore()):(c!==s.TextRenderingMode.FILL&&c!==s.TextRenderingMode.FILL_STROKE||r.fillText(t,e,i),c!==s.TextRenderingMode.STROKE&&c!==s.TextRenderingMode.FILL_STROKE||r.strokeText(t,e,i)),u){(this.pendingTextPaths||=[]).push({transform:(0,a.getCurrentTransform)(r),x:e,y:i,fontSize:h,addToPath:p})}}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let t=3;t<e.length;t+=4)if(e[t]>0&&e[t]<255){i=!0;break}return(0,s.shadow)(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const r=e.fontSize;if(0===r)return;const o=this.ctx,l=e.fontSizeScale,d=e.charSpacing,h=e.wordSpacing,c=e.fontDirection,u=e.textHScale*c,f=t.length,p=i.vertical,g=p?1:-1,m=i.defaultVMetrics,b=r*e.fontMatrix[0],v=e.textRenderingMode===s.TextRenderingMode.FILL&&!i.disableFontFace&&!e.patternFill;let y;if(o.save(),o.transform(...e.textMatrix),o.translate(e.x,e.y+e.textRise),c>0?o.scale(u,-1):o.scale(u,1),e.patternFill){o.save();const t=e.fillColor.getPattern(o,this,(0,a.getCurrentTransformInverse)(o),n);y=(0,a.getCurrentTransform)(o),o.restore(),o.fillStyle=t}let A=e.lineWidth;const w=e.textMatrixScale;if(0===w||0===A){const t=e.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;t!==s.TextRenderingMode.STROKE&&t!==s.TextRenderingMode.FILL_STROKE||(A=this.getSinglePixelWidth())}else A/=w;if(1!==l&&(o.scale(l,l),A/=l),o.lineWidth=A,i.isInvalidPDFjsFont){const i=[];let s=0;for(const e of t)i.push(e.unicode),s+=e.width;return o.fillText(i.join(""),0,0),e.x+=s*b*u,o.restore(),void this.compose()}let _,x=0;for(_=0;_<f;++_){const e=t[_];if("number"==typeof e){x+=g*e*r/1e3;continue}let s=!1;const a=(e.isSpace?h:0)+d,n=e.fontChar,u=e.accent;let f,A,w=e.width;if(p){const t=e.vmetric||m,i=-(e.vmetric?t[1]:.5*w)*b,s=t[2]*b;w=t?-t[0]:w,f=i/l,A=(x+s)/l}else f=x/l,A=0;if(i.remeasure&&w>0){const t=1e3*o.measureText(n).width/r*l;if(w<t&&this.isFontSubpixelAAEnabled){const e=w/t;s=!0,o.save(),o.scale(e,1),f/=e}else w!==t&&(f+=(w-t)/2e3*r/l)}if(this.contentVisible&&(e.isInFont||i.missingFile))if(v&&!u)o.fillText(n,f,A);else if(this.paintChar(n,f,A,y),u){const t=f+r*u.offset.x/l,e=A-r*u.offset.y/l;this.paintChar(u.fontChar,t,e,y)}x+=p?w*b-a*c:w*b+a*c,s&&o.restore()}p?e.y-=x:e.x+=x*u,o.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,a=i.font,n=i.fontSize,r=i.fontDirection,o=a.vertical?1:-1,l=i.charSpacing,d=i.wordSpacing,h=i.textHScale*r,c=i.fontMatrix||s.FONT_IDENTITY_MATRIX,u=t.length;let f,p,g,m;if(!(i.textRenderingMode===s.TextRenderingMode.INVISIBLE)&&0!==n){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(h,r),f=0;f<u;++f){if(p=t[f],"number"==typeof p){m=o*p*n/1e3,this.ctx.translate(m,0),i.x+=m*h;continue}const r=(p.isSpace?d:0)+l,u=a.charProcOperatorList[p.operatorListId];if(!u){(0,s.warn)(`Type3 character "${p.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=p,this.save(),e.scale(n,n),e.transform(...c),this.executeOperatorList(u),this.restore());g=s.Util.applyTransform([p.width,0],c)[0]*n+r,e.translate(g,0),i.x+=g*h}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,s,a,n){this.ctx.rect(i,s,a-i,n-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if("TilingPattern"===t[0]){const i=t[1],s=this.baseTransform||(0,a.getCurrentTransform)(this.ctx),n={createCanvasGraphics:t=>new G(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new A(t,i,this.ctx,n,s)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){const a=s.Util.makeHexColor(t,e,i);this.ctx.strokeStyle=a,this.current.strokeColor=a}setFillRGBColor(t,e,i){const a=s.Util.makeHexColor(t,e,i);this.ctx.fillStyle=a,this.current.fillColor=a,this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=b(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,(0,a.getCurrentTransformInverse)(e),o);const n=(0,a.getCurrentTransformInverse)(e);if(n){const{width:t,height:i}=e.canvas,[a,r,o,l]=s.Util.getAxialAlignedBoundingBox([0,0,t,i],n);this.ctx.fillRect(a,r,o-a,l-r)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,s.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,s.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(t)&&6===t.length&&this.transform(...t),this.baseTransform=(0,a.getCurrentTransform)(this.ctx),e)){const t=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],t,i),this.current.updateRectMinMax((0,a.getCurrentTransform)(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||(0,s.info)("TODO: Support non-isolated groups."),t.knockout&&(0,s.warn)("Knockout groups not supported.");const i=(0,a.getCurrentTransform)(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let n=s.Util.getAxialAlignedBoundingBox(t.bbox,(0,a.getCurrentTransform)(e));const r=[0,0,e.canvas.width,e.canvas.height];n=s.Util.intersect(n,r)||[0,0,0,0];const o=Math.floor(n[0]),l=Math.floor(n[1]);let d=Math.max(Math.ceil(n[2])-o,1),h=Math.max(Math.ceil(n[3])-l,1),c=1,u=1;d>_&&(c=d/_,d=_),h>_&&(u=h/_,h=_),this.current.startNewPathAndClipBox([0,0,d,h]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(f,d,h),g=p.context;g.scale(1/c,1/u),g.translate(-o,-l),g.transform(...i),t.smask?this.smaskStack.push({canvas:p.canvas,context:g,offsetX:o,offsetY:l,scaleX:c,scaleY:u,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,l),e.scale(c,u),e.save()),R(e,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=(0,a.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...t);const i=s.Util.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],t);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(t,e,i,n,r){if((0,f.default)(this,V)[V](),O(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(e)&&4===e.length){const n=e[2]-e[0],o=e[3]-e[1];if(r&&this.annotationCanvasMap){(i=i.slice())[4]-=e[0],i[5]-=e[1],(e=e.slice())[0]=e[1]=0,e[2]=n,e[3]=o;const[r,l]=s.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(this.ctx)),{viewportScale:d}=this,h=Math.ceil(n*this.outputScaleX*d),c=Math.ceil(o*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(h,c);const{canvas:u,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(t,u),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(r,0,0,-l,0,o*l),O(this.ctx)}else O(this.ctx),this.ctx.rect(e[0],e[1],n,o),this.ctx.clip(),this.endPath()}this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),(0,f.default)(this,q)[q](),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;(t=this.getObject(t.data,t)).count=e;const i=this.ctx,s=this.processingType3;if(s&&(void 0===s.compiled&&(s.compiled=C(t)),s.compiled))return void s.compiled(i);const a=this._createMaskCanvas(t),n=a.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(n,a.offsetX,a.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,n=0,r,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const d=(0,a.getCurrentTransform)(l);l.transform(e,i,n,r,0,0);const h=this._createMaskCanvas(t);l.setTransform(1,0,0,1,h.offsetX-d[4],h.offsetY-d[5]);for(let t=0,a=o.length;t<a;t+=2){const a=s.Util.transform(d,[e,i,n,r,o[t],o[t+1]]),[c,u]=s.Util.applyTransform([0,0],a);l.drawImage(h.canvas,c,u)}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of t){const{data:t,width:o,height:l,transform:d}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),c=h.context;c.save();k(c,this.getObject(t,r)),c.globalCompositeOperation="source-in",c.fillStyle=s?i.getPattern(c,this,(0,a.getCurrentTransformInverse)(e),n):i,c.fillRect(0,0,o,l),c.restore(),e.save(),e.transform(...d),e.scale(1,-1),S(e,h.canvas,0,0,o,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);e?this.paintInlineImageXObject(e):(0,s.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,e,i,a){if(!this.contentVisible)return;const n=this.getObject(t);if(!n)return void(0,s.warn)("Dependent image isn't ready yet");const r=n.width,o=n.height,l=[];for(let t=0,s=a.length;t<s;t+=2)l.push({transform:[e,0,0,i,a[t],a[t+1]],x:0,y:0,w:r,h:o});this.paintInlineImageXObjectGroup(n,l)}applyTransferMapsToCanvas(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:i,height:s}=t,a=this.cachedCanvases.getCanvas("inlineImage",i,s),n=a.context;return n.filter=this.current.transferMaps,n.drawImage(e,0,0),n.filter="none",a.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,n=this.ctx;if(this.save(),!s.isNodeJS){const{filter:t}=n;"none"!==t&&""!==t&&(n.filter="none")}let r;if(n.scale(1/e,-1/i),t.bitmap)r=this.applyTransferMapsToBitmap(t);else if("function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)r=t;else{const s=this.cachedCanvases.getCanvas("inlineImage",e,i).context;M(s,t),r=this.applyTransferMapsToCanvas(s)}const o=this._scaleImage(r,(0,a.getCurrentTransformInverse)(n));n.imageSmoothingEnabled=N((0,a.getCurrentTransform)(n),t.interpolate),S(n,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const e=t.width,i=t.height,a=this.cachedCanvases.getCanvas("inlineImage",e,i).context;M(a,t),s=this.applyTransferMapsToCanvas(a)}for(const t of e)i.save(),i.transform(...t.transform),i.scale(1,-1),S(i,s,t.x,t.y,t.w,t.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===z?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=(0,a.getCurrentTransform)(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:a}=this.ctx.getTransform();let n,r;if(0===i&&0===s){const i=Math.abs(e),s=Math.abs(a);if(i===s)if(0===t)n=r=1/i;else{const e=i*t;n=r=e<1?1/e:1}else if(0===t)n=1/i,r=1/s;else{const e=i*t,a=s*t;n=e<1?1/e:1,r=a<1?1/a:1}}else{const o=Math.abs(e*a-i*s),l=Math.hypot(e,i),d=Math.hypot(s,a);if(0===t)n=d/o,r=l/o;else{const e=t*o;n=d>e?d/e:1,r=l>e?l/e:1}}this._cachedScaleForStroking[0]=n,this._cachedScaleForStroking[1]=r}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[s,a]=this.getScaleForStroking();if(e.lineWidth=i||1,1===s&&1===a)return void e.stroke();const n=e.getLineDash();if(t&&e.save(),e.scale(s,a),n.length>0){const t=Math.max(s,a);e.setLineDash(n.map(e=>e/t)),e.lineDashOffset/=t}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}function $(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function W(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}for(const t in s.OPS)void 0!==G.prototype[t]&&(G.prototype[s.OPS[t]]=G.prototype[t])},473:(t,e,i)=>{i.d(e,{DOMCMapReaderFactory:()=>j,DOMCanvasFactory:()=>D,DOMFilterFactory:()=>C,DOMSVGFactory:()=>B,DOMStandardFontDataFactory:()=>N,PDFDateString:()=>Y,PageViewport:()=>U,PixelsPerInch:()=>r,RenderingCancelledException:()=>H,StatTimer:()=>$,fetchData:()=>L,getColorValues:()=>Z,getCurrentTransform:()=>tt,getCurrentTransformInverse:()=>et,getFilenameFromUrl:()=>q,getPdfFilenameFromUrl:()=>G,getRGB:()=>Q,getXfaPageViewport:()=>J,isDataScheme:()=>z,isPdfFile:()=>V,isValidFetchUrl:()=>W,noContextMenu:()=>X,setLayerDimensions:()=>it});var s=i(822),a=i(266);const n="http://www.w3.org/2000/svg";class r{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}var o=(0,p.default)("_cache"),l=(0,p.default)("_defs"),d=(0,p.default)("docId"),h=(0,p.default)("document"),c=(0,p.default)("hcmFilter"),u=(0,p.default)("hcmKey"),g=(0,p.default)("hcmUrl"),m=(0,p.default)("hcmHighlightFilter"),b=(0,p.default)("hcmHighlightKey"),v=(0,p.default)("hcmHighlightUrl"),y=(0,p.default)("id"),A=(0,p.default)("cache"),w=(0,p.default)("defs"),_=(0,p.default)("addGrayConversion"),x=(0,p.default)("createFilter"),E=(0,p.default)("appendFeFunc"),P=(0,p.default)("addTransferMapConversion"),S=(0,p.default)("getRGB");class C extends s.BaseFilterFactory{constructor({docId:t,ownerDocument:e=globalThis.document}={}){super(),Object.defineProperty(this,S,{value:I}),Object.defineProperty(this,P,{value:F}),Object.defineProperty(this,E,{value:O}),Object.defineProperty(this,x,{value:R}),Object.defineProperty(this,_,{value:k}),Object.defineProperty(this,w,{get:M,set:void 0}),Object.defineProperty(this,A,{get:T,set:void 0}),Object.defineProperty(this,o,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:0}),(0,f.default)(this,d)[d]=t,(0,f.default)(this,h)[h]=e}addFilter(t){if(!t)return"none";let e,i,s,a,n=(0,f.default)(this,A)[A].get(t);if(n)return n;if(1===t.length){const n=t[0],r=new Array(256);for(let t=0;t<256;t++)r[t]=n[t]/255;a=e=i=s=r.join(",")}else{const[n,r,o]=t,l=new Array(256),d=new Array(256),h=new Array(256);for(let t=0;t<256;t++)l[t]=n[t]/255,d[t]=r[t]/255,h[t]=o[t]/255;e=l.join(","),i=d.join(","),s=h.join(","),a=`${e}${i}${s}`}if(n=(0,f.default)(this,A)[A].get(a),n)return(0,f.default)(this,A)[A].set(t,n),n;const r=`g_${(0,f.default)(this,d)[d]}_transfer_map_${(0,f.default)(this,y)[y]++}`,o=`url(#${r})`;(0,f.default)(this,A)[A].set(t,o),(0,f.default)(this,A)[A].set(a,o);const l=(0,f.default)(this,x)[x](r);return(0,f.default)(this,P)[P](e,i,s,l),o}addHCMFilter(t,e){const i=`${t}-${e}`;if((0,f.default)(this,u)[u]===i)return(0,f.default)(this,g)[g];if((0,f.default)(this,u)[u]=i,(0,f.default)(this,g)[g]="none",(0,f.default)(this,c)[c]?.remove(),!t||!e)return(0,f.default)(this,g)[g];const s=(0,f.default)(this,S)[S](t);t=a.Util.makeHexColor(...s);const n=(0,f.default)(this,S)[S](e);if(e=a.Util.makeHexColor(...n),(0,f.default)(this,w)[w].style.color="","#000000"===t&&"#ffffff"===e||t===e)return(0,f.default)(this,g)[g];const r=new Array(256);for(let t=0;t<=255;t++){const e=t/255;r[t]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const o=r.join(","),l=`g_${(0,f.default)(this,d)[d]}_hcm_filter`,h=(0,f.default)(this,m)[m]=(0,f.default)(this,x)[x](l);(0,f.default)(this,P)[P](o,o,o,h),(0,f.default)(this,_)[_](h);const p=(t,e)=>{const i=s[t]/255,a=n[t]/255,r=new Array(e+1);for(let t=0;t<=e;t++)r[t]=i+t/e*(a-i);return r.join(",")};return(0,f.default)(this,P)[P](p(0,5),p(1,5),p(2,5),h),(0,f.default)(this,g)[g]=`url(#${l})`,(0,f.default)(this,g)[g]}addHighlightHCMFilter(t,e,i,s){const a=`${t}-${e}-${i}-${s}`;if((0,f.default)(this,b)[b]===a)return(0,f.default)(this,v)[v];if((0,f.default)(this,b)[b]=a,(0,f.default)(this,v)[v]="none",(0,f.default)(this,m)[m]?.remove(),!t||!e)return(0,f.default)(this,v)[v];const[n,r]=[t,e].map((0,f.default)(this,S)[S].bind(this));let o=Math.round(.2126*n[0]+.7152*n[1]+.0722*n[2]),l=Math.round(.2126*r[0]+.7152*r[1]+.0722*r[2]),[h,c]=[i,s].map((0,f.default)(this,S)[S].bind(this));l<o&&([o,l,h,c]=[l,o,c,h]),(0,f.default)(this,w)[w].style.color="";const u=(t,e,i)=>{const s=new Array(256),a=(l-o)/i,n=t/255,r=(e-t)/(255*i);let d=0;for(let t=0;t<=i;t++){const e=Math.round(o+t*a),i=n+t*r;for(let t=d;t<=e;t++)s[t]=i;d=e+1}for(let t=d;t<256;t++)s[t]=s[d-1];return s.join(",")},p=`g_${(0,f.default)(this,d)[d]}_hcm_highlight_filter`,g=(0,f.default)(this,m)[m]=(0,f.default)(this,x)[x](p);return(0,f.default)(this,_)[_](g),(0,f.default)(this,P)[P](u(h[0],c[0],5),u(h[1],c[1],5),u(h[2],c[2],5),g),(0,f.default)(this,v)[v]=`url(#${p})`,(0,f.default)(this,v)[v]}destroy(t=!1){t&&((0,f.default)(this,g)[g]||(0,f.default)(this,v)[v])||((0,f.default)(this,l)[l]&&((0,f.default)(this,l)[l].parentNode.parentNode.remove(),(0,f.default)(this,l)[l]=null),(0,f.default)(this,o)[o]&&((0,f.default)(this,o)[o].clear(),(0,f.default)(this,o)[o]=null),(0,f.default)(this,y)[y]=0)}}function T(){return(0,f.default)(this,o)[o]||=new Map}function M(){if(!(0,f.default)(this,l)[l]){const t=(0,f.default)(this,h)[h].createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=(0,f.default)(this,h)[h].createElementNS(n,"svg");i.setAttribute("width",0),i.setAttribute("height",0),(0,f.default)(this,l)[l]=(0,f.default)(this,h)[h].createElementNS(n,"defs"),t.append(i),i.append((0,f.default)(this,l)[l]),(0,f.default)(this,h)[h].body.append(t)}return(0,f.default)(this,l)[l]}function k(t){const e=(0,f.default)(this,h)[h].createElementNS(n,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}function R(t){const e=(0,f.default)(this,h)[h].createElementNS(n,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),(0,f.default)(this,w)[w].append(e),e}function O(t,e,i){const s=(0,f.default)(this,h)[h].createElementNS(n,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)}function F(t,e,i,s){const a=(0,f.default)(this,h)[h].createElementNS(n,"feComponentTransfer");s.append(a),(0,f.default)(this,E)[E](a,"feFuncR",t),(0,f.default)(this,E)[E](a,"feFuncG",e),(0,f.default)(this,E)[E](a,"feFuncB",i)}function I(t){return(0,f.default)(this,w)[w].style.color=t,Q(getComputedStyle((0,f.default)(this,w)[w]).getPropertyValue("color"))}class D extends s.BaseCanvasFactory{constructor({ownerDocument:t=globalThis.document}={}){super(),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}async function L(t,e="text"){if(W(t,document.baseURI)){const i=await fetch(t);if(!i.ok)throw new Error(i.statusText);switch(e){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType=e,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(200===a.status||0===a.status){let t;switch(e){case"arraybuffer":case"blob":case"json":t=a.response;break;default:t=a.responseText}if(t)return void i(t)}s(new Error(a.statusText))}},a.send(null)})}class j extends s.BaseCMapReaderFactory{_fetchData(t,e){return L(t,this.isCompressed?"arraybuffer":"text").then(t=>({cMapData:t instanceof ArrayBuffer?new Uint8Array(t):(0,a.stringToBytes)(t),compressionType:e}))}}class N extends s.BaseStandardFontDataFactory{_fetchData(t){return L(t,"arraybuffer").then(t=>new Uint8Array(t))}}class B extends s.BaseSVGFactory{_createSVG(t){return document.createElementNS(n,t)}}class U{constructor({viewBox:t,scale:e,rotation:i,offsetX:s=0,offsetY:a=0,dontFlip:n=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=s,this.offsetY=a;const r=(t[2]+t[0])/2,o=(t[3]+t[1])/2;let l,d,h,c,u,f,p,g;switch((i%=360)<0&&(i+=360),i){case 180:l=-1,d=0,h=0,c=1;break;case 90:l=0,d=1,h=1,c=0;break;case 270:l=0,d=-1,h=-1,c=0;break;case 0:l=1,d=0,h=0,c=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}n&&(h=-h,c=-c),0===l?(u=Math.abs(o-t[1])*e+s,f=Math.abs(r-t[0])*e+a,p=(t[3]-t[1])*e,g=(t[2]-t[0])*e):(u=Math.abs(r-t[0])*e+s,f=Math.abs(o-t[1])*e+a,p=(t[2]-t[0])*e,g=(t[3]-t[1])*e),this.transform=[l*e,d*e,h*e,c*e,u-l*e*r-h*e*o,f-d*e*r-c*e*o],this.width=p,this.height=g}get rawDims(){const{viewBox:t}=this;return(0,a.shadow)(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:a=!1}={}){return new U({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:a})}convertToViewportPoint(t,e){return a.Util.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=a.Util.applyTransform([t[0],t[1]],this.transform),i=a.Util.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return a.Util.applyInverseTransform([t,e],this.transform)}}class H extends a.BaseException{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function z(t){const e=t.length;let i=0;for(;i<e&&""===t[i].trim();)i++;return"data:"===t.substring(i,i+5).toLowerCase()}function V(t){return"string"==typeof t&&/\.pdf$/i.test(t)}function q(t,e=!1){return e||([t]=t.split(/[#?]/,1)),t.substring(t.lastIndexOf("/")+1)}function G(t,e="document.pdf"){if("string"!=typeof t)return e;if(z(t))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t);let n=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(n&&(n=n[0],n.includes("%")))try{n=i.exec(decodeURIComponent(n))[0]}catch{}return n||e}class ${started=Object.create(null);times=[];time(t){t in this.started&&(0,a.warn)(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||(0,a.warn)(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:t}of this.times)e=Math.max(t.length,e);for(const{name:i,start:s,end:a}of this.times)t.push(`${i.padEnd(e)} ${a-s}ms\n`);return t.join("")}}function W(t,e){try{const{protocol:i}=e?new URL(t,e):new URL(t);return"http:"===i||"https:"===i}catch{return!1}}function X(t){t.preventDefault()}let K;class Y{static toDateObject(t){if(!t||"string"!=typeof t)return null;K||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=K.exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let n=parseInt(e[4],10);n=n>=0&&n<=23?n:0;let r=parseInt(e[5],10);r=r>=0&&r<=59?r:0;let o=parseInt(e[6],10);o=o>=0&&o<=59?o:0;const l=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let h=parseInt(e[9],10)||0;return h=h>=0&&h<=59?h:0,"-"===l?(n+=d,r+=h):"+"===l&&(n-=d,r-=h),new Date(Date.UTC(i,s,a,n,r,o))}}function J(t,{scale:e=1,rotation:i=0}){const{width:s,height:a}=t.attributes.style,n=[0,0,parseInt(s),parseInt(a)];return new U({viewBox:n,scale:e,rotation:i})}function Q(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map(t=>parseInt(t)):t.startsWith("rgba(")?t.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):((0,a.warn)(`Not a valid color format: "${t}"`),[0,0,0])}function Z(t){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const i of t.keys()){e.style.color=i;const s=window.getComputedStyle(e).color;t.set(i,Q(s))}e.remove()}function tt(t){const{a:e,b:i,c:s,d:a,e:n,f:r}=t.getTransform();return[e,i,s,a,n,r]}function et(t){const{a:e,b:i,c:s,d:a,e:n,f:r}=t.getTransform().invertSelf();return[e,i,s,a,n,r]}function it(t,e,i=!1,s=!0){if(e instanceof U){const{pageWidth:s,pageHeight:n}=e.rawDims,{style:r}=t,o=a.FeatureTest.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,d=`var(--scale-factor) * ${n}px`,h=o?`round(${l}, 1px)`:`calc(${l})`,c=o?`round(${d}, 1px)`:`calc(${d})`;i&&e.rotation%180!=0?(r.width=c,r.height=h):(r.width=h,r.height=c)}s&&t.setAttribute("data-main-rotation",e.rotation)}},423:(t,e,i)=>{var s;i.d(e,{DrawLayer:()=>u});var a=i(473),n=i(266),r=(0,p.default)("parent"),o=(0,p.default)("id"),l=(0,p.default)("mapping"),d=(0,p.default)("setBox"),h=(0,p.default)("createSVG"),c=(0,p.default)("extractPathFromHighlightOutlines");class u{constructor({pageIndex:t}){Object.defineProperty(this,h,{value:g}),Object.defineProperty(this,r,{writable:!0,value:null}),Object.defineProperty(this,o,{writable:!0,value:0}),Object.defineProperty(this,l,{writable:!0,value:new Map}),this.pageIndex=t}setParent(t){if((0,f.default)(this,r)[r]){if((0,f.default)(this,r)[r]!==t){if((0,f.default)(this,l)[l].size>0)for(const e of(0,f.default)(this,l)[l].values())e.remove(),t.append(e);(0,f.default)(this,r)[r]=t}}else(0,f.default)(this,r)[r]=t}static get _svgFactory(){return(0,n.shadow)(this,"_svgFactory",new a.DOMSVGFactory)}highlight({outlines:t,box:e},i,s){const a=(0,f.default)(this,o)[o]++,n=(0,f.default)(this,h)[h](e);n.classList.add("highlight");const r=u._svgFactory.createElement("defs");n.append(r);const d=u._svgFactory.createElement("path");r.append(d);const p=`path_p${this.pageIndex}_${a}`;d.setAttribute("id",p),d.setAttribute("d",(0,f.default)(u,c)[c](t));const g=u._svgFactory.createElement("clipPath");r.append(g);const m=`clip_${p}`;g.setAttribute("id",m),g.setAttribute("clipPathUnits","objectBoundingBox");const b=u._svgFactory.createElement("use");g.append(b),b.setAttribute("href",`#${p}`),b.classList.add("clip");const v=u._svgFactory.createElement("use");return n.append(v),n.setAttribute("fill",i),n.setAttribute("fill-opacity",s),v.setAttribute("href",`#${p}`),(0,f.default)(this,l)[l].set(a,n),{id:a,clipPathId:`url(#${m})`}}highlightOutline({outlines:t,box:e}){const i=(0,f.default)(this,o)[o]++,s=(0,f.default)(this,h)[h](e);s.classList.add("highlightOutline");const a=u._svgFactory.createElement("defs");s.append(a);const n=u._svgFactory.createElement("path");a.append(n);const r=`path_p${this.pageIndex}_${i}`;n.setAttribute("id",r),n.setAttribute("d",(0,f.default)(u,c)[c](t)),n.setAttribute("vector-effect","non-scaling-stroke");const d=u._svgFactory.createElement("use");s.append(d),d.setAttribute("href",`#${r}`);const p=d.cloneNode();return s.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),(0,f.default)(this,l)[l].set(i,s),i}updateBox(t,e){(0,f.default)(u,d)[d]((0,f.default)(this,l)[l].get(t),e)}rotate(t,e){(0,f.default)(this,l)[l].get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){(0,f.default)(this,l)[l].get(t).setAttribute("fill",e)}changeOpacity(t,e){(0,f.default)(this,l)[l].get(t).setAttribute("fill-opacity",e)}addClass(t,e){(0,f.default)(this,l)[l].get(t).classList.add(e)}removeClass(t,e){(0,f.default)(this,l)[l].get(t).classList.remove(e)}remove(t){null!==(0,f.default)(this,r)[r]&&((0,f.default)(this,l)[l].get(t).remove(),(0,f.default)(this,l)[l].delete(t))}destroy(){(0,f.default)(this,r)[r]=null;for(const t of(0,f.default)(this,l)[l].values())t.remove();(0,f.default)(this,l)[l].clear()}}function g(t){const e=s._svgFactory.create(1,1,!0);return(0,f.default)(this,r)[r].append(e),(0,f.default)(s,d)[d](e,t),e}s=u,Object.defineProperty(u,c,{value:function(t){const e=[];for(const i of t){let[t,s]=i;e.push(`M${t} ${s}`);for(let a=2;a<i.length;a+=2){const n=i[a],r=i[a+1];n===t?(e.push(`V${r}`),s=r):r===s&&(e.push(`H${n}`),t=n)}e.push("Z")}return e.join(" ")}}),Object.defineProperty(u,d,{value:function(t,{x:e,y:i,width:s,height:a}){const{style:n}=t;n.top=100*i+"%",n.left=100*e+"%",n.width=100*s+"%",n.height=100*a+"%"}})},629:(t,e,i)=>{var s,a,n,r;i.d(e,{AnnotationEditorLayer:()=>bi});var o=i(266),l=i(115),d=i(812),h=i(640),c=(0,p.default)("boundEditorDivBlur"),u=(0,p.default)("boundEditorDivFocus"),g=(0,p.default)("boundEditorDivInput"),m=(0,p.default)("boundEditorDivKeydown"),b=(0,p.default)("color"),v=(0,p.default)("content"),y=(0,p.default)("editorDivId"),A=(0,p.default)("fontSize"),w=(0,p.default)("initialData"),_=(0,p.default)("updateFontSize"),x=(0,p.default)("updateColor"),E=(0,p.default)("extractText"),P=(0,p.default)("setEditorDimensions"),S=(0,p.default)("setContent"),C=(0,p.default)("hasElementChanged"),T=(0,p.default)("cheatInitialRect");class M extends l.AnnotationEditor{static get _keyboardManager(){const t=M.prototype,e=t=>t.isEmpty(),i=d.AnnotationEditorUIManager.TRANSLATE_SMALL,s=d.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,o.shadow)(this,"_keyboardManager",new d.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}constructor(t){super(Object.assign({},t,{name:"freeTextEditor"})),Object.defineProperty(this,T,{value:L}),Object.defineProperty(this,C,{value:D}),Object.defineProperty(this,S,{value:I}),Object.defineProperty(this,P,{value:F}),Object.defineProperty(this,E,{value:O}),Object.defineProperty(this,x,{value:R}),Object.defineProperty(this,_,{value:k}),Object.defineProperty(this,c,{writable:!0,value:this.editorDivBlur.bind(this)}),Object.defineProperty(this,u,{writable:!0,value:this.editorDivFocus.bind(this)}),Object.defineProperty(this,g,{writable:!0,value:this.editorDivInput.bind(this)}),Object.defineProperty(this,m,{writable:!0,value:this.editorDivKeydown.bind(this)}),Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,v,{writable:!0,value:""}),Object.defineProperty(this,y,{writable:!0,value:`${this.id}-editor`}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:null}),(0,f.default)(this,b)[b]=t.color||M._defaultColor||l.AnnotationEditor._defaultLineColor,(0,f.default)(this,A)[A]=t.fontSize||M._defaultFontSize}static initialize(t){l.AnnotationEditor.initialize(t,{strings:["pdfjs-free-text-default-content"]});const e=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(e.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case o.AnnotationEditorParamsType.FREETEXT_SIZE:M._defaultFontSize=e;break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:M._defaultColor=e}}updateParams(t,e){switch(t){case o.AnnotationEditorParamsType.FREETEXT_SIZE:(0,f.default)(this,_)[_](e);break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:(0,f.default)(this,x)[x](e)}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,M._defaultFontSize],[o.AnnotationEditorParamsType.FREETEXT_COLOR,M._defaultColor||l.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,(0,f.default)(this,A)[A]],[o.AnnotationEditorParamsType.FREETEXT_COLOR,(0,f.default)(this,b)[b]]]}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-M._internalPadding*t,-(M._internalPadding+(0,f.default)(this,A)[A])*t]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(o.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",(0,f.default)(this,m)[m]),this.editorDiv.addEventListener("focus",(0,f.default)(this,u)[u]),this.editorDiv.addEventListener("blur",(0,f.default)(this,c)[c]),this.editorDiv.addEventListener("input",(0,f.default)(this,g)[g]))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",(0,f.default)(this,y)[y]),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",(0,f.default)(this,m)[m]),this.editorDiv.removeEventListener("focus",(0,f.default)(this,u)[u]),this.editorDiv.removeEventListener("blur",(0,f.default)(this,c)[c]),this.editorDiv.removeEventListener("input",(0,f.default)(this,g)[g]),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width?(0,f.default)(this,T)[T]():(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=(0,f.default)(this,v)[v],e=(0,f.default)(this,v)[v]=(0,f.default)(this,E)[E]().trimEnd();if(t===e)return;const i=t=>{(0,f.default)(this,v)[v]=t,t?((0,f.default)(this,S)[S](),this._uiManager.rebuild(this),(0,f.default)(this,P)[P]()):this.remove()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),(0,f.default)(this,P)[P]()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&"Enter"===t.key&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){M._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",(0,f.default)(this,y)[y]),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),l.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(t=>this.editorDiv?.setAttribute("default-content",t)),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${(0,f.default)(this,A)[A]}px * var(--scale-factor))`,i.color=(0,f.default)(this,b)[b],this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,d.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[i,s]=this.parentDimensions;if(this.annotationElementId){const{position:a}=(0,f.default)(this,w)[w];let[n,r]=this.getInitialTranslation();[n,r]=this.pageTranslationToScreen(n,r);const[o,l]=this.pageDimensions,[d,h]=this.pageTranslation;let c,u;switch(this.rotation){case 0:c=t+(a[0]-d)/o,u=e+this.height-(a[1]-h)/l;break;case 90:c=t+(a[0]-d)/o,u=e-(a[1]-h)/l,[n,r]=[r,-n];break;case 180:c=t-this.width+(a[0]-d)/o,u=e-(a[1]-h)/l,[n,r]=[-n,-r];break;case 270:c=t+(a[0]-d-this.height*l)/o,u=e+(a[1]-h-this.width*o)/l,[n,r]=[-r,n]}this.setAt(c*i,u*s,n,r)}else this.setAt(t*i,e*s,this.width*i,this.height*s);(0,f.default)(this,S)[S](),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(t,e,i){let s=null;if(t instanceof h.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:e,fontColor:i},rect:a,rotation:n,id:r},textContent:l,textPosition:d,parent:{page:{pageNumber:h}}}=t;if(!l||0===l.length)return null;s=t={annotationType:o.AnnotationEditorType.FREETEXT,color:Array.from(i),fontSize:e,value:l.join("\n"),position:d,pageIndex:h-1,rect:a,rotation:n,id:r,deleted:!1}}const a=super.deserialize(t,e,i);return(0,f.default)(a,A)[A]=t.fontSize,(0,f.default)(a,b)[b]=o.Util.makeHexColor(...t.color),(0,f.default)(a,v)[v]=t.value,a.annotationElementId=t.id||null,(0,f.default)(a,w)[w]=s,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const e=M._internalPadding*this.parentScale,i=this.getRect(e,e),s=l.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:(0,f.default)(this,b)[b]),a={annotationType:o.AnnotationEditorType.FREETEXT,color:s,fontSize:(0,f.default)(this,A)[A],value:(0,f.default)(this,v)[v],pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!(0,f.default)(this,C)[C](a)?null:(a.id=this.annotationElementId,a)}}function k(t){const e=t=>{this.editorDiv.style.fontSize=`calc(${t}px * var(--scale-factor))`,this.translate(0,-(t-(0,f.default)(this,A)[A])*this.parentScale),(0,f.default)(this,A)[A]=t,(0,f.default)(this,P)[P]()},i=(0,f.default)(this,A)[A];this.addCommands({cmd:()=>{e(t)},undo:()=>{e(i)},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function R(t){const e=(0,f.default)(this,b)[b];this.addCommands({cmd:()=>{(0,f.default)(this,b)[b]=this.editorDiv.style.color=t},undo:()=>{(0,f.default)(this,b)[b]=this.editorDiv.style.color=e},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function O(){const t=this.editorDiv.getElementsByTagName("div");if(0===t.length)return this.editorDiv.innerText;const e=[];for(const i of t)e.push(i.innerText.replace(/\r\n?|\n/,""));return e.join("\n")}function F(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:t,div:e}=this,s=e.style.display;e.style.display="hidden",t.div.append(this.div),i=e.getBoundingClientRect(),e.remove(),e.style.display=s}this.rotation%180==this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}function I(){if(this.editorDiv.replaceChildren(),(0,f.default)(this,v)[v])for(const t of(0,f.default)(this,v)[v].split("\n")){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}function D(t){const{value:e,fontSize:i,color:s,rect:a,pageIndex:n}=(0,f.default)(this,w)[w];return t.value!==e||t.fontSize!==i||t.rect.some((t,e)=>Math.abs(t-a[e])>=1)||t.color.some((t,e)=>t!==s[e])||t.pageIndex!==n}function L(t=!1){if(!this.annotationElementId)return;if((0,f.default)(this,P)[P](),!t&&(0===this.width||0===this.height))return void setTimeout(()=>(0,f.default)(this,T)[T](!0),0);const e=s._internalPadding*this.parentScale;(0,f.default)(this,w)[w].rect=this.getRect(e,e)}s=M,M._freeTextDefaultContent="",M._internalPadding=0,M._defaultColor=null,M._defaultFontSize=10,M._type="freetext",M._editorType=o.AnnotationEditorType.FREETEXT;var j=i(97),N=i(405),B=(0,p.default)("boxes"),U=(0,p.default)("clipPathId"),H=(0,p.default)("colorPicker"),z=(0,p.default)("focusOutlines"),V=(0,p.default)("highlightDiv"),q=(0,p.default)("highlightOutlines"),G=(0,p.default)("id"),$=(0,p.default)("lastPoint"),W=(0,p.default)("opacity"),X=(0,p.default)("outlineId"),K=(0,p.default)("createOutlines"),Y=(0,p.default)("updateColor"),J=(0,p.default)("cleanDrawLayer"),Q=(0,p.default)("addToDrawLayer"),Z=(0,p.default)("rotateBbox"),tt=(0,p.default)("serializeBoxes"),et=(0,p.default)("serializeOutlines");class it extends l.AnnotationEditor{constructor(t){super(Object.assign({},t,{name:"highlightEditor"})),Object.defineProperty(this,et,{value:lt}),Object.defineProperty(this,tt,{value:ot}),Object.defineProperty(this,Q,{value:rt}),Object.defineProperty(this,J,{value:nt}),Object.defineProperty(this,Y,{value:at}),Object.defineProperty(this,K,{value:st}),Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:null}),Object.defineProperty(this,H,{writable:!0,value:null}),Object.defineProperty(this,z,{writable:!0,value:null}),Object.defineProperty(this,V,{writable:!0,value:null}),Object.defineProperty(this,q,{writable:!0,value:null}),Object.defineProperty(this,G,{writable:!0,value:null}),Object.defineProperty(this,$,{writable:!0,value:null}),Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,X,{writable:!0,value:null}),it._defaultColor||=this._uiManager.highlightColors?.values().next().value||"#fff066",this.color=t.color||it._defaultColor,(0,f.default)(this,W)[W]=t.opacity||it._defaultOpacity,(0,f.default)(this,B)[B]=t.boxes||null,this._isDraggable=!1,(0,f.default)(this,K)[K](),(0,f.default)(this,Q)[Q](),this.rotate(this.rotation)}static initialize(t){l.AnnotationEditor.initialize(t)}static updateDefaultParams(t,e){if(t===o.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)it._defaultColor=e}get toolbarPosition(){return(0,f.default)(this,$)[$]}updateParams(t,e){if(t===o.AnnotationEditorParamsType.HIGHLIGHT_COLOR)(0,f.default)(this,Y)[Y](e)}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,it._defaultColor]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||it._defaultColor]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&((0,f.default)(this,H)[H]=new j.ColorPicker({editor:this}),t.addColorPicker((0,f.default)(this,H)[H])),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(0)}getRect(t,e){return super.getRect(t,e,0)}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){super.remove(),(0,f.default)(this,J)[J]()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&((0,f.default)(this,Q)[Q](),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(0,f.default)(this,J)[J]():t&&((0,f.default)(this,Q)[Q](t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}rotate(t){const{drawLayer:e}=this.parent;e.rotate((0,f.default)(this,G)[G],t),e.rotate((0,f.default)(this,X)[X],t),e.updateBox((0,f.default)(this,G)[G],(0,f.default)(it,Z)[Z](this,t)),e.updateBox((0,f.default)(this,X)[X],(0,f.default)(it,Z)[Z]((0,f.default)(this,z)[z].box,t))}render(){if(this.div)return this.div;const t=super.render(),e=(0,f.default)(this,V)[V]=document.createElement("div");t.append(e),e.className="internal",e.style.clipPath=(0,f.default)(this,U)[U];const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),(0,d.bindEvents)(this,(0,f.default)(this,V)[V],["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.parent.drawLayer.addClass((0,f.default)(this,X)[X],"hovered")}pointerleave(){this.parent.drawLayer.removeClass((0,f.default)(this,X)[X],"hovered")}select(){super.select(),this.parent?.drawLayer.removeClass((0,f.default)(this,X)[X],"hovered"),this.parent?.drawLayer.addClass((0,f.default)(this,X)[X],"selected")}unselect(){super.unselect(),this.parent?.drawLayer.removeClass((0,f.default)(this,X)[X],"selected")}static deserialize(t,e,i){const s=super.deserialize(t,e,i),{rect:a,color:n,quadPoints:r}=t;s.color=o.Util.makeHexColor(...n),(0,f.default)(s,W)[W]=t.opacity;const[l,d]=s.pageDimensions;s.width=(a[2]-a[0])/l,s.height=(a[3]-a[1])/d;const h=(0,f.default)(s,B)[B]=[];for(let t=0;t<r.length;t+=8)h.push({x:r[4]/l,y:1-r[t+5]/d,width:(r[t+2]-r[t])/l,height:(r[t+5]-r[t+1])/d});return(0,f.default)(s,K)[K](),s}serialize(t=!1){if(this.isEmpty()||t)return null;const e=this.getRect(0,0),i=l.AnnotationEditor._colorManager.convert(this.color);return{annotationType:o.AnnotationEditorType.HIGHLIGHT,color:i,opacity:(0,f.default)(this,W)[W],quadPoints:(0,f.default)(this,tt)[tt](),outlines:(0,f.default)(this,et)[et](),pageIndex:this.pageIndex,rect:e,rotation:0,structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}}function st(){const t=new N.Outliner((0,f.default)(this,B)[B],.001);(0,f.default)(this,q)[q]=t.getOutlines(),({x:this.x,y:this.y,width:this.width,height:this.height}=(0,f.default)(this,q)[q].box);const e=new N.Outliner((0,f.default)(this,B)[B],.0025,.001,"ltr"===this._uiManager.direction);(0,f.default)(this,z)[z]=e.getOutlines();const{lastPoint:i}=(0,f.default)(this,z)[z].box;(0,f.default)(this,$)[$]=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}function at(t){const e=this.color;this.addCommands({cmd:()=>{this.color=t,this.parent.drawLayer.changeColor((0,f.default)(this,G)[G],t),(0,f.default)(this,H)[H]?.updateColor(t)},undo:()=>{this.color=e,this.parent.drawLayer.changeColor((0,f.default)(this,G)[G],e),(0,f.default)(this,H)[H]?.updateColor(e)},mustExec:!0,type:o.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function nt(){null!==(0,f.default)(this,G)[G]&&this.parent&&(this.parent.drawLayer.remove((0,f.default)(this,G)[G]),(0,f.default)(this,G)[G]=null,this.parent.drawLayer.remove((0,f.default)(this,X)[X]),(0,f.default)(this,X)[X]=null)}function rt(t=this.parent){null===(0,f.default)(this,G)[G]&&(({id:(0,f.default)(this,G)[G],clipPathId:(0,f.default)(this,U)[U]}=t.drawLayer.highlight((0,f.default)(this,q)[q],this.color,(0,f.default)(this,W)[W])),(0,f.default)(this,V)[V]&&((0,f.default)(this,V)[V].style.clipPath=(0,f.default)(this,U)[U]),(0,f.default)(this,X)[X]=t.drawLayer.highlightOutline((0,f.default)(this,z)[z]))}function ot(){const[t,e]=this.pageDimensions,i=(0,f.default)(this,B)[B],s=new Array(8*i.length);let a=0;for(const{x:n,y:r,width:o,height:l}of i){const i=n*t,d=(1-r-l)*e;s[a]=s[a+4]=i,s[a+1]=s[a+3]=d,s[a+2]=s[a+6]=i+o*t,s[a+5]=s[a+7]=d+l*e,a+=8}return s}function lt(){const[t,e]=this.pageDimensions,i=this.width*t,s=this.height*e,a=this.x*t,n=(1-this.y-this.height)*e,r=[];for(const t of(0,f.default)(this,q)[q].outlines){const e=new Array(t.length);for(let r=0;r<t.length;r+=2)e[r]=a+t[r]*i,e[r+1]=n+(1-t[r+1])*s;r.push(e)}return r}Object.defineProperty(it,Z,{value:function({x:t,y:e,width:i,height:s},a){switch(a){case 90:return{x:1-e-s,y:t,width:s,height:i};case 180:return{x:1-t-i,y:1-e-s,width:i,height:s};case 270:return{x:e,y:1-t-i,width:s,height:i}}return{x:t,y:e,width:i,height:s}}}),it._defaultColor=null,it._defaultOpacity=1,it._type="highlight",it._editorType=o.AnnotationEditorType.HIGHLIGHT;var dt=i(473),ht=(0,p.default)("baseHeight"),ct=(0,p.default)("baseWidth"),ut=(0,p.default)("boundCanvasPointermove"),ft=(0,p.default)("boundCanvasPointerleave"),pt=(0,p.default)("boundCanvasPointerup"),gt=(0,p.default)("boundCanvasPointerdown"),mt=(0,p.default)("canvasContextMenuTimeoutId"),bt=(0,p.default)("currentPath2D"),vt=(0,p.default)("disableEditing"),yt=(0,p.default)("hasSomethingToDraw"),At=(0,p.default)("isCanvasInitialized"),wt=(0,p.default)("observer"),_t=(0,p.default)("realWidth"),xt=(0,p.default)("realHeight"),Et=(0,p.default)("requestFrameCallback"),Pt=(0,p.default)("updateThickness"),St=(0,p.default)("updateColor"),Ct=(0,p.default)("updateOpacity"),Tt=(0,p.default)("getInitialBBox"),Mt=(0,p.default)("setStroke"),kt=(0,p.default)("startDrawing"),Rt=(0,p.default)("draw"),Ot=(0,p.default)("endPath"),Ft=(0,p.default)("stopDrawing"),It=(0,p.default)("drawPoints"),Dt=(0,p.default)("makeBezierCurve"),Lt=(0,p.default)("generateBezierPoints"),jt=(0,p.default)("redraw"),Nt=(0,p.default)("endDrawing"),Bt=(0,p.default)("createCanvas"),Ut=(0,p.default)("createObserver"),Ht=(0,p.default)("setCanvasDims"),zt=(0,p.default)("setScaleFactor"),Vt=(0,p.default)("updateTransform"),qt=(0,p.default)("buildPath2D"),Gt=(0,p.default)("toPDFCoordinates"),$t=(0,p.default)("fromPDFCoordinates"),Wt=(0,p.default)("serializePaths"),Xt=(0,p.default)("getBbox"),Kt=(0,p.default)("getPadding"),Yt=(0,p.default)("fitToContent");class Jt extends l.AnnotationEditor{constructor(t){super(Object.assign({},t,{name:"inkEditor"})),Object.defineProperty(this,Yt,{value:Ae}),Object.defineProperty(this,Kt,{value:ye}),Object.defineProperty(this,Xt,{value:ve}),Object.defineProperty(this,Wt,{value:be}),Object.defineProperty(this,Vt,{value:me}),Object.defineProperty(this,zt,{value:ge}),Object.defineProperty(this,Ht,{value:pe}),Object.defineProperty(this,Ut,{value:fe}),Object.defineProperty(this,Bt,{value:ue}),Object.defineProperty(this,Nt,{value:ce}),Object.defineProperty(this,jt,{value:he}),Object.defineProperty(this,Lt,{value:de}),Object.defineProperty(this,Dt,{value:le}),Object.defineProperty(this,It,{value:oe}),Object.defineProperty(this,Ft,{value:re}),Object.defineProperty(this,Ot,{value:ne}),Object.defineProperty(this,Rt,{value:ae}),Object.defineProperty(this,kt,{value:se}),Object.defineProperty(this,Mt,{value:ie}),Object.defineProperty(this,Tt,{value:ee}),Object.defineProperty(this,Ct,{value:te}),Object.defineProperty(this,St,{value:Zt}),Object.defineProperty(this,Pt,{value:Qt}),Object.defineProperty(this,ht,{writable:!0,value:0}),Object.defineProperty(this,ct,{writable:!0,value:0}),Object.defineProperty(this,ut,{writable:!0,value:this.canvasPointermove.bind(this)}),Object.defineProperty(this,ft,{writable:!0,value:this.canvasPointerleave.bind(this)}),Object.defineProperty(this,pt,{writable:!0,value:this.canvasPointerup.bind(this)}),Object.defineProperty(this,gt,{writable:!0,value:this.canvasPointerdown.bind(this)}),Object.defineProperty(this,mt,{writable:!0,value:null}),Object.defineProperty(this,bt,{writable:!0,value:new Path2D}),Object.defineProperty(this,vt,{writable:!0,value:!1}),Object.defineProperty(this,yt,{writable:!0,value:!1}),Object.defineProperty(this,At,{writable:!0,value:!1}),Object.defineProperty(this,wt,{writable:!0,value:null}),Object.defineProperty(this,_t,{writable:!0,value:0}),Object.defineProperty(this,xt,{writable:!0,value:0}),Object.defineProperty(this,Et,{writable:!0,value:null}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t){l.AnnotationEditor.initialize(t)}static updateDefaultParams(t,e){switch(t){case o.AnnotationEditorParamsType.INK_THICKNESS:Jt._defaultThickness=e;break;case o.AnnotationEditorParamsType.INK_COLOR:Jt._defaultColor=e;break;case o.AnnotationEditorParamsType.INK_OPACITY:Jt._defaultOpacity=e/100}}updateParams(t,e){switch(t){case o.AnnotationEditorParamsType.INK_THICKNESS:(0,f.default)(this,Pt)[Pt](e);break;case o.AnnotationEditorParamsType.INK_COLOR:(0,f.default)(this,St)[St](e);break;case o.AnnotationEditorParamsType.INK_OPACITY:(0,f.default)(this,Ct)[Ct](e)}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,Jt._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,Jt._defaultColor||l.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*Jt._defaultOpacity)]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Jt._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,this.color||Jt._defaultColor||l.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Jt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.canvas||((0,f.default)(this,Bt)[Bt](),(0,f.default)(this,Ut)[Ut]()),this.isAttachedToDOM||(this.parent.add(this),(0,f.default)(this,Ht)[Ht]()),(0,f.default)(this,Yt)[Yt]()))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,(0,f.default)(this,mt)[mt]&&(clearTimeout((0,f.default)(this,mt)[mt]),(0,f.default)(this,mt)[mt]=null),(0,f.default)(this,wt)[wt].disconnect(),(0,f.default)(this,wt)[wt]=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&null===t&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,e]=this.parentDimensions,i=this.width*t,s=this.height*e;this.setDimensions(i,s)}enableEditMode(){(0,f.default)(this,vt)[vt]||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",(0,f.default)(this,gt)[gt]))}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",(0,f.default)(this,gt)[gt]))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}commit(){(0,f.default)(this,vt)[vt]||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),(0,f.default)(this,vt)[vt]=!0,this.div.classList.add("disabled"),(0,f.default)(this,Yt)[Yt](!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){0===t.button&&this.isInEditMode()&&!(0,f.default)(this,vt)[vt]&&(this.setInForeground(),t.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),(0,f.default)(this,kt)[kt](t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),(0,f.default)(this,Rt)[Rt](t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),(0,f.default)(this,Nt)[Nt](t)}canvasPointerleave(t){(0,f.default)(this,Nt)[Nt](t)}get isResizable(){return!this.isEmpty()&&(0,f.default)(this,vt)[vt]}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,s,a,n]=(0,f.default)(this,Tt)[Tt]();if(this.setAt(i,s,0,0),this.setDims(a,n),(0,f.default)(this,Bt)[Bt](),this.width){const[i,s]=this.parentDimensions;this.setAspectRatio(this.width*i,this.height*s),this.setAt(t*i,e*s,this.width*i,this.height*s),(0,f.default)(this,At)[At]=!0,(0,f.default)(this,Ht)[Ht](),this.setDims(this.width*i,this.height*s),(0,f.default)(this,jt)[jt](),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return(0,f.default)(this,Ut)[Ut](),this.div}setDimensions(t,e){const i=Math.round(t),s=Math.round(e);if((0,f.default)(this,_t)[_t]===i&&(0,f.default)(this,xt)[xt]===s)return;(0,f.default)(this,_t)[_t]=i,(0,f.default)(this,xt)[xt]=s,this.canvas.style.visibility="hidden";const[a,n]=this.parentDimensions;this.width=t/a,this.height=e/n,this.fixAndSetPosition(),(0,f.default)(this,vt)[vt]&&(0,f.default)(this,zt)[zt](t,e),(0,f.default)(this,Ht)[Ht](),(0,f.default)(this,jt)[jt](),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(t,e,i){if(t instanceof h.InkAnnotationElement)return null;const s=super.deserialize(t,e,i);s.thickness=t.thickness,s.color=o.Util.makeHexColor(...t.color),s.opacity=t.opacity;const[a,n]=s.pageDimensions,r=s.width*a,d=s.height*n,c=s.parentScale,u=t.thickness/2;(0,f.default)(s,vt)[vt]=!0,(0,f.default)(s,_t)[_t]=Math.round(r),(0,f.default)(s,xt)[xt]=Math.round(d);const{paths:p,rect:g,rotation:m}=t;for(let{bezier:t}of p){t=(0,f.default)(Jt,$t)[$t](t,g,m);const e=[];s.paths.push(e);let i=c*(t[0]-u),a=c*(t[1]-u);for(let s=2,n=t.length;s<n;s+=6){const n=c*(t[s]-u),r=c*(t[s+1]-u),o=c*(t[s+2]-u),l=c*(t[s+3]-u),d=c*(t[s+4]-u),h=c*(t[s+5]-u);e.push([[i,a],[n,r],[o,l],[d,h]]),i=d,a=h}const n=(0,f.default)(this,qt)[qt](e);s.bezierPath2D.push(n)}const b=(0,f.default)(s,Xt)[Xt]();return(0,f.default)(s,ct)[ct]=Math.max(l.AnnotationEditor.MIN_SIZE,b[2]-b[0]),(0,f.default)(s,ht)[ht]=Math.max(l.AnnotationEditor.MIN_SIZE,b[3]-b[1]),(0,f.default)(s,zt)[zt](r,d),s}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),e=l.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:o.AnnotationEditorType.INK,color:e,thickness:this.thickness,opacity:this.opacity,paths:(0,f.default)(this,Wt)[Wt](this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}function Qt(t){const e=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,(0,f.default)(this,Yt)[Yt]()},undo:()=>{this.thickness=e,(0,f.default)(this,Yt)[Yt]()},mustExec:!0,type:o.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}function Zt(t){const e=this.color;this.addCommands({cmd:()=>{this.color=t,(0,f.default)(this,jt)[jt]()},undo:()=>{this.color=e,(0,f.default)(this,jt)[jt]()},mustExec:!0,type:o.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function te(t){t/=100;const e=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,(0,f.default)(this,jt)[jt]()},undo:()=>{this.opacity=e,(0,f.default)(this,jt)[jt]()},mustExec:!0,type:o.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}function ee(){const{parentRotation:t,parentDimensions:[e,i]}=this;switch(t){case 90:return[0,i,i,e];case 180:return[e,i,e,i];case 270:return[e,0,i,e];default:return[0,0,e,i]}}function ie(){const{ctx:t,color:e,opacity:i,thickness:s,parentScale:a,scaleFactor:n}=this;t.lineWidth=s*a/n,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${e}${(0,d.opacityToHex)(i)}`}function se(t,e){this.canvas.addEventListener("contextmenu",dt.noContextMenu),this.canvas.addEventListener("pointerleave",(0,f.default)(this,ft)[ft]),this.canvas.addEventListener("pointermove",(0,f.default)(this,ut)[ut]),this.canvas.addEventListener("pointerup",(0,f.default)(this,pt)[pt]),this.canvas.removeEventListener("pointerdown",(0,f.default)(this,gt)[gt]),this.isEditing=!0,(0,f.default)(this,At)[At]||((0,f.default)(this,At)[At]=!0,(0,f.default)(this,Ht)[Ht](),this.thickness||=a._defaultThickness,this.color||=a._defaultColor||l.AnnotationEditor._defaultLineColor,this.opacity??=a._defaultOpacity),this.currentPath.push([t,e]),(0,f.default)(this,yt)[yt]=!1,(0,f.default)(this,Mt)[Mt](),(0,f.default)(this,Et)[Et]=()=>{(0,f.default)(this,It)[It](),(0,f.default)(this,Et)[Et]&&window.requestAnimationFrame((0,f.default)(this,Et)[Et])},window.requestAnimationFrame((0,f.default)(this,Et)[Et])}function ae(t,e){const[i,s]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===i&&e===s)return;const a=this.currentPath;let n=(0,f.default)(this,bt)[bt];if(a.push([t,e]),(0,f.default)(this,yt)[yt]=!0,a.length<=2)return n.moveTo(...a[0]),void n.lineTo(t,e);3===a.length&&((0,f.default)(this,bt)[bt]=n=new Path2D,n.moveTo(...a[0])),(0,f.default)(this,Dt)[Dt](n,...a.at(-3),...a.at(-2),t,e)}function ne(){if(0===this.currentPath.length)return;const t=this.currentPath.at(-1);(0,f.default)(this,bt)[bt].lineTo(...t)}function re(t,e){let i;if((0,f.default)(this,Et)[Et]=null,t=Math.min(Math.max(t,0),this.canvas.width),e=Math.min(Math.max(e,0),this.canvas.height),(0,f.default)(this,Rt)[Rt](t,e),(0,f.default)(this,Ot)[Ot](),1!==this.currentPath.length)i=(0,f.default)(this,Lt)[Lt]();else{const s=[t,e];i=[[s,s.slice(),s.slice(),s]]}const s=(0,f.default)(this,bt)[bt],a=this.currentPath;this.currentPath=[],(0,f.default)(this,bt)[bt]=new Path2D;this.addCommands({cmd:()=>{this.allRawPaths.push(a),this.paths.push(i),this.bezierPath2D.push(s),this.rebuild()},undo:()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||((0,f.default)(this,Bt)[Bt](),(0,f.default)(this,Ut)[Ut]()),(0,f.default)(this,Yt)[Yt]())},mustExec:!0})}function oe(){if(!(0,f.default)(this,yt)[yt])return;(0,f.default)(this,yt)[yt]=!1;const t=Math.ceil(this.thickness*this.parentScale),e=this.currentPath.slice(-3),i=e.map(t=>t[0]),s=e.map(t=>t[1]),{ctx:a}=(Math.min(...i),Math.max(...i),Math.min(...s),Math.max(...s),this);a.save(),a.clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.bezierPath2D)a.stroke(t);a.stroke((0,f.default)(this,bt)[bt]),a.restore()}function le(t,e,i,s,a,n,r){const o=(e+s)/2,l=(i+a)/2,d=(s+n)/2,h=(a+r)/2;t.bezierCurveTo(o+2*(s-o)/3,l+2*(a-l)/3,d+2*(s-d)/3,h+2*(a-h)/3,d,h)}function de(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const e=[];let i,[s,a]=t[0];for(i=1;i<t.length-2;i++){const[n,r]=t[i],[o,l]=t[i+1],d=(n+o)/2,h=(r+l)/2,c=[s+2*(n-s)/3,a+2*(r-a)/3],u=[d+2*(n-d)/3,h+2*(r-h)/3];e.push([[s,a],c,u,[d,h]]),[s,a]=[d,h]}const[n,r]=t[i],[o,l]=t[i+1],d=[s+2*(n-s)/3,a+2*(r-a)/3],h=[o+2*(n-o)/3,l+2*(r-l)/3];return e.push([[s,a],d,h,[o,l]]),e}function he(){if(this.isEmpty())return void(0,f.default)(this,Vt)[Vt]();(0,f.default)(this,Mt)[Mt]();const{canvas:t,ctx:e}=this;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height),(0,f.default)(this,Vt)[Vt]();for(const t of this.bezierPath2D)e.stroke(t)}function ce(t){this.canvas.removeEventListener("pointerleave",(0,f.default)(this,ft)[ft]),this.canvas.removeEventListener("pointermove",(0,f.default)(this,ut)[ut]),this.canvas.removeEventListener("pointerup",(0,f.default)(this,pt)[pt]),this.canvas.addEventListener("pointerdown",(0,f.default)(this,gt)[gt]),(0,f.default)(this,mt)[mt]&&clearTimeout((0,f.default)(this,mt)[mt]),(0,f.default)(this,mt)[mt]=setTimeout(()=>{(0,f.default)(this,mt)[mt]=null,this.canvas.removeEventListener("contextmenu",dt.noContextMenu)},10),(0,f.default)(this,Ft)[Ft](t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}function ue(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}function fe(){(0,f.default)(this,wt)[wt]=new ResizeObserver(t=>{const e=t[0].contentRect;e.width&&e.height&&this.setDimensions(e.width,e.height)}),(0,f.default)(this,wt)[wt].observe(this.div)}function pe(){if(!(0,f.default)(this,At)[At])return;const[t,e]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*e),(0,f.default)(this,Vt)[Vt]()}function ge(t,e){const i=(0,f.default)(this,Kt)[Kt](),s=(t-i)/(0,f.default)(this,ct)[ct],a=(e-i)/(0,f.default)(this,ht)[ht];this.scaleFactor=Math.min(s,a)}function me(){const t=(0,f.default)(this,Kt)[Kt]()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}function be(t,e,i,s){const n=[],r=this.thickness/2,o=t*e+r,l=t*i+r;for(const e of this.paths){const i=[],r=[];for(let s=0,a=e.length;s<a;s++){const[n,d,h,c]=e[s],u=t*n[0]+o,f=t*n[1]+l,p=t*d[0]+o,g=t*d[1]+l,m=t*h[0]+o,b=t*h[1]+l,v=t*c[0]+o,y=t*c[1]+l;0===s&&(i.push(u,f),r.push(u,f)),i.push(p,g,m,b,v,y),r.push(p,g),s===a-1&&r.push(v,y)}n.push({bezier:(0,f.default)(a,Gt)[Gt](i,s,this.rotation),points:(0,f.default)(a,Gt)[Gt](r,s,this.rotation)})}return n}function ve(){let t=1/0,e=-1/0,i=1/0,s=-1/0;for(const a of this.paths)for(const[n,r,l,d]of a){const a=o.Util.bezierBoundingBox(...n,...r,...l,...d);t=Math.min(t,a[0]),i=Math.min(i,a[1]),e=Math.max(e,a[2]),s=Math.max(s,a[3])}return[t,i,e,s]}function ye(){return(0,f.default)(this,vt)[vt]?Math.ceil(this.thickness*this.parentScale):0}function Ae(t=!1){if(this.isEmpty())return;if(!(0,f.default)(this,vt)[vt])return void(0,f.default)(this,jt)[jt]();const e=(0,f.default)(this,Xt)[Xt](),i=(0,f.default)(this,Kt)[Kt]();(0,f.default)(this,ct)[ct]=Math.max(l.AnnotationEditor.MIN_SIZE,e[2]-e[0]),(0,f.default)(this,ht)[ht]=Math.max(l.AnnotationEditor.MIN_SIZE,e[3]-e[1]);const s=Math.ceil(i+(0,f.default)(this,ct)[ct]*this.scaleFactor),a=Math.ceil(i+(0,f.default)(this,ht)[ht]*this.scaleFactor),[n,r]=this.parentDimensions;this.width=s/n,this.height=a/r,this.setAspectRatio(s,a);const o=this.translationX,d=this.translationY;this.translationX=-e[0],this.translationY=-e[1],(0,f.default)(this,Ht)[Ht](),(0,f.default)(this,jt)[jt](),(0,f.default)(this,_t)[_t]=s,(0,f.default)(this,xt)[xt]=a,this.setDims(s,a);const h=t?i/this.scaleFactor/2:0;this.translate(o-this.translationX-h,d-this.translationY-h)}a=Jt,Object.defineProperty(Jt,$t,{value:function(t,e,i){const[s,a,n,r]=e;switch(i){case 0:for(let e=0,i=t.length;e<i;e+=2)t[e]-=s,t[e+1]=r-t[e+1];break;case 90:for(let e=0,i=t.length;e<i;e+=2){const i=t[e];t[e]=t[e+1]-a,t[e+1]=i-s}break;case 180:for(let e=0,i=t.length;e<i;e+=2)t[e]=n-t[e],t[e+1]-=a;break;case 270:for(let e=0,i=t.length;e<i;e+=2){const i=t[e];t[e]=r-t[e+1],t[e+1]=n-i}break;default:throw new Error("Invalid rotation")}return t}}),Object.defineProperty(Jt,Gt,{value:function(t,e,i){const[s,a,n,r]=e;switch(i){case 0:for(let e=0,i=t.length;e<i;e+=2)t[e]+=s,t[e+1]=r-t[e+1];break;case 90:for(let e=0,i=t.length;e<i;e+=2){const i=t[e];t[e]=t[e+1]+s,t[e+1]=i+a}break;case 180:for(let e=0,i=t.length;e<i;e+=2)t[e]=n-t[e],t[e+1]+=a;break;case 270:for(let e=0,i=t.length;e<i;e+=2){const i=t[e];t[e]=n-t[e+1],t[e+1]=r-i}break;default:throw new Error("Invalid rotation")}return t}}),Object.defineProperty(Jt,qt,{value:function(t){const e=new Path2D;for(let i=0,s=t.length;i<s;i++){const[s,a,n,r]=t[i];0===i&&e.moveTo(...s),e.bezierCurveTo(a[0],a[1],n[0],n[1],r[0],r[1])}return e}}),Jt._defaultColor=null,Jt._defaultOpacity=1,Jt._defaultThickness=1,Jt._type="ink",Jt._editorType=o.AnnotationEditorType.INK;var we=(0,p.default)("bitmap"),_e=(0,p.default)("bitmapId"),xe=(0,p.default)("bitmapPromise"),Ee=(0,p.default)("bitmapUrl"),Pe=(0,p.default)("bitmapFile"),Se=(0,p.default)("bitmapFileName"),Ce=(0,p.default)("canvas"),Te=(0,p.default)("observer"),Me=(0,p.default)("resizeTimeoutId"),ke=(0,p.default)("isSvg"),Re=(0,p.default)("hasBeenAddedInUndoStack"),Oe=(0,p.default)("getBitmapFetched"),Fe=(0,p.default)("getBitmapDone"),Ie=(0,p.default)("getBitmap"),De=(0,p.default)("createCanvas"),Le=(0,p.default)("setDimensions"),je=(0,p.default)("scaleBitmap"),Ne=(0,p.default)("drawBitmap"),Be=(0,p.default)("serializeBitmap"),Ue=(0,p.default)("createObserver");class He extends l.AnnotationEditor{constructor(t){super(Object.assign({},t,{name:"stampEditor"})),Object.defineProperty(this,Ue,{value:Ye}),Object.defineProperty(this,Be,{value:Ke}),Object.defineProperty(this,Ne,{value:Xe}),Object.defineProperty(this,je,{value:We}),Object.defineProperty(this,Le,{value:$e}),Object.defineProperty(this,De,{value:Ge}),Object.defineProperty(this,Ie,{value:qe}),Object.defineProperty(this,Fe,{value:Ve}),Object.defineProperty(this,Oe,{value:ze}),Object.defineProperty(this,we,{writable:!0,value:null}),Object.defineProperty(this,_e,{writable:!0,value:null}),Object.defineProperty(this,xe,{writable:!0,value:null}),Object.defineProperty(this,Ee,{writable:!0,value:null}),Object.defineProperty(this,Pe,{writable:!0,value:null}),Object.defineProperty(this,Se,{writable:!0,value:""}),Object.defineProperty(this,Ce,{writable:!0,value:null}),Object.defineProperty(this,Te,{writable:!0,value:null}),Object.defineProperty(this,Me,{writable:!0,value:null}),Object.defineProperty(this,ke,{writable:!0,value:!1}),Object.defineProperty(this,Re,{writable:!0,value:!1}),(0,f.default)(this,Ee)[Ee]=t.bitmapUrl,(0,f.default)(this,Pe)[Pe]=t.bitmapFile}static initialize(t){l.AnnotationEditor.initialize(t)}static get supportedTypes(){return(0,o.shadow)(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return(0,o.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(o.AnnotationEditorType.STAMP,{bitmapFile:t.getAsFile()})}remove(){(0,f.default)(this,_e)[_e]&&((0,f.default)(this,we)[we]=null,this._uiManager.imageManager.deleteId((0,f.default)(this,_e)[_e]),(0,f.default)(this,Ce)[Ce]?.remove(),(0,f.default)(this,Ce)[Ce]=null,(0,f.default)(this,Te)[Te]?.disconnect(),(0,f.default)(this,Te)[Te]=null,(0,f.default)(this,Me)[Me]&&(clearTimeout((0,f.default)(this,Me)[Me]),(0,f.default)(this,Me)[Me]=null)),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&((0,f.default)(this,_e)[_e]&&(0,f.default)(this,Ie)[Ie](),this.isAttachedToDOM||this.parent.add(this))):(0,f.default)(this,_e)[_e]&&(0,f.default)(this,Ie)[Ie]()}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!((0,f.default)(this,xe)[xe]||(0,f.default)(this,we)[we]||(0,f.default)(this,Ee)[Ee]||(0,f.default)(this,Pe)[Pe])}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,(0,f.default)(this,we)[we]?(0,f.default)(this,De)[De]():(0,f.default)(this,Ie)[Ie](),this.width){const[i,s]=this.parentDimensions;this.setAt(t*i,e*s,this.width*i,this.height*s)}return this.div}getImageForAltText(){return(0,f.default)(this,Ce)[Ce]}static deserialize(t,e,i){if(t instanceof h.StampAnnotationElement)return null;const s=super.deserialize(t,e,i),{rect:a,bitmapUrl:n,bitmapId:r,isSvg:o,accessibilityData:l}=t;r&&i.imageManager.isValidId(r)?(0,f.default)(s,_e)[_e]=r:(0,f.default)(s,Ee)[Ee]=n,(0,f.default)(s,ke)[ke]=o;const[d,c]=s.pageDimensions;return s.width=(a[2]-a[0])/d,s.height=(a[3]-a[1])/c,l&&(s.altTextData=l),s}serialize(t=!1,e=null){if(this.isEmpty())return null;const i={annotationType:o.AnnotationEditorType.STAMP,bitmapId:(0,f.default)(this,_e)[_e],pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:(0,f.default)(this,ke)[ke],structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=(0,f.default)(this,Be)[Be](!0),i.accessibilityData=this.altTextData,i;const{decorative:s,altText:a}=this.altTextData;if(!s&&a&&(i.accessibilityData={type:"Figure",alt:a}),null===e)return i;e.stamps||=new Map;const n=(0,f.default)(this,ke)[ke]?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(e.stamps.has((0,f.default)(this,_e)[_e])){if((0,f.default)(this,ke)[ke]){const t=e.stamps.get((0,f.default)(this,_e)[_e]);n>t.area&&(t.area=n,t.serialized.bitmap.close(),t.serialized.bitmap=(0,f.default)(this,Be)[Be](!1))}}else e.stamps.set((0,f.default)(this,_e)[_e],{area:n,serialized:i}),i.bitmap=(0,f.default)(this,Be)[Be](!1);return i}}function ze(t,e=!1){t?((0,f.default)(this,we)[we]=t.bitmap,e||((0,f.default)(this,_e)[_e]=t.id,(0,f.default)(this,ke)[ke]=t.isSvg),t.file&&((0,f.default)(this,Se)[Se]=t.file.name),(0,f.default)(this,De)[De]()):this.remove()}function Ve(){(0,f.default)(this,xe)[xe]=null,this._uiManager.enableWaiting(!1),(0,f.default)(this,Ce)[Ce]&&this.div.focus()}function qe(){if((0,f.default)(this,_e)[_e])return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId((0,f.default)(this,_e)[_e]).then(t=>(0,f.default)(this,Oe)[Oe](t,!0)).finally(()=>(0,f.default)(this,Fe)[Fe]());if((0,f.default)(this,Ee)[Ee]){const t=(0,f.default)(this,Ee)[Ee];return(0,f.default)(this,Ee)[Ee]=null,this._uiManager.enableWaiting(!0),void((0,f.default)(this,xe)[xe]=this._uiManager.imageManager.getFromUrl(t).then(t=>(0,f.default)(this,Oe)[Oe](t)).finally(()=>(0,f.default)(this,Fe)[Fe]()))}if((0,f.default)(this,Pe)[Pe]){const t=(0,f.default)(this,Pe)[Pe];return(0,f.default)(this,Pe)[Pe]=null,this._uiManager.enableWaiting(!0),void((0,f.default)(this,xe)[xe]=this._uiManager.imageManager.getFromFile(t).then(t=>(0,f.default)(this,Oe)[Oe](t)).finally(()=>(0,f.default)(this,Fe)[Fe]()))}const t=document.createElement("input");t.type="file",t.accept=n.supportedTypesStr,(0,f.default)(this,xe)[xe]=new Promise(e=>{t.addEventListener("change",async()=>{if(t.files&&0!==t.files.length){this._uiManager.enableWaiting(!0);const e=await this._uiManager.imageManager.getFromFile(t.files[0]);(0,f.default)(this,Oe)[Oe](e)}else this.remove();e()}),t.addEventListener("cancel",()=>{this.remove(),e()})}).finally(()=>(0,f.default)(this,Fe)[Fe]()),t.click()}function Ge(){const{div:t}=this;let{width:e,height:i}=(0,f.default)(this,we)[we];const[s,a]=this.pageDimensions,n=.75;if(this.width)e=this.width*s,i=this.height*a;else if(e>n*s||i>n*a){const t=Math.min(n*s/e,n*a/i);e*=t,i*=t}const[r,o]=this.parentDimensions;this.setDims(e*r/s,i*o/a),this._uiManager.enableWaiting(!1);const l=(0,f.default)(this,Ce)[Ce]=document.createElement("canvas");t.append(l),t.hidden=!1,(0,f.default)(this,Ne)[Ne](e,i),(0,f.default)(this,Ue)[Ue](),(0,f.default)(this,Re)[Re]||(this.parent.addUndoableEditor(this),(0,f.default)(this,Re)[Re]=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton(),(0,f.default)(this,Se)[Se]&&l.setAttribute("aria-label",(0,f.default)(this,Se)[Se])}function $e(t,e){const[i,s]=this.parentDimensions;this.width=t/i,this.height=e/s,this.setDims(t,e),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==(0,f.default)(this,Me)[Me]&&clearTimeout((0,f.default)(this,Me)[Me]);(0,f.default)(this,Me)[Me]=setTimeout(()=>{(0,f.default)(this,Me)[Me]=null,(0,f.default)(this,Ne)[Ne](t,e)},200)}function We(t,e){const{width:i,height:s}=(0,f.default)(this,we)[we];let a=i,n=s,r=(0,f.default)(this,we)[we];for(;a>2*t||n>2*e;){const i=a,s=n;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),n>2*e&&(n=n>=16384?Math.floor(n/2)-1:Math.ceil(n/2));const o=new OffscreenCanvas(a,n);o.getContext("2d").drawImage(r,0,0,i,s,0,0,a,n),r=o.transferToImageBitmap()}return r}function Xe(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=(0,f.default)(this,Ce)[Ce];if(!i||i.width===t&&i.height===e)return;i.width=t,i.height=e;const s=(0,f.default)(this,ke)[ke]?(0,f.default)(this,we)[we]:(0,f.default)(this,je)[je](t,e),a=i.getContext("2d");a.filter=this._uiManager.hcmFilter,a.drawImage(s,0,0,s.width,s.height,0,0,t,e)}function Ke(t){if(t){if((0,f.default)(this,ke)[ke]){const t=this._uiManager.imageManager.getSvgUrl((0,f.default)(this,_e)[_e]);if(t)return t}const t=document.createElement("canvas");({width:t.width,height:t.height}=(0,f.default)(this,we)[we]);return t.getContext("2d").drawImage((0,f.default)(this,we)[we],0,0),t.toDataURL()}if((0,f.default)(this,ke)[ke]){const[t,e]=this.pageDimensions,i=Math.round(this.width*t*dt.PixelsPerInch.PDF_TO_CSS_UNITS),s=Math.round(this.height*e*dt.PixelsPerInch.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(i,s);return a.getContext("2d").drawImage((0,f.default)(this,we)[we],0,0,(0,f.default)(this,we)[we].width,(0,f.default)(this,we)[we].height,0,0,i,s),a.transferToImageBitmap()}return structuredClone((0,f.default)(this,we)[we])}function Ye(){(0,f.default)(this,Te)[Te]=new ResizeObserver(t=>{const e=t[0].contentRect;e.width&&e.height&&(0,f.default)(this,Le)[Le](e.width,e.height)}),(0,f.default)(this,Te)[Te].observe(this.div)}n=He,He._type="stamp",He._editorType=o.AnnotationEditorType.STAMP;var Je=(0,p.default)("accessibilityManager"),Qe=(0,p.default)("allowClick"),Ze=(0,p.default)("annotationLayer"),ti=(0,p.default)("boundPointerup"),ei=(0,p.default)("boundPointerUpAfterSelection"),ii=(0,p.default)("boundPointerdown"),si=(0,p.default)("editorFocusTimeoutId"),ai=(0,p.default)("boundSelectionStart"),ni=(0,p.default)("editors"),ri=(0,p.default)("hadPointerDown"),oi=(0,p.default)("isCleaningUp"),li=(0,p.default)("isDisabling"),di=(0,p.default)("textLayer"),hi=(0,p.default)("uiManager"),ci=(0,p.default)("editorTypes"),ui=(0,p.default)("currentEditorType"),fi=(0,p.default)("createNewEditor"),pi=(0,p.default)("createAndAddNewEditor"),gi=(0,p.default)("getCenterPoint"),mi=(0,p.default)("cleanup");class bi{constructor({uiManager:t,pageIndex:e,div:i,accessibilityManager:s,annotationLayer:a,drawLayer:n,textLayer:r,viewport:o,l10n:l}){Object.defineProperty(this,mi,{value:_i}),Object.defineProperty(this,gi,{value:wi}),Object.defineProperty(this,pi,{value:Ai}),Object.defineProperty(this,fi,{value:yi}),Object.defineProperty(this,ui,{get:vi,set:void 0}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),Object.defineProperty(this,Qe,{writable:!0,value:!1}),Object.defineProperty(this,Ze,{writable:!0,value:null}),Object.defineProperty(this,ti,{writable:!0,value:this.pointerup.bind(this)}),Object.defineProperty(this,ei,{writable:!0,value:this.pointerUpAfterSelection.bind(this)}),Object.defineProperty(this,ii,{writable:!0,value:this.pointerdown.bind(this)}),Object.defineProperty(this,si,{writable:!0,value:null}),Object.defineProperty(this,ai,{writable:!0,value:this.selectionStart.bind(this)}),Object.defineProperty(this,ni,{writable:!0,value:new Map}),Object.defineProperty(this,ri,{writable:!0,value:!1}),Object.defineProperty(this,oi,{writable:!0,value:!1}),Object.defineProperty(this,li,{writable:!0,value:!1}),Object.defineProperty(this,di,{writable:!0,value:null}),Object.defineProperty(this,hi,{writable:!0,value:void 0});const d=[...(0,f.default)(bi,ci)[ci].values()];if(!bi._initialized){bi._initialized=!0;for(const t of d)t.initialize(l)}t.registerEditorTypes(d),(0,f.default)(this,hi)[hi]=t,this.pageIndex=e,this.div=i,(0,f.default)(this,Je)[Je]=s,(0,f.default)(this,Ze)[Ze]=a,this.viewport=o,(0,f.default)(this,di)[di]=r,this.drawLayer=n,(0,f.default)(this,hi)[hi].addLayer(this)}get isEmpty(){return 0===(0,f.default)(this,ni)[ni].size}updateToolbar(t){(0,f.default)(this,hi)[hi].updateToolbar(t)}updateMode(t=(0,f.default)(this,hi)[hi].getMode()){switch((0,f.default)(this,mi)[mi](),t){case o.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;case o.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case o.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}if(t!==o.AnnotationEditorType.NONE){const{classList:e}=this.div;for(const i of(0,f.default)(bi,ci)[ci].values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}}addInkEditorIfNeeded(t){if((0,f.default)(this,hi)[hi].getMode()!==o.AnnotationEditorType.INK)return;if(!t)for(const t of(0,f.default)(this,ni)[ni].values())if(t.isEmpty())return void t.setInBackground();(0,f.default)(this,pi)[pi]({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){(0,f.default)(this,hi)[hi].setEditingState(t)}addCommands(t){(0,f.default)(this,hi)[hi].addCommands(t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}enable(){this.togglePointerEvents(!0);const t=new Set;for(const e of(0,f.default)(this,ni)[ni].values())e.enableEditing(),e.annotationElementId&&t.add(e.annotationElementId);if(!(0,f.default)(this,Ze)[Ze])return;const e=(0,f.default)(this,Ze)[Ze].getEditableAnnotations();for(const i of e){if(i.hide(),(0,f.default)(this,hi)[hi].isDeletedAnnotationElement(i.data.id))continue;if(t.has(i.data.id))continue;const e=this.deserialize(i);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){(0,f.default)(this,li)[li]=!0,this.togglePointerEvents(!1);const t=new Set;for(const e of(0,f.default)(this,ni)[ni].values())e.disableEditing(),e.annotationElementId&&null===e.serialize()?(this.getEditableAnnotation(e.annotationElementId)?.show(),e.remove()):t.add(e.annotationElementId);if((0,f.default)(this,Ze)[Ze]){const e=(0,f.default)(this,Ze)[Ze].getEditableAnnotations();for(const i of e){const{id:e}=i.data;t.has(e)||(0,f.default)(this,hi)[hi].isDeletedAnnotationElement(e)||i.show()}}(0,f.default)(this,mi)[mi](),this.isEmpty&&(this.div.hidden=!0);const{classList:e}=this.div;for(const t of(0,f.default)(bi,ci)[ci].values())e.remove(`${t._type}Editing`);this.disableTextSelection(),(0,f.default)(this,li)[li]=!1}getEditableAnnotation(t){return(0,f.default)(this,Ze)[Ze]?.getEditableAnnotation(t)||null}setActiveEditor(t){(0,f.default)(this,hi)[hi].getActive()!==t&&(0,f.default)(this,hi)[hi].setActiveEditor(t)}enableTextSelection(){(0,f.default)(this,di)[di]?.div&&document.addEventListener("selectstart",(0,f.default)(this,ai)[ai])}disableTextSelection(){(0,f.default)(this,di)[di]?.div&&document.removeEventListener("selectstart",(0,f.default)(this,ai)[ai])}enableClick(){this.div.addEventListener("pointerdown",(0,f.default)(this,ii)[ii]),this.div.addEventListener("pointerup",(0,f.default)(this,ti)[ti])}disableClick(){this.div.removeEventListener("pointerdown",(0,f.default)(this,ii)[ii]),this.div.removeEventListener("pointerup",(0,f.default)(this,ti)[ti])}attach(t){(0,f.default)(this,ni)[ni].set(t.id,t);const{annotationElementId:e}=t;e&&(0,f.default)(this,hi)[hi].isDeletedAnnotationElement(e)&&(0,f.default)(this,hi)[hi].removeDeletedAnnotationElement(t)}detach(t){(0,f.default)(this,ni)[ni].delete(t.id),(0,f.default)(this,Je)[Je]?.removePointerInTextLayer(t.contentDiv),!(0,f.default)(this,li)[li]&&t.annotationElementId&&(0,f.default)(this,hi)[hi].addDeletedAnnotationElement(t)}remove(t){this.detach(t),(0,f.default)(this,hi)[hi].removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,(0,f.default)(this,oi)[oi]||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.annotationElementId&&((0,f.default)(this,hi)[hi].addDeletedAnnotationElement(t.annotationElementId),l.AnnotationEditor.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(this.changeParent(t),(0,f.default)(this,hi)[hi].addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),(0,f.default)(this,hi)[hi].addToAnnotationStorage(t)}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!(0,f.default)(this,si)[si]&&(t._focusEventsAllowed=!1,(0,f.default)(this,si)[si]=setTimeout(()=>{(0,f.default)(this,si)[si]=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0}),e.focus())},0)),t._structTreeParentId=(0,f.default)(this,Je)[Je]?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild()):this.add(t)}addUndoableEditor(t){this.addCommands({cmd:()=>t._uiManager.rebuild(t),undo:()=>{t.remove()},mustExec:!1})}getNextId(){return(0,f.default)(this,hi)[hi].getId()}canCreateNewEmptyEditor(){return(0,f.default)(this,ui)[ui]?.canCreateNewEmptyEditor()}pasteEditor(t,e){(0,f.default)(this,hi)[hi].updateToolbar(t),(0,f.default)(this,hi)[hi].updateMode(t);const{offsetX:i,offsetY:s}=(0,f.default)(this,gi)[gi](),a=this.getNextId(),n=(0,f.default)(this,fi)[fi](Object.assign({parent:this,id:a,x:i,y:s,uiManager:(0,f.default)(this,hi)[hi],isCentered:!0},e));n&&this.add(n)}deserialize(t){return(0,f.default)(bi,ci)[ci].get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,(0,f.default)(this,hi)[hi])||null}addNewEditor(){(0,f.default)(this,pi)[pi]((0,f.default)(this,gi)[gi](),!0)}setSelected(t){(0,f.default)(this,hi)[hi].setSelected(t)}toggleSelected(t){(0,f.default)(this,hi)[hi].toggleSelected(t)}isSelected(t){return(0,f.default)(this,hi)[hi].isSelected(t)}unselect(t){(0,f.default)(this,hi)[hi].unselect(t)}selectionStart(t){(0,f.default)(this,di)[di]?.div.addEventListener("pointerup",(0,f.default)(this,ei)[ei],{once:!0})}pointerUpAfterSelection(t){const e=document.getSelection();if(0===e.rangeCount)return;const i=e.getRangeAt(0);if(i.collapsed)return;if(!(0,f.default)(this,di)[di]?.div.contains(i.commonAncestorContainer))return;const{x:s,y:a,width:n,height:r}=(0,f.default)(this,di)[di].div.getBoundingClientRect(),o=i.getClientRects();let l;switch(this.viewport.rotation){case 90:l=(t,e,i,o)=>({x:(e-a)/r,y:1-(t+i-s)/n,width:o/r,height:i/n});break;case 180:l=(t,e,i,o)=>({x:1-(t+i-s)/n,y:1-(e+o-a)/r,width:i/n,height:o/r});break;case 270:l=(t,e,i,o)=>({x:1-(e+o-a)/r,y:(t-s)/n,width:o/r,height:i/n});break;default:l=(t,e,i,o)=>({x:(t-s)/n,y:(e-a)/r,width:i/n,height:o/r})}const d=[];for(const{x:t,y:e,width:i,height:s}of o)0!==i&&0!==s&&d.push(l(t,e,i,s));0!==d.length&&(0,f.default)(this,pi)[pi](t,!1,{boxes:d}),e.empty()}pointerup(t){const{isMac:e}=o.FeatureTest.platform;0!==t.button||t.ctrlKey&&e||t.target===this.div&&(0,f.default)(this,ri)[ri]&&((0,f.default)(this,ri)[ri]=!1,(0,f.default)(this,Qe)[Qe]?(0,f.default)(this,hi)[hi].getMode()!==o.AnnotationEditorType.STAMP?(0,f.default)(this,pi)[pi](t,!1):(0,f.default)(this,hi)[hi].unselectAll():(0,f.default)(this,Qe)[Qe]=!0)}pointerdown(t){if((0,f.default)(this,hi)[hi].getMode()===o.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),(0,f.default)(this,ri)[ri])return void((0,f.default)(this,ri)[ri]=!1);const{isMac:e}=o.FeatureTest.platform;if(0!==t.button||t.ctrlKey&&e)return;if(t.target!==this.div)return;(0,f.default)(this,ri)[ri]=!0;const i=(0,f.default)(this,hi)[hi].getActive();(0,f.default)(this,Qe)[Qe]=!i||i.isEmpty()}findNewParent(t,e,i){const s=(0,f.default)(this,hi)[hi].findParent(e,i);return null!==s&&s!==this&&(s.changeParent(t),!0)}destroy(){(0,f.default)(this,hi)[hi].getActive()?.parent===this&&((0,f.default)(this,hi)[hi].commitOrRemove(),(0,f.default)(this,hi)[hi].setActiveEditor(null)),(0,f.default)(this,si)[si]&&(clearTimeout((0,f.default)(this,si)[si]),(0,f.default)(this,si)[si]=null);for(const t of(0,f.default)(this,ni)[ni].values())(0,f.default)(this,Je)[Je]?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,(0,f.default)(this,ni)[ni].clear(),(0,f.default)(this,hi)[hi].removeLayer(this)}render({viewport:t}){this.viewport=t,(0,dt.setLayerDimensions)(this.div,t);for(const t of(0,f.default)(this,hi)[hi].getEditors(this.pageIndex))this.add(t);this.updateMode()}update({viewport:t}){(0,f.default)(this,hi)[hi].commitOrRemove();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,(0,dt.setLayerDimensions)(this.div,{rotation:i}),e!==i)for(const t of(0,f.default)(this,ni)[ni].values())t.rotate(i);this.updateMode()}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}}function vi(){return(0,f.default)(r,ci)[ci].get((0,f.default)(this,hi)[hi].getMode())}function yi(t){const e=(0,f.default)(this,ui)[ui];return e?new e.prototype.constructor(t):null}function Ai(t,e,i={}){const s=this.getNextId(),a=(0,f.default)(this,fi)[fi](Object.assign({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:(0,f.default)(this,hi)[hi],isCentered:e},i));return a&&this.add(a),a}function wi(){const{x:t,y:e,width:i,height:s}=this.div.getBoundingClientRect(),a=Math.max(0,t),n=Math.max(0,e),r=(a+Math.min(window.innerWidth,t+i))/2-t,o=(n+Math.min(window.innerHeight,e+s))/2-e,[l,d]=this.viewport.rotation%180==0?[r,o]:[o,r];return{offsetX:l,offsetY:d}}function _i(){(0,f.default)(this,oi)[oi]=!0;for(const t of(0,f.default)(this,ni)[ni].values())t.isEmpty()&&t.remove();(0,f.default)(this,oi)[oi]=!1}r=bi,bi._initialized=!1,Object.defineProperty(bi,ci,{writable:!0,value:new Map([M,Jt,He,it].map(t=>[t._editorType,t]))})},97:(t,e,i)=>{var s;i.d(e,{ColorPicker:()=>_});var a=i(266),n=i(812),r=i(473),o=(0,p.default)("boundKeyDown"),l=(0,p.default)("button"),d=(0,p.default)("buttonSwatch"),h=(0,p.default)("defaultColor"),c=(0,p.default)("dropdown"),u=(0,p.default)("dropdownWasFromKeyboard"),g=(0,p.default)("isMainColorPicker"),m=(0,p.default)("eventBus"),b=(0,p.default)("uiManager"),v=(0,p.default)("getDropdownRoot"),y=(0,p.default)("colorSelect"),A=(0,p.default)("keyDown"),w=(0,p.default)("openDropdown");class _{static get _keyboardManager(){return(0,a.shadow)(this,"_keyboardManager",new n.KeyboardManager([[["Escape","mac+Escape"],_.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],_.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],_.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],_.prototype._moveToPrevious],[["Home","mac+Home"],_.prototype._moveToBeginning],[["End","mac+End"],_.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){Object.defineProperty(this,w,{value:S}),Object.defineProperty(this,A,{value:P}),Object.defineProperty(this,y,{value:E}),Object.defineProperty(this,v,{value:x}),Object.defineProperty(this,o,{writable:!0,value:(0,f.default)(this,A)[A].bind(this)}),Object.defineProperty(this,l,{writable:!0,value:null}),Object.defineProperty(this,d,{writable:!0,value:null}),Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:null}),Object.defineProperty(this,u,{writable:!0,value:!1}),Object.defineProperty(this,g,{writable:!0,value:!1}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:null}),(0,f.default)(this,g)[g]=!t,(0,f.default)(this,b)[b]=t?._uiManager||e,(0,f.default)(this,m)[m]=(0,f.default)(this,b)[b]._eventBus,(0,f.default)(this,h)[h]=t?.color||(0,f.default)(this,b)[b]?.highlightColors.values().next().value||"#FFFF98"}renderButton(){const t=(0,f.default)(this,l)[l]=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0),t.addEventListener("click",(0,f.default)(this,w)[w].bind(this));const e=(0,f.default)(this,d)[d]=document.createElement("span");return e.className="swatch",e.style.backgroundColor=(0,f.default)(this,h)[h],t.append(e),t}renderMainDropdown(){const t=(0,f.default)(this,c)[c]=(0,f.default)(this,v)[v](a.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR);return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){const e=t.target.getAttribute("data-color");e&&(0,f.default)(this,y)[y](e,t)}_moveToNext(t){t.target!==(0,f.default)(this,l)[l]?t.target.nextSibling?.focus():(0,f.default)(this,c)[c].firstChild?.focus()}_moveToPrevious(t){t.target.previousSibling?.focus()}_moveToBeginning(){(0,f.default)(this,c)[c].firstChild?.focus()}_moveToEnd(){(0,f.default)(this,c)[c].lastChild?.focus()}hideDropdown(){(0,f.default)(this,c)[c]?.classList.add("hidden")}_hideDropdownFromKeyboard(){(0,f.default)(this,g)[g]||!(0,f.default)(this,c)[c]||(0,f.default)(this,c)[c].classList.contains("hidden")||(this.hideDropdown(),(0,f.default)(this,l)[l].removeEventListener("keydown",(0,f.default)(this,o)[o]),(0,f.default)(this,l)[l].focus({preventScroll:!0,focusVisible:(0,f.default)(this,u)[u]}))}updateColor(t){if((0,f.default)(this,d)[d]&&((0,f.default)(this,d)[d].style.backgroundColor=t),!(0,f.default)(this,c)[c])return;const e=(0,f.default)(this,b)[b].highlightColors.values();for(const i of(0,f.default)(this,c)[c].children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){(0,f.default)(this,l)[l]?.remove(),(0,f.default)(this,l)[l]=null,(0,f.default)(this,d)[d]=null,(0,f.default)(this,c)[c]?.remove(),(0,f.default)(this,c)[c]=null}}function x(t){const e=document.createElement("div");e.addEventListener("contextmenu",r.noContextMenu),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of(0,f.default)(this,b)[b].highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",s),a.title=i,a.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${i}`);const n=document.createElement("span");a.append(n),n.className="swatch",n.style.backgroundColor=s,a.setAttribute("aria-selected",s===(0,f.default)(this,h)[h]),a.addEventListener("click",(0,f.default)(this,y)[y].bind(this,t,s)),e.append(a)}return e.addEventListener("keydown",(0,f.default)(this,o)[o]),e}function E(t,e,i){i.stopPropagation(),(0,f.default)(this,m)[m].dispatch("switchannotationeditorparams",{source:this,type:t,value:e})}function P(t){s._keyboardManager.exec(this,t)}function S(t){if((0,f.default)(this,c)[c]&&!(0,f.default)(this,c)[c].classList.contains("hidden"))return void this.hideDropdown();if((0,f.default)(this,l)[l].addEventListener("keydown",(0,f.default)(this,o)[o]),(0,f.default)(this,u)[u]=0===t.detail,(0,f.default)(this,c)[c])return void(0,f.default)(this,c)[c].classList.remove("hidden");const e=(0,f.default)(this,c)[c]=(0,f.default)(this,v)[v](a.AnnotationEditorParamsType.HIGHLIGHT_COLOR);(0,f.default)(this,l)[l].append(e)}s=_},115:(t,e,i)=>{var s,a;i.d(e,{AnnotationEditor:()=>ft});var n=i(812),r=i(266),o=i(473),l=(0,p.default)("altText"),d=(0,p.default)("altTextDecorative"),h=(0,p.default)("altTextButton"),c=(0,p.default)("altTextTooltip"),u=(0,p.default)("altTextTooltipTimeout"),g=(0,p.default)("altTextWasFromKeyBoard"),m=(0,p.default)("editor"),b=(0,p.default)("setState");class v{constructor(t){Object.defineProperty(this,b,{value:y}),Object.defineProperty(this,l,{writable:!0,value:""}),Object.defineProperty(this,d,{writable:!0,value:!1}),Object.defineProperty(this,h,{writable:!0,value:null}),Object.defineProperty(this,c,{writable:!0,value:null}),Object.defineProperty(this,u,{writable:!0,value:null}),Object.defineProperty(this,g,{writable:!0,value:!1}),Object.defineProperty(this,m,{writable:!0,value:null}),(0,f.default)(this,m)[m]=t}static initialize(t){v._l10nPromise||=t}async render(){const t=(0,f.default)(this,h)[h]=document.createElement("button");t.className="altText";const e=await v._l10nPromise.get("pdfjs-editor-alt-text-button-label");t.textContent=e,t.setAttribute("aria-label",e),t.tabIndex="0",t.addEventListener("contextmenu",o.noContextMenu),t.addEventListener("pointerdown",t=>t.stopPropagation());const i=t=>{t.preventDefault(),(0,f.default)(this,m)[m]._uiManager.editAltText((0,f.default)(this,m)[m])};return t.addEventListener("click",i,{capture:!0}),t.addEventListener("keydown",e=>{e.target===t&&"Enter"===e.key&&((0,f.default)(this,g)[g]=!0,i(e))}),await(0,f.default)(this,b)[b](),t}finish(){(0,f.default)(this,h)[h]&&((0,f.default)(this,h)[h].focus({focusVisible:(0,f.default)(this,g)[g]}),(0,f.default)(this,g)[g]=!1)}get data(){return{altText:(0,f.default)(this,l)[l],decorative:(0,f.default)(this,d)[d]}}set data({altText:t,decorative:e}){(0,f.default)(this,l)[l]===t&&(0,f.default)(this,d)[d]===e||((0,f.default)(this,l)[l]=t,(0,f.default)(this,d)[d]=e,(0,f.default)(this,b)[b]())}toggle(t=!1){(0,f.default)(this,h)[h]&&(!t&&(0,f.default)(this,u)[u]&&(clearTimeout((0,f.default)(this,u)[u]),(0,f.default)(this,u)[u]=null),(0,f.default)(this,h)[h].disabled=!t)}destroy(){(0,f.default)(this,h)[h]?.remove(),(0,f.default)(this,h)[h]=null,(0,f.default)(this,c)[c]=null}}async function y(){const t=(0,f.default)(this,h)[h];if(!t)return;if(!(0,f.default)(this,l)[l]&&!(0,f.default)(this,d)[d])return t.classList.remove("done"),void(0,f.default)(this,c)[c]?.remove();t.classList.add("done"),s._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(e=>{t.setAttribute("aria-label",e)});let e=(0,f.default)(this,c)[c];if(!e){(0,f.default)(this,c)[c]=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip");const i=e.id=`alt-text-tooltip-${(0,f.default)(this,m)[m].id}`;t.setAttribute("aria-describedby",i);const s=100;t.addEventListener("mouseenter",()=>{(0,f.default)(this,u)[u]=setTimeout(()=>{(0,f.default)(this,u)[u]=null,(0,f.default)(this,c)[c].classList.add("show"),(0,f.default)(this,m)[m]._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:(0,f.default)(this,m)[m].editorType,data:{action:"alt_text_tooltip"}}})},s)}),t.addEventListener("mouseleave",()=>{(0,f.default)(this,u)[u]&&(clearTimeout((0,f.default)(this,u)[u]),(0,f.default)(this,u)[u]=null),(0,f.default)(this,c)[c]?.classList.remove("show")})}e.innerText=(0,f.default)(this,d)[d]?await s._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):(0,f.default)(this,l)[l],e.parentNode||t.append(e);const i=(0,f.default)(this,m)[m].getImageForAltText();i?.setAttribute("aria-describedby",e.id)}s=v,v._l10nPromise=null;var A=(0,p.default)("toolbar"),w=(0,p.default)("colorPicker"),_=(0,p.default)("editor"),x=(0,p.default)("buttons"),E=(0,p.default)("pointerDown"),P=(0,p.default)("focusIn"),S=(0,p.default)("focusOut"),C=(0,p.default)("addListenersToElement"),T=(0,p.default)("addDeleteButton"),M=(0,p.default)("divider");class k{constructor(t){Object.defineProperty(this,M,{get:D,set:void 0}),Object.defineProperty(this,T,{value:I}),Object.defineProperty(this,C,{value:F}),Object.defineProperty(this,S,{value:O}),Object.defineProperty(this,P,{value:R}),Object.defineProperty(this,A,{writable:!0,value:null}),Object.defineProperty(this,w,{writable:!0,value:null}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:null}),(0,f.default)(this,_)[_]=t}render(){const t=(0,f.default)(this,A)[A]=document.createElement("div");t.className="editToolbar",t.addEventListener("contextmenu",o.noContextMenu),t.addEventListener("pointerdown",(0,f.default)(k,E)[E]);const e=(0,f.default)(this,x)[x]=document.createElement("div");e.className="buttons",t.append(e);const i=(0,f.default)(this,_)[_].toolbarPosition;if(i){const{style:e}=t,s="ltr"===(0,f.default)(this,_)[_]._uiManager.direction?1-i[0]:i[0];e.insetInlineEnd=100*s+"%",e.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return(0,f.default)(this,T)[T](),t}hide(){(0,f.default)(this,A)[A].classList.add("hidden"),(0,f.default)(this,w)[w]?.hideDropdown()}show(){(0,f.default)(this,A)[A].classList.remove("hidden")}addAltTextButton(t){(0,f.default)(this,C)[C](t),(0,f.default)(this,x)[x].prepend(t,(0,f.default)(this,M)[M])}addColorPicker(t){(0,f.default)(this,w)[w]=t;const e=t.renderButton();(0,f.default)(this,C)[C](e),(0,f.default)(this,x)[x].prepend(e,(0,f.default)(this,M)[M])}remove(){(0,f.default)(this,A)[A].remove(),(0,f.default)(this,w)[w]?.destroy(),(0,f.default)(this,w)[w]=null}}function R(t){(0,f.default)(this,_)[_]._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()}function O(t){(0,f.default)(this,_)[_]._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()}function F(t){t.addEventListener("focusin",(0,f.default)(this,P)[P].bind(this),{capture:!0}),t.addEventListener("focusout",(0,f.default)(this,S)[S].bind(this),{capture:!0}),t.addEventListener("contextmenu",o.noContextMenu)}function I(){const t=document.createElement("button");t.className="delete",t.tabIndex=0,t.setAttribute("data-l10n-id",`pdfjs-editor-remove-${(0,f.default)(this,_)[_].editorType}-button`),(0,f.default)(this,C)[C](t),t.addEventListener("click",t=>{(0,f.default)(this,_)[_]._uiManager.delete()}),(0,f.default)(this,x)[x].append(t)}function D(){const t=document.createElement("div");return t.className="divider",t}Object.defineProperty(k,E,{value:function(t){t.stopPropagation()}});var L=(0,p.default)("allResizerDivs"),j=(0,p.default)("altText"),N=(0,p.default)("keepAspectRatio"),B=(0,p.default)("resizersDiv"),U=(0,p.default)("savedDimensions"),H=(0,p.default)("boundFocusin"),z=(0,p.default)("boundFocusout"),V=(0,p.default)("editToolbar"),q=(0,p.default)("focusedResizerName"),G=(0,p.default)("hasBeenClicked"),$=(0,p.default)("isEditing"),W=(0,p.default)("isInEditMode"),X=(0,p.default)("isResizerEnabledForKeyboard"),K=(0,p.default)("moveInDOMTimeout"),Y=(0,p.default)("isDraggable"),J=(0,p.default)("zIndex"),Q=(0,p.default)("translate"),Z=(0,p.default)("getBaseTranslation"),tt=(0,p.default)("rotatePoint"),et=(0,p.default)("getRotationMatrix"),it=(0,p.default)("createResizers"),st=(0,p.default)("resizerPointerdown"),at=(0,p.default)("addResizeToUndoStack"),nt=(0,p.default)("resizerPointermove"),rt=(0,p.default)("selectOnPointerEvent"),ot=(0,p.default)("setUpDragSession"),lt=(0,p.default)("resizerKeydown"),dt=(0,p.default)("resizerBlur"),ht=(0,p.default)("resizerFocus"),ct=(0,p.default)("setResizerTabIndex"),ut=(0,p.default)("stopResizing");class ft{static get _resizerKeyboardManager(){const t=ft.prototype._resizeWithKeyboard,e=n.AnnotationEditorUIManager.TRANSLATE_SMALL,i=n.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,r.shadow)(this,"_resizerKeyboardManager",new n.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],ft.prototype._stopResizingWithKeyboard]]))}constructor(t){Object.defineProperty(this,ut,{value:Ct}),Object.defineProperty(this,ct,{value:St}),Object.defineProperty(this,ht,{value:Pt}),Object.defineProperty(this,dt,{value:Et}),Object.defineProperty(this,lt,{value:xt}),Object.defineProperty(this,ot,{value:_t}),Object.defineProperty(this,rt,{value:wt}),Object.defineProperty(this,nt,{value:At}),Object.defineProperty(this,at,{value:yt}),Object.defineProperty(this,st,{value:vt}),Object.defineProperty(this,it,{value:bt}),Object.defineProperty(this,et,{value:mt}),Object.defineProperty(this,Z,{value:gt}),Object.defineProperty(this,Q,{value:pt}),Object.defineProperty(this,L,{writable:!0,value:null}),Object.defineProperty(this,j,{writable:!0,value:null}),Object.defineProperty(this,N,{writable:!0,value:!1}),Object.defineProperty(this,B,{writable:!0,value:null}),Object.defineProperty(this,U,{writable:!0,value:null}),Object.defineProperty(this,H,{writable:!0,value:this.focusin.bind(this)}),Object.defineProperty(this,z,{writable:!0,value:this.focusout.bind(this)}),Object.defineProperty(this,V,{writable:!0,value:null}),Object.defineProperty(this,q,{writable:!0,value:""}),Object.defineProperty(this,G,{writable:!0,value:!1}),Object.defineProperty(this,$,{writable:!0,value:!1}),Object.defineProperty(this,W,{writable:!0,value:!1}),Object.defineProperty(this,X,{writable:!0,value:!1}),Object.defineProperty(this,K,{writable:!0,value:null}),this._initialOptions=Object.create(null),this._uiManager=null,this._focusEventsAllowed=!0,this._l10nPromise=null,Object.defineProperty(this,Y,{writable:!0,value:!1}),Object.defineProperty(this,J,{writable:!0,value:ft._zIndex++}),this.constructor===ft&&(0,r.unreachable)("Cannot initialize AnnotationEditor."),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:n}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[a,n];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,r.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Tt({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e=null){if(ft._l10nPromise||=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(e=>[e,t.get(e.replaceAll(/([A-Z])/g,t=>`-${t.toLowerCase()}`))])),e?.strings)for(const i of e.strings)ft._l10nPromise.set(i,t.get(i));if(-1!==ft._borderLineWidth)return;const i=getComputedStyle(document.documentElement);ft._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){(0,r.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return(0,f.default)(this,Y)[Y]}set _isDraggable(t){(0,f.default)(this,Y)[Y]=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(2*t),this.y+=this.width*t/(2*e);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(2*t),this.y-=this.width*t/(2*e);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=(0,f.default)(this,J)[J]}setParent(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(0,f.default)(this,ut)[ut](),this.parent=t}focusin(t){this._focusEventsAllowed&&((0,f.default)(this,G)[G]?(0,f.default)(this,G)[G]=!1:this.parent.setSelected(this))}focusout(t){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const e=t.relatedTarget;e?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[a,n]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/a,this.y=(e+s)/n,this.fixAndSetPosition()}translate(t,e){(0,f.default)(this,Q)[Q](this.parentDimensions,t,e)}translateInPage(t,e){(0,f.default)(this,Q)[Q](this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){const[i,s]=this.parentDimensions;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:t,y:e}=this.div.getBoundingClientRect();this.parent.findNewParent(this,t,e)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:n}=this;const[r,o]=(0,f.default)(this,Z)[Z]();a+=r,n+=o,this.div.style.left=`${(100*a).toFixed(2)}%`,this.div.style.top=`${(100*n).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:s,y:a,width:n,height:r}=this;switch(n*=e,r*=i,s*=e,a*=i,t){case 0:s=Math.max(0,Math.min(e-n,s)),a=Math.max(0,Math.min(i-r,a));break;case 90:s=Math.max(0,Math.min(e-r,s)),a=Math.min(i,Math.max(n,a));break;case 180:s=Math.min(e,Math.max(n,s)),a=Math.min(i,Math.max(r,a));break;case 270:s=Math.min(e,Math.max(r,s)),a=Math.max(0,Math.min(i-n,a))}this.x=s/=e,this.y=a/=i;const[o,l]=(0,f.default)(this,Z)[Z]();s+=o,a+=l;const{style:d}=this.div;d.left=`${(100*s).toFixed(2)}%`,d.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){return(0,f.default)(ft,tt)[tt](t,e,this.parentRotation)}pageTranslationToScreen(t,e){return(0,f.default)(ft,tt)[tt](t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this,s=e*t,a=i*t;return r.FeatureTest.isCSSRoundSupported?[Math.round(s),Math.round(a)]:[s,a]}setDims(t,e){const[i,s]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,(0,f.default)(this,N)[N]||(this.div.style.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,s=i.endsWith("%"),a=!(0,f.default)(this,N)[N]&&e.endsWith("%");if(s&&a)return;const[n,r]=this.parentDimensions;s||(t.width=`${(100*parseFloat(i)/n).toFixed(2)}%`),(0,f.default)(this,N)[N]||a||(t.height=`${(100*parseFloat(e)/r).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){(0,f.default)(this,j)[j]?.finish()}async addEditToolbar(){return(0,f.default)(this,V)[V]||(0,f.default)(this,W)[W]||((0,f.default)(this,V)[V]=new k(this),this.div.append((0,f.default)(this,V)[V].render()),(0,f.default)(this,j)[j]&&(0,f.default)(this,V)[V].addAltTextButton(await(0,f.default)(this,j)[j].render())),(0,f.default)(this,V)[V]}removeEditToolbar(){(0,f.default)(this,V)[V]&&((0,f.default)(this,V)[V].remove(),(0,f.default)(this,V)[V]=null,(0,f.default)(this,j)[j]?.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){(0,f.default)(this,j)[j]||(v.initialize(ft._l10nPromise),(0,f.default)(this,j)[j]=new v(this),await this.addEditToolbar())}get altTextData(){return(0,f.default)(this,j)[j]?.data}set altTextData(t){(0,f.default)(this,j)[j]&&((0,f.default)(this,j)[j].data=t)}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",(0,f.default)(this,H)[H]),this.div.addEventListener("focusout",(0,f.default)(this,z)[z]);const[t,e]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=r.FeatureTest.platform;0!==t.button||t.ctrlKey&&e?t.preventDefault():((0,f.default)(this,G)[G]=!0,this._isDraggable?(0,f.default)(this,ot)[ot](t):(0,f.default)(this,rt)[rt](t))}moveInDOM(){(0,f.default)(this,K)[K]&&clearTimeout((0,f.default)(this,K)[K]),(0,f.default)(this,K)[K]=setTimeout(()=>{(0,f.default)(this,K)[K]=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const s=this.parentScale,[a,n]=this.pageDimensions,[r,o]=this.pageTranslation,l=t/s,d=e/s,h=this.x*a,c=this.y*n,u=this.width*a,f=this.height*n;switch(i){case 0:return[h+l+r,n-c-d-f+o,h+l+u+r,n-c-d+o];case 90:return[h+d+r,n-c+l+o,h+d+f+r,n-c+l+u+o];case 180:return[h-l-u+r,n-c+d+o,h-l+r,n-c+d+f+o];case 270:return[h-d-f+r,n-c-l-u+o,h-d+r,n-c-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,a,n]=t,r=a-i,o=n-s;switch(this.rotation){case 0:return[i,e-n,r,o];case 90:return[i,e-s,o,r];case 180:return[a,e-s,r,o];case 270:return[a,e-n,o,r];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){(0,f.default)(this,W)[W]=!0}disableEditMode(){(0,f.default)(this,W)[W]=!1}isInEditMode(){return(0,f.default)(this,W)[W]}shouldGetKeyboardEvents(){return(0,f.default)(this,X)[X]}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",(0,f.default)(this,H)[H]),this.div?.addEventListener("focusout",(0,f.default)(this,z)[z])}rotate(t){}serialize(t=!1,e=null){(0,r.unreachable)("An editor must be serializable")}static deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});s.rotation=t.rotation;const[a,n]=s.pageDimensions,[r,o,l,d]=s.getRectInCurrentCoords(t.rect,n);return s.x=r/a,s.y=o/n,s.width=l/a,s.height=d/n,s}remove(){this.div.removeEventListener("focusin",(0,f.default)(this,H)[H]),this.div.removeEventListener("focusout",(0,f.default)(this,z)[z]),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(0,f.default)(this,K)[K]&&(clearTimeout((0,f.default)(this,K)[K]),(0,f.default)(this,K)[K]=null),(0,f.default)(this,ut)[ut](),this.removeEditToolbar()}get isResizable(){return!1}makeResizable(){this.isResizable&&((0,f.default)(this,it)[it](),(0,f.default)(this,B)[B].classList.remove("hidden"),(0,n.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||"Enter"!==t.key)return;this._uiManager.setSelected(this),(0,f.default)(this,U)[U]={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=(0,f.default)(this,B)[B].children;if(!(0,f.default)(this,L)[L]){(0,f.default)(this,L)[L]=Array.from(e);const t=(0,f.default)(this,lt)[lt].bind(this),i=(0,f.default)(this,dt)[dt].bind(this);for(const e of(0,f.default)(this,L)[L]){const s=e.getAttribute("data-resizer-name");e.setAttribute("role","spinbutton"),e.addEventListener("keydown",t),e.addEventListener("blur",i),e.addEventListener("focus",(0,f.default)(this,ht)[ht].bind(this,s)),ft._l10nPromise.get(`pdfjs-editor-resizer-label-${s}`).then(t=>e.setAttribute("aria-label",t))}}const i=(0,f.default)(this,L)[L][0];let s=0;for(const t of e){if(t===i)break;s++}const a=(360-this.rotation+this.parentRotation)%360/90*((0,f.default)(this,L)[L].length/4);if(a!==s){if(a<s)for(let t=0;t<s-a;t++)(0,f.default)(this,B)[B].append((0,f.default)(this,B)[B].firstChild);else if(a>s)for(let t=0;t<a-s;t++)(0,f.default)(this,B)[B].firstChild.before((0,f.default)(this,B)[B].lastChild);let t=0;for(const i of e){const e=(0,f.default)(this,L)[L][t++].getAttribute("data-resizer-name");ft._l10nPromise.get(`pdfjs-editor-resizer-label-${e}`).then(t=>i.setAttribute("aria-label",t))}}(0,f.default)(this,ct)[ct](0),(0,f.default)(this,X)[X]=!0,(0,f.default)(this,B)[B].firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){(0,f.default)(this,X)[X]&&(0,f.default)(this,nt)[nt]((0,f.default)(this,q)[q],{movementX:t,movementY:e})}_stopResizingWithKeyboard(){(0,f.default)(this,ut)[ut](),this.div.focus()}select(){this.makeResizable(),this.div?.classList.add("selectedEditor"),(0,f.default)(this,V)[V]?(0,f.default)(this,V)[V]?.show():this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&(0,f.default)(this,V)[V]?.show()})}unselect(){(0,f.default)(this,B)[B]?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus(),(0,f.default)(this,V)[V]?.hide()}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return(0,f.default)(this,$)[$]}set isEditing(t){(0,f.default)(this,$)[$]=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){(0,f.default)(this,N)[N]=!0;const i=t/e,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}}function pt([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this.fixAndSetPosition()}function gt(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=a,s=i/t,n=i/e;switch(this.rotation){case 90:return[-s,n];case 180:return[s,n];case 270:return[s,-n];default:return[-s,-n]}}function mt(t){switch(t){case 90:{const[t,e]=this.pageDimensions;return[0,-t/e,e/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,e]=this.pageDimensions;return[0,t/e,-e/t,0]}default:return[1,0,0,1]}}function bt(){if((0,f.default)(this,B)[B])return;(0,f.default)(this,B)[B]=document.createElement("div"),(0,f.default)(this,B)[B].classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const e of t){const t=document.createElement("div");(0,f.default)(this,B)[B].append(t),t.classList.add("resizer",e),t.setAttribute("data-resizer-name",e),t.addEventListener("pointerdown",(0,f.default)(this,st)[st].bind(this,e)),t.addEventListener("contextmenu",o.noContextMenu),t.tabIndex=-1}this.div.prepend((0,f.default)(this,B)[B])}function vt(t,e){e.preventDefault();const{isMac:i}=r.FeatureTest.platform;if(0!==e.button||e.ctrlKey&&i)return;(0,f.default)(this,j)[j]?.toggle(!1);const s=(0,f.default)(this,nt)[nt].bind(this,t),a=this._isDraggable;this._isDraggable=!1;const n={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",s,n);const o=this.x,l=this.y,d=this.width,h=this.height,c=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const p=()=>{this.parent.togglePointerEvents(!0),(0,f.default)(this,j)[j]?.toggle(!0),this._isDraggable=a,window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),window.removeEventListener("pointermove",s,n),this.parent.div.style.cursor=c,this.div.style.cursor=u,(0,f.default)(this,at)[at](o,l,d,h)};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}function yt(t,e,i,s){const a=this.x,n=this.y,r=this.width,o=this.height;a===t&&n===e&&r===i&&o===s||this.addCommands({cmd:()=>{this.width=r,this.height=o,this.x=a,this.y=n;const[t,e]=this.parentDimensions;this.setDims(t*r,e*o),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=s,this.x=t,this.y=e;const[a,n]=this.parentDimensions;this.setDims(a*i,n*s),this.fixAndSetPosition()},mustExec:!0})}function At(t,e){const[i,s]=this.parentDimensions,n=this.x,r=this.y,o=this.width,l=this.height,d=a.MIN_SIZE/i,h=a.MIN_SIZE/s,c=t=>Math.round(1e4*t)/1e4,u=(0,f.default)(this,et)[et](this.rotation),p=(t,e)=>[u[0]*t+u[2]*e,u[1]*t+u[3]*e],g=(0,f.default)(this,et)[et](360-this.rotation);let m,b,v=!1,y=!1;switch(t){case"topLeft":v=!0,m=(t,e)=>[0,0],b=(t,e)=>[t,e];break;case"topMiddle":m=(t,e)=>[t/2,0],b=(t,e)=>[t/2,e];break;case"topRight":v=!0,m=(t,e)=>[t,0],b=(t,e)=>[0,e];break;case"middleRight":y=!0,m=(t,e)=>[t,e/2],b=(t,e)=>[0,e/2];break;case"bottomRight":v=!0,m=(t,e)=>[t,e],b=(t,e)=>[0,0];break;case"bottomMiddle":m=(t,e)=>[t/2,e],b=(t,e)=>[t/2,0];break;case"bottomLeft":v=!0,m=(t,e)=>[0,e],b=(t,e)=>[t,0];break;case"middleLeft":y=!0,m=(t,e)=>[0,e/2],b=(t,e)=>[t,e/2]}const A=m(o,l),w=b(o,l);let _=p(...w);const x=c(n+_[0]),E=c(r+_[1]);let P=1,S=1,[C,T]=this.screenToPageTranslation(e.movementX,e.movementY);var M,k;if([C,T]=(M=C/i,k=T/s,[g[0]*M+g[2]*k,g[1]*M+g[3]*k]),v){const t=Math.hypot(o,l);P=S=Math.max(Math.min(Math.hypot(w[0]-A[0]-C,w[1]-A[1]-T)/t,1/o,1/l),d/o,h/l)}else y?P=Math.max(d,Math.min(1,Math.abs(w[0]-A[0]-C)))/o:S=Math.max(h,Math.min(1,Math.abs(w[1]-A[1]-T)))/l;const R=c(o*P),O=c(l*S);_=p(...b(R,O));const F=x-_[0],I=E-_[1];this.width=R,this.height=O,this.x=F,this.y=I,this.setDims(i*R,s*O),this.fixAndSetPosition()}function wt(t){const{isMac:e}=r.FeatureTest.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}function _t(t){const e=this._uiManager.isSelected(this);let i,s;this._uiManager.setUpDragSession(),e&&(i={passive:!0,capture:!0},s=t=>{const[e,i]=this.screenToPageTranslation(t.movementX,t.movementY);this._uiManager.dragSelectedEditors(e,i)},window.addEventListener("pointermove",s,i));const a=()=>{window.removeEventListener("pointerup",a),window.removeEventListener("blur",a),e&&window.removeEventListener("pointermove",s,i),(0,f.default)(this,G)[G]=!1,this._uiManager.endDragSession()||(0,f.default)(this,rt)[rt](t)};window.addEventListener("pointerup",a),window.addEventListener("blur",a)}function xt(t){a._resizerKeyboardManager.exec(this,t)}function Et(t){(0,f.default)(this,X)[X]&&t.relatedTarget?.parentNode!==(0,f.default)(this,B)[B]&&(0,f.default)(this,ut)[ut]()}function Pt(t){(0,f.default)(this,q)[q]=(0,f.default)(this,X)[X]?t:""}function St(t){if((0,f.default)(this,L)[L])for(const e of(0,f.default)(this,L)[L])e.tabIndex=t}function Ct(){if((0,f.default)(this,X)[X]=!1,(0,f.default)(this,ct)[ct](-1),(0,f.default)(this,U)[U]){const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=(0,f.default)(this,U)[U];(0,f.default)(this,at)[at](t,e,i,s),(0,f.default)(this,U)[U]=null}}a=ft,Object.defineProperty(ft,tt,{value:function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}}),ft._borderLineWidth=-1,ft._colorManager=new n.ColorManager,ft._zIndex=1;class Tt extends ft{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},405:(t,e,i)=>{i.d(e,{Outliner:()=>c});var s=(0,p.default)("box"),a=(0,p.default)("verticalEdges"),n=(0,p.default)("intervals"),r=(0,p.default)("getOutlines"),o=(0,p.default)("binarySearch"),l=(0,p.default)("insert"),d=(0,p.default)("remove"),h=(0,p.default)("breakEdge");class c{constructor(t,e=0,i=0,c=!0){Object.defineProperty(this,h,{value:v}),Object.defineProperty(this,d,{value:b}),Object.defineProperty(this,l,{value:m}),Object.defineProperty(this,o,{value:g}),Object.defineProperty(this,r,{value:u}),Object.defineProperty(this,s,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:[]}),Object.defineProperty(this,n,{writable:!0,value:[]});let p=1/0,y=-1/0,A=1/0,w=-1/0;const _=9999999999999999e-20;for(const{x:i,y:s,width:n,height:r}of t){const t=Math.floor((i-e)/_)*_,o=Math.ceil((i+n+e)/_)*_,l=Math.floor((s-e)/_)*_,d=Math.ceil((s+r+e)/_)*_,h=[t,l,d,!0],c=[o,l,d,!1];(0,f.default)(this,a)[a].push(h,c),p=Math.min(p,t),y=Math.max(y,o),A=Math.min(A,l),w=Math.max(w,d)}const x=y-p+2*i,E=w-A+2*i,P=p-i,S=A-i,C=(0,f.default)(this,a)[a].at(c?-1:-2),T=[C[0],C[2]];for(const t of(0,f.default)(this,a)[a]){const[e,i,s]=t;t[0]=(e-P)/x,t[1]=(i-S)/E,t[2]=(s-S)/E}(0,f.default)(this,s)[s]={x:P,y:S,width:x,height:E,lastPoint:T}}getOutlines(){(0,f.default)(this,a)[a].sort((t,e)=>t[0]-e[0]||t[1]-e[1]||t[2]-e[2]);const t=[];for(const e of(0,f.default)(this,a)[a])e[3]?(t.push(...(0,f.default)(this,h)[h](e)),(0,f.default)(this,l)[l](e)):((0,f.default)(this,d)[d](e),t.push(...(0,f.default)(this,h)[h](e)));return(0,f.default)(this,r)[r](t)}}function u(t){const e=[],i=new Set;for(const i of t){const[t,s,a]=i;e.push([t,s,i],[t,a,i])}e.sort((t,e)=>t[1]-e[1]||t[0]-e[0]);for(let t=0,s=e.length;t<s;t+=2){const s=e[t][2],a=e[t+1][2];s.push(a),a.push(s),i.add(s),i.add(a)}const a=[];let n;for(;i.size>0;){const t=i.values().next().value;let[e,s,r,o,l]=t;i.delete(t);let d=e,h=s;for(n=[e,r],a.push(n);;){let t;if(i.has(o))t=o;else{if(!i.has(l))break;t=l}i.delete(t),[e,s,r,o,l]=t,d!==e&&(n.push(d,h,e,h===s?s:r),d=e),h=h===s?r:s}n.push(d,h)}return{outlines:a,box:(0,f.default)(this,s)[s]}}function g(t){const e=(0,f.default)(this,n)[n];let i=0,s=e.length-1;for(;i<=s;){const a=i+s>>1,n=e[a][0];if(n===t)return a;n<t?i=a+1:s=a-1}return s+1}function m([,t,e]){const i=(0,f.default)(this,o)[o](t);(0,f.default)(this,n)[n].splice(i,0,[t,e])}function b([,t,e]){const i=(0,f.default)(this,o)[o](t);for(let s=i;s<(0,f.default)(this,n)[n].length;s++){const[i,a]=(0,f.default)(this,n)[n][s];if(i!==t)break;if(i===t&&a===e)return void(0,f.default)(this,n)[n].splice(s,1)}for(let s=i-1;s>=0;s--){const[i,a]=(0,f.default)(this,n)[n][s];if(i!==t)break;if(i===t&&a===e)return void(0,f.default)(this,n)[n].splice(s,1)}}function v(t){const[e,i,s]=t,a=[[e,i,s]],r=(0,f.default)(this,o)[o](s);for(let t=0;t<r;t++){const[i,s]=(0,f.default)(this,n)[n][t];for(let t=0,n=a.length;t<n;t++){const[,r,o]=a[t];if(!(s<=r||o<=i))if(r>=i)if(o>s)a[t][1]=s;else{if(1===n)return[];a.splice(t,1),t--,n--}else a[t][2]=i,o>s&&a.push([e,s,o])}}return a}},812:(t,e,i)=>{var s;i.d(e,{AnnotationEditorUIManager:()=>vt,ColorManager:()=>w,KeyboardManager:()=>y,bindEvents:()=>r,opacityToHex:()=>o});var a=i(266),n=i(473);function r(t,e,i){for(const s of i)e.addEventListener(s,t[s].bind(t))}function o(t){return Math.round(Math.min(255,Math.max(1,255*t))).toString(16).padStart(2,"0")}class l{#u=0;getId(){return`${a.AnnotationEditorPrefix}${this.#u++}`}}var d=(0,p.default)("baseId"),h=(0,p.default)("id"),c=(0,p.default)("cache"),u=(0,p.default)("get");class g{constructor(){Object.defineProperty(this,u,{value:m}),Object.defineProperty(this,d,{writable:!0,value:(0,a.getUuid)()}),Object.defineProperty(this,h,{writable:!0,value:0}),Object.defineProperty(this,c,{writable:!0,value:null})}static get _isSVGFittingCanvas(){const t=new OffscreenCanvas(1,3).getContext("2d"),e=new Image;e.src="data:image/svg+xml;charset=UTF-8,<svg viewBox=\"0 0 1 1\" width=\"1\" height=\"1\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"1\" height=\"1\" style=\"fill:red;\"/></svg>";const i=e.decode().then(()=>(t.drawImage(e,0,0,1,1,0,0,1,3),0===new Uint32Array(t.getImageData(0,0,1,1).data.buffer)[0]));return(0,a.shadow)(this,"_isSVGFittingCanvas",i)}async getFromFile(t){const{lastModified:e,name:i,size:s,type:a}=t;return(0,f.default)(this,u)[u](`${e}_${i}_${s}_${a}`,t)}async getFromUrl(t){return(0,f.default)(this,u)[u](t,t)}async getFromId(t){(0,f.default)(this,c)[c]||=new Map;const e=(0,f.default)(this,c)[c].get(t);return e?e.bitmap?(e.refCounter+=1,e):e.file?this.getFromFile(e.file):this.getFromUrl(e.url):null}getSvgUrl(t){const e=(0,f.default)(this,c)[c].get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){(0,f.default)(this,c)[c]||=new Map;const e=(0,f.default)(this,c)[c].get(t);e&&(e.refCounter-=1,0===e.refCounter&&(e.bitmap=null))}isValidId(t){return t.startsWith(`image_${(0,f.default)(this,d)[d]}_`)}}async function m(t,e){(0,f.default)(this,c)[c]||=new Map;let i=(0,f.default)(this,c)[c].get(t);if(null===i)return null;if(i?.bitmap)return i.refCounter+=1,i;try{let t;if(i||={bitmap:null,id:`image_${(0,f.default)(this,d)[d]}_${(0,f.default)(this,h)[h]++}`,refCounter:0,isSvg:!1},"string"==typeof e?(i.url=e,t=await(0,n.fetchData)(e,"blob")):t=i.file=e,"image/svg+xml"===t.type){const e=s._isSVGFittingCanvas,a=new FileReader,n=new Image,r=new Promise((t,s)=>{n.onload=()=>{i.bitmap=n,i.isSvg=!0,t()},a.onload=async()=>{const t=i.svgUrl=a.result;n.src=await e?`${t}#svgView(preserveAspectRatio(none))`:t},n.onerror=a.onerror=s});a.readAsDataURL(t),await r}else i.bitmap=await createImageBitmap(t);i.refCounter=1}catch(t){console.error(t),i=null}return(0,f.default)(this,c)[c].set(t,i),i&&(0,f.default)(this,c)[c].set(i.id,i),i}s=g;class b{#f=[];#p=!1;#g;#m=-1;constructor(t=128){this.#g=t}add({cmd:t,undo:e,mustExec:i,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:n=!1}){if(i&&t(),this.#p)return;const r={cmd:t,undo:e,type:s};if(-1===this.#m)return this.#f.length>0&&(this.#f.length=0),this.#m=0,void this.#f.push(r);if(a&&this.#f[this.#m].type===s)return n&&(r.undo=this.#f[this.#m].undo),void(this.#f[this.#m]=r);const o=this.#m+1;o===this.#g?this.#f.splice(0,1):(this.#m=o,o<this.#f.length&&this.#f.splice(o)),this.#f.push(r)}undo(){-1!==this.#m&&(this.#p=!0,this.#f[this.#m].undo(),this.#p=!1,this.#m-=1)}redo(){this.#m<this.#f.length-1&&(this.#m+=1,this.#p=!0,this.#f[this.#m].cmd(),this.#p=!1)}hasSomethingToUndo(){return-1!==this.#m}hasSomethingToRedo(){return this.#m<this.#f.length-1}destroy(){this.#f=null}}var v=(0,p.default)("serialize");class y{constructor(t){Object.defineProperty(this,v,{value:A}),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=a.FeatureTest.platform;for(const[i,s,a={}]of t)for(const t of i){const i=t.startsWith("mac+");e&&i?(this.callbacks.set(t.slice(4),{callback:s,options:a}),this.allKeys.add(t.split("+").at(-1))):e||i||(this.callbacks.set(t,{callback:s,options:a}),this.allKeys.add(t.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get((0,f.default)(this,v)[v](e));if(!i)return;const{callback:s,options:{bubbles:a=!1,args:n=[],checker:r=null}}=i;r&&!r(t,e)||(s.bind(t,...n,e)(),a||(e.stopPropagation(),e.preventDefault()))}}function A(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}class w{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return(0,n.getColorValues)(t),(0,a.shadow)(this,"_colors",t)}convert(t){const e=(0,n.getRGB)(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[t,i]of this._colors)if(i.every((t,i)=>t===e[i]))return w._colorsMapping.get(t);return e}getHexCode(t){const e=this._colors.get(t);return e?a.Util.makeHexColor(...e):t}}var _=(0,p.default)("activeEditor"),x=(0,p.default)("allEditors"),E=(0,p.default)("allLayers"),P=(0,p.default)("altTextManager"),S=(0,p.default)("annotationStorage"),C=(0,p.default)("commandManager"),T=(0,p.default)("currentPageIndex"),M=(0,p.default)("deletedAnnotationsElementIds"),k=(0,p.default)("draggingEditors"),R=(0,p.default)("editorTypes"),O=(0,p.default)("editorsToRescale"),F=(0,p.default)("filterFactory"),I=(0,p.default)("focusMainContainerTimeoutId"),D=(0,p.default)("highlightColors"),L=(0,p.default)("idManager"),j=(0,p.default)("isEnabled"),N=(0,p.default)("isWaiting"),B=(0,p.default)("lastActiveElement"),U=(0,p.default)("mainHighlightColorPicker"),H=(0,p.default)("mode"),z=(0,p.default)("selectedEditors"),V=(0,p.default)("pageColors"),q=(0,p.default)("boundBlur"),G=(0,p.default)("boundFocus"),$=(0,p.default)("boundCopy"),W=(0,p.default)("boundCut"),X=(0,p.default)("boundPaste"),K=(0,p.default)("boundKeydown"),Y=(0,p.default)("boundOnEditingAction"),J=(0,p.default)("boundOnPageChanging"),Q=(0,p.default)("boundOnScaleChanging"),Z=(0,p.default)("boundOnRotationChanging"),tt=(0,p.default)("previousStates"),et=(0,p.default)("translation"),it=(0,p.default)("translationTimeoutId"),st=(0,p.default)("container"),at=(0,p.default)("viewer"),nt=(0,p.default)("addFocusManager"),rt=(0,p.default)("removeFocusManager"),ot=(0,p.default)("addKeyboardManager"),lt=(0,p.default)("removeKeyboardManager"),dt=(0,p.default)("addCopyPasteListeners"),ht=(0,p.default)("removeCopyPasteListeners"),ct=(0,p.default)("dispatchUpdateStates"),ut=(0,p.default)("dispatchUpdateUI"),ft=(0,p.default)("enableAll"),pt=(0,p.default)("disableAll"),gt=(0,p.default)("addEditorToLayer"),mt=(0,p.default)("isEmpty"),bt=(0,p.default)("selectEditors");class vt{static get _keyboardManager(){const t=vt.prototype,e=t=>(0,f.default)(t,st)[st].contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&t.hasSomethingToControl(),i=(t,{target:e})=>{if(e instanceof HTMLInputElement){const{type:t}=e;return"text"!==t&&"number"!==t}return!0},s=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new y([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&(0,f.default)(t,st)[st].contains(e)&&!t.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:t=>(0,f.default)(t,st)[st].contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}]]))}constructor(t,e,i,s,r,o,d){Object.defineProperty(this,bt,{value:Rt}),Object.defineProperty(this,mt,{value:kt}),Object.defineProperty(this,gt,{value:Mt}),Object.defineProperty(this,pt,{value:Tt}),Object.defineProperty(this,ft,{value:Ct}),Object.defineProperty(this,ut,{value:St}),Object.defineProperty(this,ct,{value:Pt}),Object.defineProperty(this,ht,{value:Et}),Object.defineProperty(this,dt,{value:xt}),Object.defineProperty(this,lt,{value:_t}),Object.defineProperty(this,ot,{value:wt}),Object.defineProperty(this,rt,{value:At}),Object.defineProperty(this,nt,{value:yt}),Object.defineProperty(this,_,{writable:!0,value:null}),Object.defineProperty(this,x,{writable:!0,value:new Map}),Object.defineProperty(this,E,{writable:!0,value:new Map}),Object.defineProperty(this,P,{writable:!0,value:null}),Object.defineProperty(this,S,{writable:!0,value:null}),Object.defineProperty(this,C,{writable:!0,value:new b}),Object.defineProperty(this,T,{writable:!0,value:0}),Object.defineProperty(this,M,{writable:!0,value:new Set}),Object.defineProperty(this,k,{writable:!0,value:null}),Object.defineProperty(this,R,{writable:!0,value:null}),Object.defineProperty(this,O,{writable:!0,value:new Set}),Object.defineProperty(this,F,{writable:!0,value:null}),Object.defineProperty(this,I,{writable:!0,value:null}),Object.defineProperty(this,D,{writable:!0,value:null}),Object.defineProperty(this,L,{writable:!0,value:new l}),Object.defineProperty(this,j,{writable:!0,value:!1}),Object.defineProperty(this,N,{writable:!0,value:!1}),Object.defineProperty(this,B,{writable:!0,value:null}),Object.defineProperty(this,U,{writable:!0,value:null}),Object.defineProperty(this,H,{writable:!0,value:a.AnnotationEditorType.NONE}),Object.defineProperty(this,z,{writable:!0,value:new Set}),Object.defineProperty(this,V,{writable:!0,value:null}),Object.defineProperty(this,q,{writable:!0,value:this.blur.bind(this)}),Object.defineProperty(this,G,{writable:!0,value:this.focus.bind(this)}),Object.defineProperty(this,$,{writable:!0,value:this.copy.bind(this)}),Object.defineProperty(this,W,{writable:!0,value:this.cut.bind(this)}),Object.defineProperty(this,X,{writable:!0,value:this.paste.bind(this)}),Object.defineProperty(this,K,{writable:!0,value:this.keydown.bind(this)}),Object.defineProperty(this,Y,{writable:!0,value:this.onEditingAction.bind(this)}),Object.defineProperty(this,J,{writable:!0,value:this.onPageChanging.bind(this)}),Object.defineProperty(this,Q,{writable:!0,value:this.onScaleChanging.bind(this)}),Object.defineProperty(this,Z,{writable:!0,value:this.onRotationChanging.bind(this)}),Object.defineProperty(this,tt,{writable:!0,value:{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1}}),Object.defineProperty(this,et,{writable:!0,value:[0,0]}),Object.defineProperty(this,it,{writable:!0,value:null}),Object.defineProperty(this,st,{writable:!0,value:null}),Object.defineProperty(this,at,{writable:!0,value:null}),(0,f.default)(this,st)[st]=t,(0,f.default)(this,at)[at]=e,(0,f.default)(this,P)[P]=i,this._eventBus=s,this._eventBus._on("editingaction",(0,f.default)(this,Y)[Y]),this._eventBus._on("pagechanging",(0,f.default)(this,J)[J]),this._eventBus._on("scalechanging",(0,f.default)(this,Q)[Q]),this._eventBus._on("rotationchanging",(0,f.default)(this,Z)[Z]),(0,f.default)(this,S)[S]=r.annotationStorage,(0,f.default)(this,F)[F]=r.filterFactory,(0,f.default)(this,V)[V]=o,(0,f.default)(this,D)[D]=d||null,this.viewParameters={realScale:n.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){(0,f.default)(this,lt)[lt](),(0,f.default)(this,rt)[rt](),this._eventBus._off("editingaction",(0,f.default)(this,Y)[Y]),this._eventBus._off("pagechanging",(0,f.default)(this,J)[J]),this._eventBus._off("scalechanging",(0,f.default)(this,Q)[Q]),this._eventBus._off("rotationchanging",(0,f.default)(this,Z)[Z]);for(const t of(0,f.default)(this,E)[E].values())t.destroy();(0,f.default)(this,E)[E].clear(),(0,f.default)(this,x)[x].clear(),(0,f.default)(this,O)[O].clear(),(0,f.default)(this,_)[_]=null,(0,f.default)(this,z)[z].clear(),(0,f.default)(this,C)[C].destroy(),(0,f.default)(this,P)[P]?.destroy(),(0,f.default)(this,I)[I]&&(clearTimeout((0,f.default)(this,I)[I]),(0,f.default)(this,I)[I]=null),(0,f.default)(this,it)[it]&&(clearTimeout((0,f.default)(this,it)[it]),(0,f.default)(this,it)[it]=null)}get hcmFilter(){return(0,a.shadow)(this,"hcmFilter",(0,f.default)(this,V)[V]?(0,f.default)(this,F)[F].addHCMFilter((0,f.default)(this,V)[V].foreground,(0,f.default)(this,V)[V].background):"none")}get direction(){return(0,a.shadow)(this,"direction",getComputedStyle((0,f.default)(this,st)[st]).direction)}get highlightColors(){return(0,a.shadow)(this,"highlightColors",(0,f.default)(this,D)[D]?new Map((0,f.default)(this,D)[D].split(",").map(t=>t.split("=").map(t=>t.trim()))):null)}setMainHighlightColorPicker(t){(0,f.default)(this,U)[U]=t}editAltText(t){(0,f.default)(this,P)[P]?.editAltText(this,t)}onPageChanging({pageNumber:t}){(0,f.default)(this,T)[T]=t-1}focusMainContainer(){(0,f.default)(this,st)[st].focus()}findParent(t,e){for(const i of(0,f.default)(this,E)[E].values()){const{x:s,y:a,width:n,height:r}=i.div.getBoundingClientRect();if(t>=s&&t<=s+n&&e>=a&&e<=a+r)return i}return null}disableUserSelect(t=!1){(0,f.default)(this,at)[at].classList.toggle("noUserSelect",t)}addShouldRescale(t){(0,f.default)(this,O)[O].add(t)}removeShouldRescale(t){(0,f.default)(this,O)[O].delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*n.PixelsPerInch.PDF_TO_CSS_UNITS;for(const t of(0,f.default)(this,O)[O])t.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}addToAnnotationStorage(t){t.isEmpty()||!(0,f.default)(this,S)[S]||(0,f.default)(this,S)[S].has(t.id)||(0,f.default)(this,S)[S].setValue(t.id,t)}blur(){if(!this.hasSelection)return;const{activeElement:t}=document;for(const e of(0,f.default)(this,z)[z])if(e.div.contains(t)){(0,f.default)(this,B)[B]=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!(0,f.default)(this,B)[B])return;const[t,e]=(0,f.default)(this,B)[B];(0,f.default)(this,B)[B]=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0}),e.focus()}addEditListeners(){(0,f.default)(this,ot)[ot](),(0,f.default)(this,dt)[dt]()}removeEditListeners(){(0,f.default)(this,lt)[lt](),(0,f.default)(this,ht)[ht]()}copy(t){if(t.preventDefault(),(0,f.default)(this,_)[_]?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const t of(0,f.default)(this,z)[z]){const i=t.serialize(!0);i&&e.push(i)}0!==e.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}paste(t){t.preventDefault();const{clipboardData:e}=t;for(const t of e.items)for(const e of(0,f.default)(this,R)[R])if(e.isHandlingMimeForPasting(t.type))return void e.paste(t,this.currentLayer);let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(t){return void(0,a.warn)(`paste: "${t.message}".`)}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const t=[];for(const e of i){const i=s.deserialize(e);if(!i)return;t.push(i)}const e=()=>{for(const e of t)(0,f.default)(this,gt)[gt](e);(0,f.default)(this,bt)[bt](t)},a=()=>{for(const e of t)e.remove()};this.addCommands({cmd:e,undo:a,mustExec:!0})}catch(t){(0,a.warn)(`paste: "${t.message}".`)}}keydown(t){this.isEditorHandlingKeyboard||vt._keyboardManager.exec(this,t)}onEditingAction(t){["undo","redo","delete","selectAll"].includes(t.name)&&this[t.name]()}setEditingState(t){t?((0,f.default)(this,nt)[nt](),(0,f.default)(this,ot)[ot](),(0,f.default)(this,dt)[dt](),(0,f.default)(this,ct)[ct]({isEditing:(0,f.default)(this,H)[H]!==a.AnnotationEditorType.NONE,isEmpty:(0,f.default)(this,mt)[mt](),hasSomethingToUndo:(0,f.default)(this,C)[C].hasSomethingToUndo(),hasSomethingToRedo:(0,f.default)(this,C)[C].hasSomethingToRedo(),hasSelectedEditor:!1})):((0,f.default)(this,rt)[rt](),(0,f.default)(this,lt)[lt](),(0,f.default)(this,ht)[ht](),(0,f.default)(this,ct)[ct]({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!(0,f.default)(this,R)[R]){(0,f.default)(this,R)[R]=t;for(const t of(0,f.default)(this,R)[R])(0,f.default)(this,ut)[ut](t.defaultPropertiesToUpdate)}}getId(){return(0,f.default)(this,L)[L].getId()}get currentLayer(){return(0,f.default)(this,E)[E].get((0,f.default)(this,T)[T])}getLayer(t){return(0,f.default)(this,E)[E].get(t)}get currentPageIndex(){return(0,f.default)(this,T)[T]}addLayer(t){(0,f.default)(this,E)[E].set(t.pageIndex,t),(0,f.default)(this,j)[j]?t.enable():t.disable()}removeLayer(t){(0,f.default)(this,E)[E].delete(t.pageIndex)}updateMode(t,e=null,i=!1){if((0,f.default)(this,H)[H]!==t){if((0,f.default)(this,H)[H]=t,t===a.AnnotationEditorType.NONE)return this.setEditingState(!1),void(0,f.default)(this,pt)[pt]();this.setEditingState(!0),(0,f.default)(this,ft)[ft](),this.unselectAll();for(const e of(0,f.default)(this,E)[E].values())e.updateMode(t);if(e||!i){if(e)for(const t of(0,f.default)(this,x)[x].values())if(t.annotationElementId===e){this.setSelected(t),t.enterInEditMode();break}}else this.addNewEditorFromKeyboard()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==(0,f.default)(this,H)[H]&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if((0,f.default)(this,R)[R]){switch(t){case a.AnnotationEditorParamsType.CREATE:return void this.currentLayer.addNewEditor();case a.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(0,f.default)(this,U)[U]?.updateColor(e)}for(const i of(0,f.default)(this,z)[z])i.updateParams(t,e);for(const i of(0,f.default)(this,R)[R])i.updateDefaultParams(t,e)}}enableWaiting(t=!1){if((0,f.default)(this,N)[N]!==t){(0,f.default)(this,N)[N]=t;for(const e of(0,f.default)(this,E)[E].values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const i of(0,f.default)(this,x)[x].values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return(0,f.default)(this,x)[x].get(t)}addEditor(t){(0,f.default)(this,x)[x].set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&((0,f.default)(this,I)[I]&&clearTimeout((0,f.default)(this,I)[I]),(0,f.default)(this,I)[I]=setTimeout(()=>{this.focusMainContainer(),(0,f.default)(this,I)[I]=null},0)),(0,f.default)(this,x)[x].delete(t.id),this.unselect(t),t.annotationElementId&&(0,f.default)(this,M)[M].has(t.annotationElementId)||(0,f.default)(this,S)[S]?.remove(t.id)}addDeletedAnnotationElement(t){(0,f.default)(this,M)[M].add(t.annotationElementId),t.deleted=!0}isDeletedAnnotationElement(t){return(0,f.default)(this,M)[M].has(t)}removeDeletedAnnotationElement(t){(0,f.default)(this,M)[M].delete(t.annotationElementId),t.deleted=!1}setActiveEditor(t){(0,f.default)(this,_)[_]!==t&&((0,f.default)(this,_)[_]=t,t&&(0,f.default)(this,ut)[ut](t.propertiesToUpdate))}toggleSelected(t){if((0,f.default)(this,z)[z].has(t))return(0,f.default)(this,z)[z].delete(t),t.unselect(),void(0,f.default)(this,ct)[ct]({hasSelectedEditor:this.hasSelection});(0,f.default)(this,z)[z].add(t),t.select(),(0,f.default)(this,ut)[ut](t.propertiesToUpdate),(0,f.default)(this,ct)[ct]({hasSelectedEditor:!0})}setSelected(t){for(const e of(0,f.default)(this,z)[z])e!==t&&e.unselect();(0,f.default)(this,z)[z].clear(),(0,f.default)(this,z)[z].add(t),t.select(),(0,f.default)(this,ut)[ut](t.propertiesToUpdate),(0,f.default)(this,ct)[ct]({hasSelectedEditor:!0})}isSelected(t){return(0,f.default)(this,z)[z].has(t)}get firstSelectedEditor(){return(0,f.default)(this,z)[z].values().next().value}unselect(t){t.unselect(),(0,f.default)(this,z)[z].delete(t),(0,f.default)(this,ct)[ct]({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==(0,f.default)(this,z)[z].size}get isEnterHandled(){return 1===(0,f.default)(this,z)[z].size&&this.firstSelectedEditor.isEnterHandled}undo(){(0,f.default)(this,C)[C].undo(),(0,f.default)(this,ct)[ct]({hasSomethingToUndo:(0,f.default)(this,C)[C].hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:(0,f.default)(this,mt)[mt]()})}redo(){(0,f.default)(this,C)[C].redo(),(0,f.default)(this,ct)[ct]({hasSomethingToUndo:!0,hasSomethingToRedo:(0,f.default)(this,C)[C].hasSomethingToRedo(),isEmpty:(0,f.default)(this,mt)[mt]()})}addCommands(t){(0,f.default)(this,C)[C].add(t),(0,f.default)(this,ct)[ct]({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:(0,f.default)(this,mt)[mt]()})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...(0,f.default)(this,z)[z]];this.addCommands({cmd:()=>{for(const e of t)e.remove()},undo:()=>{for(const e of t)(0,f.default)(this,gt)[gt](e)},mustExec:!0})}commitOrRemove(){(0,f.default)(this,_)[_]?.commitOrRemove()}hasSomethingToControl(){return(0,f.default)(this,_)[_]||this.hasSelection}selectAll(){for(const t of(0,f.default)(this,z)[z])t.commit();(0,f.default)(this,bt)[bt]((0,f.default)(this,x)[x].values())}unselectAll(){if((!(0,f.default)(this,_)[_]||((0,f.default)(this,_)[_].commitOrRemove(),(0,f.default)(this,H)[H]===a.AnnotationEditorType.NONE))&&this.hasSelection){for(const t of(0,f.default)(this,z)[z])t.unselect();(0,f.default)(this,z)[z].clear(),(0,f.default)(this,ct)[ct]({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;(0,f.default)(this,et)[et][0]+=t,(0,f.default)(this,et)[et][1]+=e;const[s,a]=(0,f.default)(this,et)[et],n=[...(0,f.default)(this,z)[z]];(0,f.default)(this,it)[it]&&clearTimeout((0,f.default)(this,it)[it]),(0,f.default)(this,it)[it]=setTimeout(()=>{(0,f.default)(this,it)[it]=null,(0,f.default)(this,et)[et][0]=(0,f.default)(this,et)[et][1]=0,this.addCommands({cmd:()=>{for(const t of n)(0,f.default)(this,x)[x].has(t.id)&&t.translateInPage(s,a)},undo:()=>{for(const t of n)(0,f.default)(this,x)[x].has(t.id)&&t.translateInPage(-s,-a)},mustExec:!1})},1e3);for(const i of n)i.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),(0,f.default)(this,k)[k]=new Map;for(const t of(0,f.default)(this,z)[z])(0,f.default)(this,k)[k].set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!(0,f.default)(this,k)[k])return!1;this.disableUserSelect(!1);const t=(0,f.default)(this,k)[k];(0,f.default)(this,k)[k]=null;let e=!1;for(const[{x:i,y:s,pageIndex:a},n]of t)n.newX=i,n.newY=s,n.newPageIndex=a,e||=i!==n.savedX||s!==n.savedY||a!==n.savedPageIndex;if(!e)return!1;const i=(t,e,i,s)=>{if((0,f.default)(this,x)[x].has(t.id)){const a=(0,f.default)(this,E)[E].get(s);a?t._setParentAndPosition(a,e,i):(t.pageIndex=s,t.x=e,t.y=i)}};return this.addCommands({cmd:()=>{for(const[e,{newX:s,newY:a,newPageIndex:n}]of t)i(e,s,a,n)},undo:()=>{for(const[e,{savedX:s,savedY:a,savedPageIndex:n}]of t)i(e,s,a,n)},mustExec:!0}),!0}dragSelectedEditors(t,e){if((0,f.default)(this,k)[k])for(const i of(0,f.default)(this,k)[k].keys())i.drag(t,e)}rebuild(t){if(null===t.parent){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===(0,f.default)(this,z)[z].size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return(0,f.default)(this,_)[_]===t}getActive(){return(0,f.default)(this,_)[_]}getMode(){return(0,f.default)(this,H)[H]}get imageManager(){return(0,a.shadow)(this,"imageManager",new g)}}function yt(){window.addEventListener("focus",(0,f.default)(this,G)[G]),window.addEventListener("blur",(0,f.default)(this,q)[q])}function At(){window.removeEventListener("focus",(0,f.default)(this,G)[G]),window.removeEventListener("blur",(0,f.default)(this,q)[q])}function wt(){window.addEventListener("keydown",(0,f.default)(this,K)[K])}function _t(){window.removeEventListener("keydown",(0,f.default)(this,K)[K])}function xt(){document.addEventListener("copy",(0,f.default)(this,$)[$]),document.addEventListener("cut",(0,f.default)(this,W)[W]),document.addEventListener("paste",(0,f.default)(this,X)[X])}function Et(){document.removeEventListener("copy",(0,f.default)(this,$)[$]),document.removeEventListener("cut",(0,f.default)(this,W)[W]),document.removeEventListener("paste",(0,f.default)(this,X)[X])}function Pt(t){Object.entries(t).some(([t,e])=>(0,f.default)(this,tt)[tt][t]!==e)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign((0,f.default)(this,tt)[tt],t)})}function St(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}function Ct(){if(!(0,f.default)(this,j)[j]){(0,f.default)(this,j)[j]=!0;for(const t of(0,f.default)(this,E)[E].values())t.enable()}}function Tt(){if(this.unselectAll(),(0,f.default)(this,j)[j]){(0,f.default)(this,j)[j]=!1;for(const t of(0,f.default)(this,E)[E].values())t.disable()}}function Mt(t){const e=(0,f.default)(this,E)[E].get(t.pageIndex);e?e.addOrRebuild(t):this.addEditor(t)}function kt(){if(0===(0,f.default)(this,x)[x].size)return!0;if(1===(0,f.default)(this,x)[x].size)for(const t of(0,f.default)(this,x)[x].values())return t.isEmpty();return!1}function Rt(t){(0,f.default)(this,z)[z].clear();for(const e of t)e.isEmpty()||((0,f.default)(this,z)[z].add(e),e.select());(0,f.default)(this,ct)[ct]({hasSelectedEditor:!0})}vt.TRANSLATE_SMALL=1,vt.TRANSLATE_BIG=10},171:(t,e,i)=>{i.d(e,{PDFFetchStream:()=>l});var s=i(266),a=i(253);function n(t,e,i){return{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function r(t){const e=new Headers;for(const i in t){const s=t[i];void 0!==s&&e.append(i,s)}return e}function o(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:((0,s.warn)(`getArrayBuffer - unexpected data format: ${t}`),new Uint8Array(t).buffer)}class l{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new d(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new h(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class d{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=new s.PromiseCapability,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._headers=r(this._stream.httpHeaders);const i=e.url;fetch(i,n(this._headers,this._withCredentials,this._abortController)).then(t=>{if(!(0,a.validateResponseStatus)(t.status))throw(0,a.createResponseStatusError)(t.status,i);this._reader=t.body.getReader(),this._headersCapability.resolve();const e=e=>t.headers.get(e),{allowRangeRequests:n,suggestedLength:r}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:e,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=r||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(e),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new s.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:o(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class h{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const o=t.source;this._withCredentials=o.withCredentials||!1,this._readCapability=new s.PromiseCapability,this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController,this._headers=r(this._stream.httpHeaders),this._headers.append("Range",`bytes=${e}-${i-1}`);const l=o.url;fetch(l,n(this._headers,this._withCredentials,this._abortController)).then(t=>{if(!(0,a.validateResponseStatus)(t.status))throw(0,a.createResponseStatusError)(t.status,l);this._readCapability.resolve(),this._reader=t.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:o(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}},742:(t,e,i)=>{i.d(e,{FontFaceObject:()=>n,FontLoader:()=>a});var s=i(266);class a{#b=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#b.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(t&&!this.#b.has(t.loadedName)){if((0,s.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:a,style:n}=t,r=new FontFace(i,a,n);this.addNativeFontFace(r);try{await r.load(),this.#b.add(i),e?.(t)}catch{(0,s.warn)(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}return}(0,s.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo)return void await this.loadSystemFont(t);if(this.isFontLoadingAPISupported){const e=t.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(i){throw(0,s.warn)(`Failed to load font '${e.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(e=>{const i=this._queueLoadingCallback(e);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return(0,s.shadow)(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(s.isNodeJS||"undefined"!=typeof navigator&&"string"==typeof navigator?.userAgent&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),(0,s.shadow)(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){const{loadingRequests:e}=this,i={done:!1,complete:function(){for((0,s.assert)(!i.done,"completeRequest() cannot be called twice."),i.done=!0;e.length>0&&e[0].done;){const t=e.shift();setTimeout(t.callback,0)}},callback:t};return e.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,s.shadow)(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function a(t,e,i,s){return t.substring(0,e)+s+t.substring(e+i)}let n,r;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let d=0;const h=`lt${Date.now()}${this.loadTestFontId++}`;let c=this._loadTestFont;c=a(c,976,h.length,h);const u=1482184792;let f=i(c,16);for(n=0,r=h.length-3;n<r;n+=4)f=f-u+i(h,n)|0;n<h.length&&(f=f-u+i(h+"XXX",n)|0),c=a(c,16,4,(0,s.string32)(f));const p=`@font-face {font-family:"${h}";src:${`url(data:font/opentype;base64,${btoa(c)});`}}`;this.insertRule(p);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const e of[t.loadedName,h]){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=e,g.append(t)}this._document.body.append(g),(function t(e,i){if(++d>30)return(0,s.warn)("Load test font never loaded."),void i();l.font="30px "+e,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0?i():setTimeout(t.bind(null,e,i))})(h,()=>{g.remove(),e.complete()})}}class n{constructor(t,{isEvalSupported:e=!0,disableFontFace:i=!1,ignoreErrors:s=!1,inspectFont:a=null}){this.compiledGlyphs=Object.create(null);for(const e in t)this[e]=t[e];this.isEvalSupported=!1!==e,this.disableFontFace=!0===i,this.ignoreErrors=!0===s,this._inspectFont=a}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=(0,s.bytesToString)(this.data),e=`url(data:${this.mimetype};base64,${btoa(t)});`;let i;if(this.cssFontInfo){let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${e}}`}else i=`@font-face {font-family:"${this.loadedName}";src:${e}}`;return this._inspectFont?.(this,e),i}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(t){if(!this.ignoreErrors)throw t;return(0,s.warn)(`getPathGenerator - ignoring character: "${t}".`),this.compiledGlyphs[e]=function(t,e){}}if(this.isEvalSupported&&s.FeatureTest.isEvalSupported){const t=[];for(const e of i){const i=void 0!==e.args?e.args.join(","):"";t.push("c.",e.cmd,"(",i,");\n")}return this.compiledGlyphs[e]=new Function("c","size",t.join(""))}return this.compiledGlyphs[e]=function(t,e){for(const s of i)"scale"===s.cmd&&(s.args=[e,-e]),t[s.cmd].apply(t,s.args)}}}},472:(t,e,i)=>{i.d(e,{Metadata:()=>a});var s=i(266);class a{#v;#y;constructor({parsedData:t,rawData:e}){this.#v=t,this.#y=e}getRaw(){return this.#y}get(t){return this.#v.get(t)??null}getAll(){return(0,s.objectFromMap)(this.#v)}has(t){return this.#v.has(t)}}},474:(t,e,i)=>{i.d(e,{PDFNetworkStream:()=>o});var s=i(266),a=i(253);function n(t){const e=t.response;return"string"!=typeof e?e:(0,s.stringToBytes)(e).buffer}class r{constructor(t,e={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const s={begin:t,end:e};for(const t in i)s[t]=i[t];return this.request(s)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const t in this.httpHeaders){const i=this.httpHeaders[t];void 0!==i&&e.setRequestHeader(t,i)}return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=206):s.expectedStatus=200,e.responseType="arraybuffer",t.onError&&(e.onerror=function(i){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),4!==s.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===s.status&&this.isHttp)return void i.onError?.(s.status);const a=s.status||200;if(!(200===a&&206===i.expectedStatus)&&a!==i.expectedStatus)return void i.onError?.(s.status);const r=n(s);if(206===a){const t=s.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);i.onDone({begin:parseInt(e[1],10),chunk:r})}else r?i.onDone({begin:0,chunk:r}):i.onError?.(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class o{constructor(t){this._source=t,this._manager=new r(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new l(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new d(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class l{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=new s.PromiseCapability,this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=t=>e.getResponseHeader(t),{allowRangeRequests:s,suggestedLength:n}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=n||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t)if(this._requests.length>0){this._requests.shift().resolve({value:t.chunk,done:!1})}else this._cachedChunks.push(t.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=(0,a.createResponseStatusError)(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=new s.PromiseCapability;return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class d{constructor(t,e,i){this._manager=t;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunk=e;this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=(0,a.createResponseStatusError)(t,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=new s.PromiseCapability;return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},253:(t,e,i)=>{i.d(e,{createResponseStatusError:()=>l,extractFilenameFromHeader:()=>o,validateRangeRequestCapabilities:()=>r,validateResponseStatus:()=>d});var s=i(266);function a(t){let e=!0,i=a("filename\\*","i").exec(t);if(i){i=i[1];let t=o(i);return t=unescape(t),t=l(t),t=d(t),r(t)}if(i=(function(t){const e=[];let i;const s=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(i=s.exec(t));){let[,t,s,a]=i;if(t=parseInt(t,10),t in e){if(0===t)break}else e[t]=[s,a]}const n=[];for(let t=0;t<e.length&&t in e;++t){let[i,s]=e[t];s=o(s),i&&(s=unescape(s),0===t&&(s=l(s))),n.push(s)}return n.join("")})(t),i){return r(d(i))}if(i=a("filename","i").exec(t),i){i=i[1];let t=o(i);return t=d(t),r(t)}function a(t,e){return new RegExp("(?:^|;)\\s*"+t+"\\s*=\\s*([^\";\\s][^;\\s]*|\"(?:[^\"\\\\]|\\\\\"?)+\"?)",e)}function n(t,i){if(t){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const a=new TextDecoder(t,{fatal:!0}),n=(0,s.stringToBytes)(i);i=a.decode(n),e=!1}catch{}}return i}function r(t){return e&&/[\x80-\xff]/.test(t)&&(t=n("utf-8",t),e&&(t=n("iso-8859-1",t))),t}function o(t){if(t.startsWith('"')){const e=t.slice(1).split('\\"');for(let t=0;t<e.length;++t){const i=e[t].indexOf('"');-1!==i&&(e[t]=e[t].slice(0,i),e.length=t+1),e[t]=e[t].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function l(t){const e=t.indexOf("'");if(-1===e)return t;return n(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function d(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(t,e,i,s){if("q"===i||"Q"===i)return n(e,s=(s=s.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(t,e){return String.fromCharCode(parseInt(e,16))}));try{s=atob(s)}catch{}return n(e,s)})}return""}var n=i(473);function r({getResponseHeader:t,isHttp:e,rangeChunkSize:i,disableRange:s}){const a={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(t("Content-Length"),10);if(!Number.isInteger(n))return a;if(a.suggestedLength=n,n<=2*i)return a;if(s||!e)return a;if("bytes"!==t("Accept-Ranges"))return a;return"identity"!==(t("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a}function o(t){const e=t("Content-Disposition");if(e){let t=a(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if((0,n.isPdfFile)(t))return t}return null}function l(t,e){return 404===t||0===t&&e.startsWith("file:")?new s.MissingPDFException('Missing PDF "'+e+'".'):new s.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t)}function d(t){return 200===t||206===t}},498:(t,e,i)=>{i.a(t,async(t,s)=>{try{i.d(e,{PDFNodeStream:()=>u});var a=i(266),n=i(253);let r,o,l,d;a.isNodeJS&&(r=await import("fs"),o=await import("http"),l=await import("https"),d=await import("url"));const h=/^file:\/\/\/[a-zA-Z]:\//;function c(t){const e=d.parse(t);return"file:"===e.protocol||e.host?e:/^[a-z]:[/\\]/i.test(t)?d.parse(`file:///${t}`):(e.host||(e.protocol="file:"),e)}class u{constructor(t){this.source=t,this.url=c(t.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new v(this):new m(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new y(this,t,e):new b(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class f{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=new a.PromiseCapability,this._headersCapability=new a.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=new a.PromiseCapability,this.read();this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new a.PromiseCapability;const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=new a.PromiseCapability,this.read();this._loaded+=t.length,this.onProgress?.({loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function g(t,e){return{protocol:t.protocol,auth:t.auth,host:t.hostname,port:t.port,path:t.path,method:"GET",headers:e}}class m extends f{constructor(t){super(t);const e=e=>{if(404===e.statusCode){const t=new a.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=t,void this._headersCapability.reject(t)}this._headersCapability.resolve(),this._setReadableStream(e);const i=t=>this._readableStream.headers[t.toLowerCase()],{allowRangeRequests:s,suggestedLength:r}=(0,n.validateRangeRequestCapabilities)({getResponseHeader:i,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=r||this._contentLength,this._filename=(0,n.extractFilenameFromHeader)(i)};this._request=null,"http:"===this._url.protocol?this._request=o.request(g(this._url,t.httpHeaders),e):this._request=l.request(g(this._url,t.httpHeaders),e),this._request.on("error",t=>{this._storedError=t,this._headersCapability.reject(t)}),this._request.end()}}class b extends p{constructor(t,e,i){super(t),this._httpHeaders={};for(const e in t.httpHeaders){const i=t.httpHeaders[e];void 0!==i&&(this._httpHeaders[e]=i)}this._httpHeaders.Range=`bytes=${e}-${i-1}`;const s=t=>{if(404===t.statusCode){const t=new a.MissingPDFException(`Missing PDF "${this._url}".`);return void(this._storedError=t)}this._setReadableStream(t)};this._request=null,"http:"===this._url.protocol?this._request=o.request(g(this._url,this._httpHeaders),s):this._request=l.request(g(this._url,this._httpHeaders),s),this._request.on("error",t=>{this._storedError=t}),this._request.end()}}class v extends f{constructor(t){super(t);let e=decodeURIComponent(this._url.path);h.test(this._url.href)&&(e=e.replace(/^\//,"")),r.lstat(e,(t,i)=>{if(t)return"ENOENT"===t.code&&(t=new a.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=t,void this._headersCapability.reject(t);this._contentLength=i.size,this._setReadableStream(r.createReadStream(e)),this._headersCapability.resolve()})}}class y extends p{constructor(t,e,i){super(t);let s=decodeURIComponent(this._url.path);h.test(this._url.href)&&(s=s.replace(/^\//,"")),this._setReadableStream(r.createReadStream(s,{start:e,end:i-1}))}}s()}catch(A){s(A)}},1)},738:(t,e,i)=>{i.a(t,async(t,s)=>{try{i.d(e,{NodeCMapReaderFactory:()=>h,NodeCanvasFactory:()=>d,NodeFilterFactory:()=>l,NodeStandardFontDataFactory:()=>c});var a=i(822);let t,n,r;if(i(266).isNodeJS){t=await import("fs");try{n=await import("canvas")}catch{}try{r=await import("path2d-polyfill")}catch{}}const o=function(e){return new Promise((i,s)=>{t.readFile(e,(t,e)=>{!t&&e?i(new Uint8Array(e)):s(new Error(t))})})};class l extends a.BaseFilterFactory{}class d extends a.BaseCanvasFactory{_createCanvas(t,e){return n.createCanvas(t,e)}}class h extends a.BaseCMapReaderFactory{_fetchData(t,e){return o(t).then(t=>({cMapData:t,compressionType:e}))}}class c extends a.BaseStandardFontDataFactory{_fetchData(t){return o(t)}}s()}catch(t){s(t)}},1)},890:(t,e,i)=>{i.d(e,{OptionalContentConfig:()=>u});var s=i(266),a=i(825);const n=Symbol("INTERNAL");class r{#A=!0;constructor(t,e){this.name=t,this.intent=e}get visible(){return this.#A}_setVisible(t,e){t!==n&&(0,s.unreachable)("Internal method `_setVisible` called."),this.#A=e}}var o=(0,p.default)("cachedGetHash"),l=(0,p.default)("groups"),d=(0,p.default)("initialHash"),h=(0,p.default)("order"),c=(0,p.default)("evaluateVisibilityExpression");class u{constructor(t){if(Object.defineProperty(this,c,{value:g}),Object.defineProperty(this,o,{writable:!0,value:null}),Object.defineProperty(this,l,{writable:!0,value:new Map}),Object.defineProperty(this,d,{writable:!0,value:null}),Object.defineProperty(this,h,{writable:!0,value:null}),this.name=null,this.creator=null,null!==t){this.name=t.name,this.creator=t.creator,(0,f.default)(this,h)[h]=t.order;for(const e of t.groups)(0,f.default)(this,l)[l].set(e.id,new r(e.name,e.intent));if("OFF"===t.baseState)for(const t of(0,f.default)(this,l)[l].values())t._setVisible(n,!1);for(const e of t.on)(0,f.default)(this,l)[l].get(e)._setVisible(n,!0);for(const e of t.off)(0,f.default)(this,l)[l].get(e)._setVisible(n,!1);(0,f.default)(this,d)[d]=this.getHash()}}isVisible(t){if(0===(0,f.default)(this,l)[l].size)return!0;if(!t)return(0,s.warn)("Optional content group not defined."),!0;if("OCG"===t.type)return(0,f.default)(this,l)[l].has(t.id)?(0,f.default)(this,l)[l].get(t.id).visible:((0,s.warn)(`Optional content group not found: ${t.id}`),!0);if("OCMD"===t.type){if(t.expression)return(0,f.default)(this,c)[c](t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!(0,f.default)(this,l)[l].has(e))return(0,s.warn)(`Optional content group not found: ${e}`),!0;if((0,f.default)(this,l)[l].get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!(0,f.default)(this,l)[l].has(e))return(0,s.warn)(`Optional content group not found: ${e}`),!0;if(!(0,f.default)(this,l)[l].get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!(0,f.default)(this,l)[l].has(e))return(0,s.warn)(`Optional content group not found: ${e}`),!0;if(!(0,f.default)(this,l)[l].get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!(0,f.default)(this,l)[l].has(e))return(0,s.warn)(`Optional content group not found: ${e}`),!0;if((0,f.default)(this,l)[l].get(e).visible)return!1}return!0}return(0,s.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,s.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0){(0,f.default)(this,l)[l].has(t)?((0,f.default)(this,l)[l].get(t)._setVisible(n,!!e),(0,f.default)(this,o)[o]=null):(0,s.warn)(`Optional content group not found: ${t}`)}get hasInitialVisibility(){return null===(0,f.default)(this,d)[d]||this.getHash()===(0,f.default)(this,d)[d]}getOrder(){return(0,f.default)(this,l)[l].size?(0,f.default)(this,h)[h]?(0,f.default)(this,h)[h].slice():[...(0,f.default)(this,l)[l].keys()]:null}getGroups(){return(0,f.default)(this,l)[l].size>0?(0,s.objectFromMap)((0,f.default)(this,l)[l]):null}getGroup(t){return(0,f.default)(this,l)[l].get(t)||null}getHash(){if(null!==(0,f.default)(this,o)[o])return(0,f.default)(this,o)[o];const t=new a.MurmurHash3_64;for(const[e,i]of(0,f.default)(this,l)[l])t.update(`${e}:${i.visible}`);return(0,f.default)(this,o)[o]=t.hexdigest()}}function g(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let a=1;a<e;a++){const e=t[a];let n;if(Array.isArray(e))n=(0,f.default)(this,c)[c](e);else{if(!(0,f.default)(this,l)[l].has(e))return(0,s.warn)(`Optional content group not found: ${e}`),!0;n=(0,f.default)(this,l)[l].get(e).visible}switch(i){case"And":if(!n)return!1;break;case"Or":if(n)return!0;break;case"Not":return!n;default:return!0}}return"And"===i}},739:(t,e,i)=>{i.d(e,{renderTextLayer:()=>f,updateTextLayer:()=>p});var s=i(266),a=i(473);const n=30,r=new Map;function o(t,e){let i;if(e&&s.FeatureTest.isOffscreenCanvasSupported)i=new OffscreenCanvas(t,t).getContext("2d",{alpha:!1});else{const e=document.createElement("canvas");e.width=e.height=t,i=e.getContext("2d",{alpha:!1})}return i}function l(t,e){const i=r.get(t);if(i)return i;const s=o(n,e);s.font=`30px ${t}`;const a=s.measureText("");let l=a.fontBoundingBoxAscent,d=Math.abs(a.fontBoundingBoxDescent);if(l){const e=l/(l+d);return r.set(t,e),s.canvas.width=s.canvas.height=0,e}s.strokeStyle="red",s.clearRect(0,0,n,n),s.strokeText("g",0,0);let h=s.getImageData(0,0,n,n).data;d=0;for(let t=h.length-1-3;t>=0;t-=4)if(h[t]>0){d=Math.ceil(t/4/n);break}s.clearRect(0,0,n,n),s.strokeText("A",0,n),h=s.getImageData(0,0,n,n).data,l=0;for(let t=0,e=h.length;t<e;t+=4)if(h[t]>0){l=n-Math.floor(t/4/n);break}if(s.canvas.width=s.canvas.height=0,l){const e=l/(l+d);return r.set(t,e),e}return r.set(t,.8),.8}function d(t,e,i){const a=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};t._textDivs.push(a);const r=s.Util.transform(t._transform,e.transform);let o=Math.atan2(r[1],r[0]);const d=i[e.fontName];d.vertical&&(o+=Math.PI/2);const h=t._fontInspectorEnabled&&d.fontSubstitution||d.fontFamily,c=Math.hypot(r[2],r[3]),u=c*l(h,t._isOffscreenCanvasSupported);let f,p;0===o?(f=r[4],p=r[5]-u):(f=r[4]+u*Math.sin(o),p=r[5]-u*Math.cos(o));const g="calc(var(--scale-factor)*",m=a.style;t._container===t._rootContainer?(m.left=`${(100*f/t._pageWidth).toFixed(2)}%`,m.top=`${(100*p/t._pageHeight).toFixed(2)}%`):(m.left=`${g}${f.toFixed(2)}px)`,m.top=`${g}${p.toFixed(2)}px)`),m.fontSize=`${g}${c.toFixed(2)}px)`,m.fontFamily=h,n.fontSize=c,a.setAttribute("role","presentation"),a.textContent=e.str,a.dir=e.dir,t._fontInspectorEnabled&&(a.dataset.fontName=d.fontSubstitutionLoadedName||e.fontName),0!==o&&(n.angle=o*(180/Math.PI));let b=!1;if(e.str.length>1)b=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),i=Math.abs(e.transform[3]);t!==i&&Math.max(t,i)/Math.min(t,i)>1.5&&(b=!0)}b&&(n.canvasWidth=d.vertical?e.height:e.width),t._textDivProperties.set(a,n),t._isReadableStream&&t._layoutText(a)}function h(t){const{div:e,scale:i,properties:s,ctx:a,prevFontSize:n,prevFontFamily:r}=t,{style:o}=e;let l="";if(0!==s.canvasWidth&&s.hasText){const{fontFamily:d}=o,{canvasWidth:h,fontSize:c}=s;n===c&&r===d||(a.font=`${c*i}px ${d}`,t.prevFontSize=c,t.prevFontFamily=d);const{width:u}=a.measureText(e.textContent);u>0&&(l=`scaleX(${h*i/u})`)}0!==s.angle&&(l=`rotate(${s.angle}deg) ${l}`),l.length>0&&(o.transform=l)}function c(t){if(t._canceled)return;const e=t._textDivs,i=t._capability;if(e.length>1e5)i.resolve();else{if(!t._isReadableStream)for(const i of e)t._layoutText(i);i.resolve()}}class u{constructor({textContentSource:t,container:e,viewport:i,textDivs:n,textDivProperties:r,textContentItemsStr:l,isOffscreenCanvasSupported:d}){this._textContentSource=t,this._isReadableStream=t instanceof ReadableStream,this._container=this._rootContainer=e,this._textDivs=n||[],this._textContentItemsStr=l||[],this._isOffscreenCanvasSupported=d,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=r||new WeakMap,this._canceled=!1,this._capability=new s.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:i.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:o(0,d)};const{pageWidth:h,pageHeight:c,pageX:u,pageY:f}=i.rawDims;this._transform=[1,0,0,-1,-u,f+c],this._pageWidth=h,this._pageHeight=c,(0,a.setLayerDimensions)(e,i),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new s.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new s.AbortException("TextLayer task cancelled."))}_processItems(t,e){for(const i of t)if(void 0!==i.str)this._textContentItemsStr.push(i.str),d(this,i,e);else if("beginMarkedContentProps"===i.type||"beginMarkedContent"===i.type){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==i.id&&this._container.setAttribute("id",`${i.id}`),t.append(this._container)}else"endMarkedContent"===i.type&&(this._container=this._container.parentNode)}_layoutText(t){const e=this._layoutTextParams.properties=this._textDivProperties.get(t);if(this._layoutTextParams.div=t,h(this._layoutTextParams),e.hasText&&this._container.append(t),e.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),this._container.append(t)}}_render(){const t=new s.PromiseCapability;let e=Object.create(null);if(this._isReadableStream){const i=()=>{this._reader.read().then(({value:s,done:a})=>{a?t.resolve():(Object.assign(e,s.styles),this._processItems(s.items,e),i())},t.reject)};this._reader=this._textContentSource.getReader(),i()}else{if(!this._textContentSource)throw new Error('No "textContentSource" parameter specified.');{const{items:e,styles:i}=this._textContentSource;this._processItems(e,i),t.resolve()}}t.promise.then(()=>{e=null,c(this)},this._capability.reject)}}function f(t){const e=new u(t);return e._render(),e}function p({container:t,viewport:e,textDivs:i,textDivProperties:s,isOffscreenCanvasSupported:n,mustRotate:r=!0,mustRescale:l=!0}){if(r&&(0,a.setLayerDimensions)(t,{rotation:e.rotation}),l){const t=o(0,n),a={prevFontSize:null,prevFontFamily:null,div:null,scale:e.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:t};for(const t of i)a.properties=s.get(t),a.div=t,h(a)}}},92:(t,e,i)=>{i.d(e,{PDFDataTransportStream:()=>n});var s=i(266),a=i(473);class n{constructor({length:t,initialData:e,progressiveDone:i=!1,contentDispositionFilename:a=null,disableRange:n=!1,disableStream:r=!1},o){if((0,s.assert)(o,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=i,this._contentDispositionFilename=a,e?.length>0){const t=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=o,this._isStreamingSupported=!r,this._isRangeSupported=!n,this._contentLength=t,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((t,e)=>{this._onReceiveData({begin:t,chunk:e})}),this._pdfDataRangeTransport.addProgressListener((t,e)=>{this._onProgress({loaded:t,total:e})}),this._pdfDataRangeTransport.addProgressiveReadListener(t=>{this._onReceiveData({chunk:t})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const e=this._rangeReaders.some(function(e){return e._begin===t&&(e._enqueue(i),!0)});(0,s.assert)(e,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){void 0===t.total?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){(0,s.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new r(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new o(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class r{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=(0,a.isPdfFile)(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const t of this._queuedChunks)this._loaded+=t.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunks.push(t);this._loaded+=t.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=new s.PromiseCapability;return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=new s.PromiseCapability;return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},368:(t,e,i)=>{i.d(e,{GlobalWorkerOptions:()=>s});const s=Object.create(null);s.workerPort=null,s.workerSrc=""},160:(t,e,i)=>{i.d(e,{XfaLayer:()=>a});var s=i(521);class a{static setupStorage(t,e,i,s,a){const n=s.getValue(e,{value:null});switch(i.name){case"textarea":if(null!==n.value&&(t.textContent=n.value),"print"===a)break;t.addEventListener("input",t=>{s.setValue(e,{value:t.target.value})});break;case"input":if("radio"===i.attributes.type||"checkbox"===i.attributes.type){if(n.value===i.attributes.xfaOn?t.setAttribute("checked",!0):n.value===i.attributes.xfaOff&&t.removeAttribute("checked"),"print"===a)break;t.addEventListener("change",t=>{s.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})})}else{if(null!==n.value&&t.setAttribute("value",n.value),"print"===a)break;t.addEventListener("input",t=>{s.setValue(e,{value:t.target.value})})}break;case"select":if(null!==n.value){t.setAttribute("value",n.value);for(const t of i.children)t.attributes.value===n.value?t.attributes.selected=!0:t.attributes.hasOwnProperty("selected")&&delete t.attributes.selected}t.addEventListener("input",t=>{const i=t.target.options,a=-1===i.selectedIndex?"":i[i.selectedIndex].value;s.setValue(e,{value:a})})}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:a}){const{attributes:n}=e,r=t instanceof HTMLAnchorElement;"radio"===n.type&&(n.name=`${n.name}-${s}`);for(const[e,i]of Object.entries(n))if(null!=i)switch(e){case"class":i.length&&t.setAttribute(e,i.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",i);break;case"style":Object.assign(t.style,i);break;case"textContent":t.textContent=i;break;default:(!r||"href"!==e&&"newWindow"!==e)&&t.setAttribute(e,i)}r&&a.addLinkAttributes(t,n.href,n.newWindow),i&&n.dataId&&this.setupStorage(t,n.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,a=t.xfaHtml,n=t.intent||"display",r=document.createElement(a.name);a.attributes&&this.setAttributes({html:r,element:a,intent:n,linkService:i});const o="richText"!==n,l=t.div;if(l.append(r),t.viewport){const e=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=e}o&&l.setAttribute("class","xfaLayer xfaFont");const d=[];if(0===a.children.length){if(a.value){const t=document.createTextNode(a.value);r.append(t),o&&s.XfaText.shouldBuildText(a.name)&&d.push(t)}return{textDivs:d}}const h=[[a,-1,r]];for(;h.length>0;){const[t,a,r]=h.at(-1);if(a+1===t.children.length){h.pop();continue}const l=t.children[++h.at(-1)[1]];if(null===l)continue;const{name:c}=l;if("#text"===c){const t=document.createTextNode(l.value);d.push(t),r.append(t);continue}const u=l?.attributes?.xmlns?document.createElementNS(l.attributes.xmlns,c):document.createElement(c);if(r.append(u),l.attributes&&this.setAttributes({html:u,element:l,storage:e,intent:n,linkService:i}),l.children?.length>0)h.push([l,-1,u]);else if(l.value){const t=document.createTextNode(l.value);o&&s.XfaText.shouldBuildText(c)&&d.push(t),u.append(t)}}for(const t of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))t.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}},521:(t,e,i)=>{i.d(e,{XfaText:()=>s});class s{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};return(function t(i){if(!i)return;let a=null;const n=i.name;if("#text"===n)a=i.value;else{if(!s.shouldBuildText(n))return;i?.attributes?.textContent?a=i.attributes.textContent:i.value&&(a=i.value)}if(null!==a&&e.push({str:a}),i.children)for(const e of i.children)t(e)})(t),i}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}},907:(t,e,i)=>{i.a(t,async(t,s)=>{try{i.d(e,{AbortException:()=>a.AbortException,AnnotationEditorLayer:()=>l.AnnotationEditorLayer,AnnotationEditorParamsType:()=>a.AnnotationEditorParamsType,AnnotationEditorType:()=>a.AnnotationEditorType,AnnotationEditorUIManager:()=>d.AnnotationEditorUIManager,AnnotationLayer:()=>h.AnnotationLayer,AnnotationMode:()=>a.AnnotationMode,CMapCompressionType:()=>a.CMapCompressionType,ColorPicker:()=>c.ColorPicker,DOMSVGFactory:()=>r.DOMSVGFactory,DrawLayer:()=>u.DrawLayer,FeatureTest:()=>a.FeatureTest,GlobalWorkerOptions:()=>f.GlobalWorkerOptions,ImageKind:()=>a.ImageKind,InvalidPDFException:()=>a.InvalidPDFException,MissingPDFException:()=>a.MissingPDFException,OPS:()=>a.OPS,Outliner:()=>p.Outliner,PDFDataRangeTransport:()=>n.PDFDataRangeTransport,PDFDateString:()=>r.PDFDateString,PDFWorker:()=>n.PDFWorker,PasswordResponses:()=>a.PasswordResponses,PermissionFlag:()=>a.PermissionFlag,PixelsPerInch:()=>r.PixelsPerInch,PromiseCapability:()=>a.PromiseCapability,RenderingCancelledException:()=>r.RenderingCancelledException,UnexpectedResponseException:()=>a.UnexpectedResponseException,Util:()=>a.Util,VerbosityLevel:()=>a.VerbosityLevel,XfaLayer:()=>g.XfaLayer,build:()=>n.build,createValidAbsoluteUrl:()=>a.createValidAbsoluteUrl,fetchData:()=>r.fetchData,getDocument:()=>n.getDocument,getFilenameFromUrl:()=>r.getFilenameFromUrl,getPdfFilenameFromUrl:()=>r.getPdfFilenameFromUrl,getXfaPageViewport:()=>r.getXfaPageViewport,isDataScheme:()=>r.isDataScheme,isPdfFile:()=>r.isPdfFile,noContextMenu:()=>r.noContextMenu,normalizeUnicode:()=>a.normalizeUnicode,renderTextLayer:()=>o.renderTextLayer,setLayerDimensions:()=>r.setLayerDimensions,shadow:()=>a.shadow,updateTextLayer:()=>o.updateTextLayer,version:()=>n.version});var a=i(266),n=i(406),r=i(473),o=i(739),l=i(629),d=i(812),h=i(640),c=i(97),u=i(423),f=i(368),p=i(405),g=i(160),m=t([n]);n=(m.then?(await m)():m)[0];s()}catch(t){s(t)}})},694:(t,e,i)=>{i.d(e,{MessageHandler:()=>A});var s=i(266);const a=1,n=2,r=1,o=2,l=3,d=4,h=5,c=6,u=7,g=8;function m(t){switch(t instanceof Error||"object"==typeof t&&null!==t||(0,s.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new s.AbortException(t.message);case"MissingPDFException":return new s.MissingPDFException(t.message);case"PasswordException":return new s.PasswordException(t.message,t.code);case"UnexpectedResponseException":return new s.UnexpectedResponseException(t.message,t.status);case"UnknownErrorException":return new s.UnknownErrorException(t.message,t.details);default:return new s.UnknownErrorException(t.message,t.toString())}}var b=(0,p.default)("createStreamSink"),v=(0,p.default)("processStreamMessage"),y=(0,p.default)("deleteStreamController");class A{constructor(t,e,i){Object.defineProperty(this,y,{value:x}),Object.defineProperty(this,v,{value:_}),Object.defineProperty(this,b,{value:w}),this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=t=>{const e=t.data;if(e.targetName!==this.sourceName)return;if(e.stream)return void(0,f.default)(this,v)[v](e);if(e.callback){const t=e.callbackId,i=this.callbackCapabilities[t];if(!i)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],e.callback===a)i.resolve(e.data);else{if(e.callback!==n)throw new Error("Unexpected callback case");i.reject(m(e.reason))}return}const s=this.actionHandler[e.action];if(!s)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const t=this.sourceName,r=e.sourceName;return void new Promise(function(t){t(s(e.data))}).then(function(s){i.postMessage({sourceName:t,targetName:r,callback:a,callbackId:e.callbackId,data:s})},function(s){i.postMessage({sourceName:t,targetName:r,callback:n,callbackId:e.callbackId,reason:m(s)})})}e.streamId?(0,f.default)(this,b)[b](e):s(e.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const a=this.callbackId++,n=new s.PromiseCapability;this.callbackCapabilities[a]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},i)}catch(t){n.reject(t)}return n.promise}sendWithStream(t,e,i,a){const n=this.streamId++,o=this.sourceName,l=this.targetName,d=this.comObj;return new ReadableStream({start:i=>{const r=new s.PromiseCapability;return this.streamControllers[n]={controller:i,startCall:r,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:o,targetName:l,action:t,streamId:n,data:e,desiredSize:i.desiredSize},a),r.promise},pull:t=>{const e=new s.PromiseCapability;return this.streamControllers[n].pullCall=e,d.postMessage({sourceName:o,targetName:l,stream:c,streamId:n,desiredSize:t.desiredSize}),e.promise},cancel:t=>{(0,s.assert)(t instanceof Error,"cancel must have a valid reason");const e=new s.PromiseCapability;return this.streamControllers[n].cancelCall=e,this.streamControllers[n].isClosed=!0,d.postMessage({sourceName:o,targetName:l,stream:r,streamId:n,reason:m(t)}),e.promise}},i)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}function w(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,n=this.comObj,r=this,o=this.actionHandler[t.action],c={enqueue(t,r=1,o){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=r,l>0&&this.desiredSize<=0&&(this.sinkCapability=new s.PromiseCapability,this.ready=this.sinkCapability.promise),n.postMessage({sourceName:i,targetName:a,stream:d,streamId:e,chunk:t},o)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:a,stream:l,streamId:e}),delete r.streamSinks[e])},error(t){(0,s.assert)(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:a,stream:h,streamId:e,reason:m(t)}))},sinkCapability:new s.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[e]=c,new Promise(function(e){e(o(t.data,c))}).then(function(){n.postMessage({sourceName:i,targetName:a,stream:g,streamId:e,success:!0})},function(t){n.postMessage({sourceName:i,targetName:a,stream:g,streamId:e,reason:m(t)})})}function _(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,n=this.comObj,p=this.streamControllers[e],b=this.streamSinks[e];switch(t.stream){case g:t.success?p.startCall.resolve():p.startCall.reject(m(t.reason));break;case u:t.success?p.pullCall.resolve():p.pullCall.reject(m(t.reason));break;case c:if(!b){n.postMessage({sourceName:i,targetName:a,stream:u,streamId:e,success:!0});break}b.desiredSize<=0&&t.desiredSize>0&&b.sinkCapability.resolve(),b.desiredSize=t.desiredSize,new Promise(function(t){t(b.onPull?.())}).then(function(){n.postMessage({sourceName:i,targetName:a,stream:u,streamId:e,success:!0})},function(t){n.postMessage({sourceName:i,targetName:a,stream:u,streamId:e,reason:m(t)})});break;case d:if((0,s.assert)(p,"enqueue should have stream controller"),p.isClosed)break;p.controller.enqueue(t.chunk);break;case l:if((0,s.assert)(p,"close should have stream controller"),p.isClosed)break;p.isClosed=!0,p.controller.close(),(0,f.default)(this,y)[y](p,e);break;case h:(0,s.assert)(p,"error should have stream controller"),p.controller.error(m(t.reason)),(0,f.default)(this,y)[y](p,e);break;case o:t.success?p.cancelCall.resolve():p.cancelCall.reject(m(t.reason)),(0,f.default)(this,y)[y](p,e);break;case r:if(!b)break;new Promise(function(e){e(b.onCancel?.(m(t.reason)))}).then(function(){n.postMessage({sourceName:i,targetName:a,stream:o,streamId:e,success:!0})},function(t){n.postMessage({sourceName:i,targetName:a,stream:o,streamId:e,reason:m(t)})}),b.sinkCapability.reject(m(t.reason)),b.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async function x(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}},825:(t,e,i)=>{i.d(e,{MurmurHash3_64:()=>o});var s=i(266);const a=3285377520,n=4294901760,r=65535;class o{constructor(t){this.h1=t?4294967295&t:a,this.h2=t?4294967295&t:a}update(t){let e,i;if("string"==typeof t){e=new Uint8Array(2*t.length),i=0;for(let s=0,a=t.length;s<a;s++){const a=t.charCodeAt(s);a<=255?e[i++]=a:(e[i++]=a>>>8,e[i++]=255&a)}}else{if(!(0,s.isArrayBuffer)(t))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");e=t.slice(),i=e.byteLength}const a=i>>2,o=i-4*a,l=new Uint32Array(e.buffer,0,a);let d=0,h=0,c=this.h1,u=this.h2;const f=3432918353,p=461845907,g=11601,m=13715;for(let t=0;t<a;t++)1&t?(d=l[t],d=d*f&n|d*g&r,d=d<<15|d>>>17,d=d*p&n|d*m&r,c^=d,c=c<<13|c>>>19,c=5*c+3864292196):(h=l[t],h=h*f&n|h*g&r,h=h<<15|h>>>17,h=h*p&n|h*m&r,u^=h,u=u<<13|u>>>19,u=5*u+3864292196);switch(d=0,o){case 3:d^=e[4*a+2]<<16;case 2:d^=e[4*a+1]<<8;case 1:d^=e[4*a],d=d*f&n|d*g&r,d=d<<15|d>>>17,d=d*p&n|d*m&r,1&a?c^=d:u^=d}this.h1=c,this.h2=u}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=3981806797*t&n|36045*t&r,e=4283543511*e&n|(2950163797*(e<<16|t>>>16)&n)>>>16,t^=e>>>1,t=444984403*t&n|60499*t&r,e=3301882366*e&n|(3120437893*(e<<16|t>>>16)&n)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}},266:(t,e,i)=>{i.d(e,{AbortException:()=>B,AnnotationBorderStyleType:()=>b,AnnotationEditorParamsType:()=>u,AnnotationEditorPrefix:()=>h,AnnotationEditorType:()=>c,AnnotationMode:()=>d,AnnotationPrefix:()=>et,AnnotationType:()=>m,BaseException:()=>O,CMapCompressionType:()=>y,FONT_IDENTITY_MATRIX:()=>n,FeatureTest:()=>$,FormatError:()=>N,IDENTITY_MATRIX:()=>a,ImageKind:()=>g,InvalidPDFException:()=>D,LINE_FACTOR:()=>o,MAX_IMAGE_SIZE_TO_CACHE:()=>r,MissingPDFException:()=>L,OPS:()=>A,PasswordException:()=>F,PasswordResponses:()=>w,PermissionFlag:()=>f,PromiseCapability:()=>Y,RenderingIntentFlag:()=>l,TextRenderingMode:()=>p,UnexpectedResponseException:()=>j,UnknownErrorException:()=>I,Util:()=>X,VerbosityLevel:()=>v,assert:()=>T,bytesToString:()=>U,createValidAbsoluteUrl:()=>k,getUuid:()=>tt,getVerbosityLevel:()=>E,info:()=>P,isArrayBuffer:()=>K,isNodeJS:()=>s,normalizeUnicode:()=>Z,objectFromMap:()=>V,setVerbosityLevel:()=>x,shadow:()=>R,string32:()=>z,stringToBytes:()=>H,unreachable:()=>C,warn:()=>S});const s=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type),a=[1,0,0,1,0,0],n=[.001,0,0,.001,0,0],r=1e7,o=1.35,l={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},h="pdfjs_internal_editor_",c={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},u={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32},f={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},p={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},m={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},b={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},v={ERRORS:0,WARNINGS:1,INFOS:5},y={NONE:0,BINARY:1},A={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},w={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let _=v.WARNINGS;function x(t){Number.isInteger(t)&&(_=t)}function E(){return _}function P(t){_>=v.INFOS&&console.log(`Info: ${t}`)}function S(t){_>=v.WARNINGS&&console.log(`Warning: ${t}`)}function C(t){throw new Error(t)}function T(t,e){t||C(e)}function M(t){switch(t?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function k(t,e=null,i=null){if(!t)return null;try{if(i&&"string"==typeof t){if(i.addDefaultProtocol&&t.startsWith("www.")){const e=t.match(/\./g);e?.length>=2&&(t=`http://${t}`)}if(i.tryConvertEncoding)try{t=decodeURIComponent(escape(t))}catch{}}const s=e?new URL(t,e):new URL(t);if(M(s))return s}catch{}return null}function R(t,e,i,s=!1){return Object.defineProperty(t,e,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const O=(function(){function t(e,i){this.constructor===t&&C("Cannot initialize BaseException."),this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class F extends O{constructor(t,e){super(t,"PasswordException"),this.code=e}}class I extends O{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class D extends O{constructor(t){super(t,"InvalidPDFException")}}class L extends O{constructor(t){super(t,"MissingPDFException")}}class j extends O{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class N extends O{constructor(t){super(t,"FormatError")}}class B extends O{constructor(t){super(t,"AbortException")}}function U(t){"object"==typeof t&&void 0!==t?.length||C("Invalid argument for bytesToString");const e=t.length,i=8192;if(e<i)return String.fromCharCode.apply(null,t);const s=[];for(let a=0;a<e;a+=i){const n=Math.min(a+i,e),r=t.subarray(a,n);s.push(String.fromCharCode.apply(null,r))}return s.join("")}function H(t){"string"!=typeof t&&C("Invalid argument for stringToBytes");const e=t.length,i=new Uint8Array(e);for(let s=0;s<e;++s)i[s]=255&t.charCodeAt(s);return i}function z(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function V(t){const e=Object.create(null);for(const[i,s]of t)e[i]=s;return e}function q(){const t=new Uint8Array(4);t[0]=1;return 1===new Uint32Array(t.buffer,0,1)[0]}function G(){try{return new Function(""),!0}catch{return!1}}class ${static get isLittleEndian(){return R(this,"isLittleEndian",q())}static get isEvalSupported(){return R(this,"isEvalSupported",G())}static get isOffscreenCanvasSupported(){return R(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get platform(){return"undefined"!=typeof navigator&&"string"==typeof navigator?.platform?R(this,"platform",{isMac:navigator.platform.includes("Mac")}):R(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){return R(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const W=[...Array(256).keys()].map(t=>t.toString(16).padStart(2,"0"));class X{static makeHexColor(t,e,i){return`#${W[t]}${W[e]}${W[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[1],e[1]=i),e[0]*=t[0],e[1]*=t[0],t[3]<0&&(i=e[2],e[2]=e[3],e[3]=i),e[2]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[2],e[2]=i,i=e[1],e[1]=e[3],e[3]=i,t[1]<0&&(i=e[2],e[2]=e[3],e[3]=i),e[2]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[1],e[1]=i),e[0]*=t[2],e[1]*=t[2]),e[0]+=t[4],e[1]+=t[4],e[2]+=t[5],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),s=this.applyTransform(t.slice(2,4),e),a=this.applyTransform([t[0],t[3]],e),n=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],s[0],a[0],n[0]),Math.min(i[1],s[1],a[1],n[1]),Math.max(i[0],s[0],a[0],n[0]),Math.max(i[1],s[1],a[1],n[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],s=t[0]*e[1]+t[1]*e[3],a=t[2]*e[0]+t[3]*e[2],n=t[2]*e[1]+t[3]*e[3],r=(i+n)/2,o=Math.sqrt((i+n)**2-4*(i*n-a*s))/2,l=r+o||1,d=r-o||1;return[Math.sqrt(l),Math.sqrt(d)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),n=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>n?null:[i,a,s,n]}static bezierBoundingBox(t,e,i,s,a,n,r,o){const l=[],d=[[],[]];let h,c,u,f,p,g,m,b;for(let d=0;d<2;++d)if(0===d?(c=6*t-12*i+6*a,h=-3*t+9*i-9*a+3*r,u=3*i-3*t):(c=6*e-12*s+6*n,h=-3*e+9*s-9*n+3*o,u=3*s-3*e),Math.abs(h)<1e-12){if(Math.abs(c)<1e-12)continue;f=-u/c,0<f&&f<1&&l.push(f)}else m=c*c-4*u*h,b=Math.sqrt(m),m<0||(p=(-c+b)/(2*h),0<p&&p<1&&l.push(p),g=(-c-b)/(2*h),0<g&&g<1&&l.push(g));let v,y=l.length;const A=y;for(;y--;)f=l[y],v=1-f,d[0][y]=v*v*v*t+3*v*v*f*i+3*v*f*f*a+f*f*f*r,d[1][y]=v*v*v*e+3*v*v*f*s+3*v*f*f*n+f*f*f*o;return d[0][A]=t,d[1][A]=e,d[0][A+1]=r,d[1][A+1]=o,d[0].length=d[1].length=A+2,[Math.min(...d[0]),Math.min(...d[1]),Math.max(...d[0]),Math.max(...d[1])]}}function K(t){return"object"==typeof t&&void 0!==t?.byteLength}class Y{#w=!1;constructor(){this.promise=new Promise((t,e)=>{this.resolve=e=>{this.#w=!0,t(e)},this.reject=t=>{this.#w=!0,e(t)}})}get settled(){return this.#w}}let J=null,Q=null;function Z(t){return J||(J=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Q=new Map([["\ufb05","\u017ft"]])),t.replaceAll(J,(t,e,i)=>e?e.normalize("NFKC"):Q.get(i))}function tt(){if("undefined"!=typeof crypto&&"function"==typeof crypto?.randomUUID)return crypto.randomUUID();const t=new Uint8Array(32);if("undefined"!=typeof crypto&&"function"==typeof crypto?.getRandomValues)crypto.getRandomValues(t);else for(let e=0;e<32;e++)t[e]=Math.floor(255*Math.random());return U(t)}const et="pdfjs_internal_id_"}},m={};function b(t){var e=m[t];if(void 0!==e)return e.exports;var i=m[t]={exports:{}};return g[t](i,i.exports,b),i.exports}l="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",d="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",h="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",c=t=>{t&&t.d<1&&(t.d=1,t.forEach(t=>t.r--),t.forEach(t=>t.r--?t.r++:t()))},u=t=>t.map(t=>{if(null!==t&&"object"==typeof t){if(t[l])return t;if(t.then){var e=[];e.d=0,t.then(t=>{i[d]=t,c(e)},t=>{i[h]=t,c(e)});var i={};return i[l]=t=>t(e),i}}var s={};return s[l]=t=>{},s[d]=t,s}),b.a=(t,e,i)=>{var s;i&&((s=[]).d=-1);var a,n,r,o=new Set,f=t.exports,p=new Promise((t,e)=>{r=e,n=t});p[d]=f,p[l]=t=>(s&&t(s),o.forEach(t),p.catch(t=>{})),t.exports=p,e(t=>{var e;a=u(t);var i=()=>a.map(t=>{if(t[h])throw t[h];return t[d]}),n=new Promise(t=>{(e=()=>t(i)).r=0;var n=t=>t!==s&&!o.has(t)&&(o.add(t),t&&!t.d&&(e.r++,t.push(e)));a.map(t=>t[l](n))});return e.r?n:i()},t=>(t?r(p[h]=t):n(f),c(s))),s&&s.d<0&&(s.d=0)},b.d=(t,e)=>{for(var i in e)b.o(e,i)&&!b.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},b.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var v=b(907),y=(v=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=v)).AbortException,A=v.AnnotationEditorLayer,w=v.AnnotationEditorParamsType,_=v.AnnotationEditorType,x=v.AnnotationEditorUIManager,E=v.AnnotationLayer,P=v.AnnotationMode,S=v.CMapCompressionType,C=v.ColorPicker,T=v.DOMSVGFactory,M=v.DrawLayer,k=v.FeatureTest,R=v.GlobalWorkerOptions,O=v.ImageKind,F=v.InvalidPDFException,I=v.MissingPDFException,D=v.OPS,L=v.Outliner,j=v.PDFDataRangeTransport,N=v.PDFDateString,B=v.PDFWorker,U=v.PasswordResponses,H=v.PermissionFlag,z=v.PixelsPerInch,V=v.PromiseCapability,q=v.RenderingCancelledException,G=v.UnexpectedResponseException,$=v.Util,W=v.VerbosityLevel,X=v.XfaLayer,K=v.build,Y=v.createValidAbsoluteUrl,J=v.fetchData,Q=v.getDocument,Z=v.getFilenameFromUrl,tt=v.getPdfFilenameFromUrl,et=v.getXfaPageViewport,it=v.isDataScheme,st=v.isPdfFile,at=v.noContextMenu,nt=v.normalizeUnicode,rt=v.renderTextLayer,ot=v.setLayerDimensions,lt=v.shadow,dt=v.updateTextLayer,ht=v.version},349,[350,351]);
__d(function(g,r,i,a,m,_e,d){m.exports=function(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e},m.exports.__esModule=!0,m.exports.default=m.exports},350,[]);
__d(function(g,r,i,a,m,_e,d){var e=0;m.exports=function(t){return"__private_"+e+++"_"+t},m.exports.__esModule=!0,m.exports.default=m.exports},351,[]);